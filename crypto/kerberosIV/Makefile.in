# $Id: Makefile.in,v 1.30 1997/05/20 18:58:34 bg Exp $

srcdir		= @srcdir@
prefix		= @prefix@
VPATH		= @srcdir@

SHELL		= /bin/sh
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
MKINSTALLDIRS = @top_srcdir@/mkinstalldirs
TRAVELKIT = appl/kauth/kauth kuser/klist appl/telnet/telnet/telnet \
	    appl/ftp/ftp/ftp appl/kx/kx appl/kx/rxtelnet

@SET_MAKE@

SUBDIRS		= util include lib kuser server slave admin kadmin appl man doc

all:
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) all); done

Wall:
	make CFLAGS="-g -Wall -Wno-comment -Wmissing-prototypes -Wmissing-declarations -D__USE_FIXED_PROTOTYPES__"

check:
	cd lib && $(MAKE) $(MFLAGS) check

install:
	$(MKINSTALLDIRS) $(prefix)
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) install); done

install-strip:
	$(MAKE) INSTALL_PROGRAM='$(INSTALL_PROGRAM) -s' install

uninstall:
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) uninstall); done

travelkit:	all
	$(MKINSTALLDIRS) tmp
	for i in $(TRAVELKIT); \
	do $(INSTALL_PROGRAM) $$i tmp; done
	(cd tmp; tar cf ../travelkit.tar `for i in $(TRAVELKIT); do basename $$i; done`)
	rm -rf tmp

travelkit-strip:
	$(MAKE) INSTALL_PROGRAM='$(INSTALL_PROGRAM) -s' travelkit

TAGS:
	find . -name '*.[chyl]' -print | etags -

clean:
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) clean); done

mostlyclean:	clean

distclean:
	$(MAKE) clean
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) distclean); done
	rm -f Makefile config.status config.cache config.log version.h newversion.h.in version.h.in *~

realclean:
	for i in $(SUBDIRS); \
	do (cd $$i && $(MAKE) $(MFLAGS) realclean); done

.PHONY: all install install-strip uninstall travelkit travelkit-strip clean distclean realclean mostlyclean
