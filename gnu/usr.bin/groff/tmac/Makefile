# Makefile for groff macros

TMACOWN?=	bin
TMACGRP?=	bin
TMACMODE?=	444
TMACDIR?=	/usr/share/tmac
MDOCDIR?=	$(TMACDIR)/mdoc

MAN7=		groff_ms.7 me.7
MLINKS=		groff_ms.7 ms.7

MANDEPEND=	${MAN7}
CLEANFILES+=	temp ${MANDEPEND}

FILES=		tmac.andoc tmac.pic tmac.ps tmac.psnew tmac.psold\
		tmac.pspic tmac.psatk tmac.dvi tmac.tty tmac.tty-char tmac.X\
		tmac.Xps tmac.latin1 eqnrc troffrc
STRIPFILES=	tmac.e tmac.doc tmac.doc.old
MDOCFILES=	doc-common doc-ditroff doc-nroff doc-syms


afterinstall:
	for f in ${FILES}; do \
		install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
			${.CURDIR}/$$f ${DESTDIR}${TMACDIR}; \
	done
	install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
		${.CURDIR}/tmac.s ${DESTDIR}${TMACDIR}/tmac.groff_ms
	install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
		${.CURDIR}/tmac.an ${DESTDIR}${TMACDIR}/tmac.groff_an
	install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
		${.CURDIR}/tmac.andoc ${DESTDIR}${TMACDIR}/tmac.an
	for f in ${STRIPFILES}; do \
		rm -f temp; \
	  	sed -f ${.CURDIR}/strip.sed ${.CURDIR}/$$f >temp; \
		install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
			temp ${DESTDIR}${TMACDIR}/$$f; \
	done
	for f in ${MDOCFILES}; do \
		rm -f temp; \
		sed -f ${.CURDIR}/strip.sed ${.CURDIR}/$$f >temp; \
		install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
			temp ${DESTDIR}${MDOCDIR}/$$f; \
	done
	-test -f ${DESTDIR}${TMACDIR}/man.local || \
		install -c -o ${TMACOWN} -g ${TMACGRP} -m ${TMACMODE} \
			${.CURDIR}/man.local ${DESTDIR}${MDOCDIR}

.include "../Makefile.cfg"
.include <bsd.prog.mk>
