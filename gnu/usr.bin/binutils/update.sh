#! /bin/sh
#
# This script installs the main files generated by the binutils
# "configure" scripts and makefiles.  It can be used for upgrading to
# a new version of binutils.
#
# Don't forget to change the VERSION definition in the top level
# "Makefile.inc0".

gnudir=$(pwd)
contribdir="${gnudir}/../../../contrib/binutils"

rm -rf build
mkdir -p build/i386-aout
(cd build/i386-aout
    ${contribdir}/configure i386-unknown-freebsd || exit
    (cd gas
	echo "Updating i386-aout/as"
	make config.h || exit
	cp config.h ${gnudir}/i386-aout/as/config.h || exit
	)
    )

mkdir -p build/i386-elf
(cd build/i386-elf
    ${contribdir}/configure i386-unknown-freebsdelf || exit
    (cd gas
	echo "Updating i386-elf/as"
	make config.h || exit
	cp config.h ${gnudir}/i386-elf/as/config.h || exit
	)
    (cd ld
	echo "Updating i386-elf/ld"
	make config.h ldemul-list.h || exit
	cp config.h ldemul-list.h ${gnudir}/i386-elf/ld || exit
	)
    (cd bfd
	echo "Updating libbfd"
	make bfd.h config.h || exit
	cp bfd.h config.h ${gnudir}/libbfd || exit
	)
    (cd binutils
	echo "Updating libbinutils"
	make config.h || exit
	cp config.h ${gnudir}/libbinutils/config.h || exit
	)
    )

rm -rf build
