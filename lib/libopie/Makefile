# Makefile for libopie
#
# $Id: Makefile,v 1.6 1997/09/29 11:38:36 ache Exp $
#
OPIE_DIST?=	${.CURDIR}/../../contrib/opie
DIST_DIR=	${OPIE_DIST}/${.CURDIR:T}
SHLIB_MAJOR=    2
SHLIB_MINOR=    1

KEYFILE?=	\"/etc/opiekeys\"

.PATH: ${DIST_DIR} ${OPIE_DIST}/libmissing

LIB=	opie
SRCS=	atob8.c btoa8.c btoh.c challenge.c getsequence.c hash.c hashlen.c \
	keycrunch.c lock.c lookup.c newseed.c parsechallenge.c passcheck.c \
	passwd.c randomchallenge.c readpass.c unlock.c verify.c version.c \
	btoe.c accessfile.c generator.c insecure.c getutmpentry.c \
	readrec.c writerec.c login.c open.c logwtmp.c \
	getutline.c pututline.c endutent.c setutent.c # from libmissing

CFLAGS+=-I${.CURDIR} -I${OPIE_DIST} -I${DIST_DIR} \
	-DKEY_FILE=${KEYFILE}

MAN4=	${OPIE_DIST}/opie.4
MAN5=	${OPIE_DIST}/opiekeys.5 ${OPIE_DIST}/opieaccess.5

beforeinstall:
	${INSTALL} -C -o ${BINOWN} -g ${BINGRP} -m 444 ${OPIE_DIST}/opie.h \
			${DESTDIR}/usr/include

.include <bsd.lib.mk>
