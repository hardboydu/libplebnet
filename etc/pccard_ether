#!/bin/sh -
#
#	$Id: pccard_ether,v 1.11 1999/02/22 02:55:18 steve Exp $
#
# pccard_ether interfacename [ifconfig option]
#
# example: pccard_ether ep0 -link0
#

# Suck in the configuration variables
if [ -f /etc/defaults/rc.conf ]; then
	. /etc/defaults/rc.conf
elif [ -f /etc/rc.conf ]; then
	. /etc/rc.conf
fi

if [ "${pccard_ifconfig}" != "NO" ] ; then
	if [ "${pccard_ifconfig}" = "DHCP" ] ; then
		if [ -f /sbin/dhclient ] ; then
		    if [ -s /var/run/dhclient.pid ] ; then
			kill `cat /var/run/dhclient.pid`
			rm /var/run/dhclient.pid
		    fi
		    /sbin/dhclient
		elif [ -f /usr/local/sbin/dhcpc ] ; then
		    if [ -s /var/run/dhcpc.pid ] ; then
		        kill `cat /var/run/dhcpc.pid`
		        rm /var/run/dhcpc.pid
		    fi
		    /usr/local/sbin/dhcpc $* 
		else
		    echo "DHCP client software not available (isc-dhcp2)"
		fi
	else
		interface=$1
		shift
		ifconfig ${interface} ${pccard_ifconfig} $*
	fi
fi

if [ "${defaultrouter}" != "NO" ] ; then
	static_routes="default ${static_routes}"
	route_default="default ${defaultrouter}"
fi
    
# Set up any static routes.
if [ -n "${static_routes}" ]; then
	# flush beforehand, just in case....
        route -n flush
	arp -d -a
	for i in ${static_routes}; do
		eval route_args=\$route_${i}
		route add ${route_args}
	done
fi
