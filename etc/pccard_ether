#!/bin/sh -
#
# $FreeBSD$
#
# pccard_ether interfacename [ifconfig option]
#
# example: pccard_ether ep0 -link0
#

# Suck in the configuration variables
#
if [ -r /etc/defaults/rc.conf ]; then
	. /etc/defaults/rc.conf
elif [ -r /etc/rc.conf ]; then
	. /etc/rc.conf
fi

interface=$1
shift

case ${pccard_ifconfig} in
[Nn][Oo] | '')
        ;;
[Dd][Hh][Cc][Pp])
	if [ -r /sbin/dhclient ]; then
		if [ -s /var/run/dhclient.pid ]; then
			kill `cat /var/run/dhclient.pid`
			rm /var/run/dhclient.pid
		fi
		/sbin/dhclient $interface
	elif [ -r /usr/local/sbin/dhcpc ]; then
		if [ -s /var/run/dhcpc.pid ]; then
			kill `cat /var/run/dhcpc.pid`
			rm /var/run/dhcpc.pid
		fi
		/usr/local/sbin/dhcpc $interface $*
	else
		echo "DHCP client software not available (isc-dhcp2)"
	fi
	;;
*)
	ifconfig ${interface} ${pccard_ifconfig} $*
	;;
esac

case ${defaultrouter} in
[Nn][Oo] | '')
        ;;
*)
	static_routes="default ${static_routes}"
	route_default="default ${defaultrouter}"
	;;
esac

# Set up any static routes.
#
if [ -n "${static_routes}" ]; then
	# flush beforehand, just in case....
        route -n flush
	arp -d -a
	for i in ${static_routes}; do
		eval route_args=\$route_${i}
		route add ${route_args}
	done
fi
