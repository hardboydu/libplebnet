# $FreeBSD$
#
# Makefile for building PICOBSD kernels

SRC?=/usr/src
CONF?=$(SRC)/sys/i386/conf

CONFFILE=PICOBSD-${name}
COMPILE=$(SRC)/sys/compile/$(CONFFILE)
KERNFILE=$(COMPILE)/kernel


$(KERNFILE): ${COMPILE} do_a_make_in_the_kernel_directory_anyways

do_a_make_in_the_kernel_directory_anyways:
	(cd ${COMPILE}; make KERNEL=kernel -DNO_MODULES)

${COMPILE}: ${CONF}/${CONFFILE}
	(cd ${CONF}; config $(CONFFILE); \
	cd ${COMPILE}; make KERNEL=kernel -DNO_MODULES depend )

$(CONF)/${CONFFILE}: PICOBSD
	cp PICOBSD $(CONF)/${CONFFILE}

