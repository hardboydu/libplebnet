<!-- 
	FreeBSD errata document.  Unlike some of the other RELNOTESng
	files, this file should remain as a single SGML file, so that
	the dollar FreeBSD dollar header has a meaningful modification
	time.  This file is all but useless without a datestamp on it,
	so we'll take some extra care to make sure it has one.

	(If we didn't do this, then the file with the datestamp might
	not be the one that received the last change in the document.)

-->

<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook V4.1-Based Extension//EN" [
<!ENTITY % man PUBLIC "-//FreeBSD//ENTITIES DocBook Manual Page Entities//EN">
%man;
<!ENTITY % authors PUBLIC  "-//FreeBSD//ENTITIES DocBook Author Entities//EN">
%authors;
<!ENTITY % mlists PUBLIC "-//FreeBSD//ENTITIES DocBook Mailing List Entities//EN">
%mlists;
<!ENTITY % release PUBLIC "-//FreeBSD//ENTITIES Release Specification//EN">
%release;
]>

<article>
  <articleinfo>
    <title>&os;
<![ %release.type.snapshot [
    &release.prev;
]]>
<![ %release.type.release [
    &release.current;
]]>
    Errata</title>

    <corpauthor>
    The &os; Project
    </corpauthor>

    <pubdate>$FreeBSD$</pubdate>

    <copyright>
      <year>2000</year>
      <year>2001</year>
      <year>2002</year>
      <year>2003</year>
      <holder role="mailto:doc@FreeBSD.org">The FreeBSD Documentation Project</holder>
    </copyright>
  </articleinfo>

  <abstract>
    <para>This document lists errata items for &os; 
<![ %release.type.snapshot [
      &release.prev;,
]]>
<![ %release.type.release [
      &release.current;,
]]>
      containing significant information discovered after the release.
      This information includes security advisories, as well as news
      relating to the software or documentation that could affect its
      operation or usability.  An up-to-date version of this document
      should always be consulted before installing this version of
      &os;.</para>

    <para>This errata document for &os; 
<![ %release.type.snapshot [
      &release.prev;
]]>
<![ %release.type.release [
      &release.current;
]]>
      will be maintained until the release of &os; 5.1-RELEASE.</para>
  </abstract>

  <sect1 id="intro">
    <title>Introduction</title>

    <para>This errata document contains <quote>late-breaking news</quote>
      about &os;
<![ %release.type.snapshot [
      &release.prev;.
]]>
<![ %release.type.release [
      &release.current;.
]]>
      Before installing this version, it is important to consult this
      document to learn about any post-release discoveries or problems
      that may already have been found and fixed.</para>

    <para>Any version of this errata document actually distributed
      with the release (for example, on a CDROM distribution) will be
      out of date by definition, but other copies are kept updated on
      the Internet and should be consulted as the <quote>current
      errata</quote> for this release.  These other copies of the
      errata are located at <ulink
      url="http://www.FreeBSD.org/releases/"></ulink>, plus any sites
      which keep up-to-date mirrors of this location.</para>

    <para>Source and binary snapshots of &os; &release.branch; also
      contain up-to-date copies of this document (as of the time of
      the snapshot).</para>

    <para>For a list of all &os; CERT security advisories, see <ulink
      url="http://www.FreeBSD.org/security/"></ulink> or <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/"></ulink>.</para>

  </sect1>

  <sect1 id="security">
    <title>Security Advisories</title>

    <para>No active security advisories.</para>

  </sect1>

  <sect1 id="late-news">
    <title>Late-Breaking News</title>

    <para>The &man.geom.4;-based disk partitioning code in the kernel
      will not allow an open partition to be overwritten.  This
      usually prevents the use of <command>disklabel -B</command> to
      update the boot blocks on a disk because the
      <literal>a</literal> partition overlaps the space where the boot
      blocks are stored.  A suggested workaround is to boot from an
      alternate disk, a CDROM, or a fixit floppy.</para>

    <para>When using disk media with sector sizes larger than 512
      bytes (for instance, &man.gbde.4; encrypted disks), the
      &man.dump.8; program fails to respect the larger sector size and
      cannot dump the partition.  One possible workaround is to copy
      the entire file system in raw format and dump the copy.  It is,
      for instance, possible to dump a file system stored in a regular
      file:</para>

      <screen>&prompt.root; <userinput>dd if=/dev/ad0s1d.bde of=/junk/ad0.dd bs=1m</userinput>
&prompt.root; <userinput>dump 0f - /junk/ad0.dd | ...</userinput></screen>

    <para>A simpler workaround is to use &man.tar.1; or &man.cpio.1;
      to make backup copies.</para>

    <para>Hangs have been reported during &os; 5.0 snapshot
      installations when installing to &man.mly.4;-supported RAID
      arrays, in hardware configurations that appear to work fine
      under &os; 4.7-RELEASE.</para>

    <para>NETNCP and nwfs appear to be as-yet unadapted for KSE, and
      hence not working.</para>

    <para>During installation, the &man.iir.4; controller appears to
      probe correctly, but finds no disk devices.</para>

    <para>&man.truss.1; appears to contain a race condition during the
      start-up of debugging, which can result in &man.truss.1; failing
      to attach to the process before it exists.  The symptom is that
      &man.truss.1; reports that it cannot open the &man.procfs.5;
      node supporting the process being debugged.  A bug also appears
      to exist wherein &man.truss.1; will hang if &man.execve.2;
      returns <literal>ENOENT</literal> A further race appears to
      exist in which &man.truss.1; will return <errorname>PIOCWAIT:
      Input/output error</errorname> occasionally on startup.  The fix
      for this sufficiently changes process execution handling that it
      has been deferred until after 5.0.</para>

    <para>Some bugs have been reported in &man.sysinstall.8; disk
      partitioning.  One observed problem on the i386 is that
      &man.sysinstall.8; cannot recalculate the free space left on a
      disk after changing the type of an FDISK-type partition.</para>

    <para>In some case, documentation (such as the FAQ or Handbook)
      has not been updated to take into account &os; &release.prev;
      features.  Examples of areas where documentation is still
      needed include &man.gbde.8; and the new <quote>fast
      IPsec</quote> implementation.</para>

    <para>Attempting to unmount smbfs shares may fail with
      <errorname>Device busy</errorname> errors even when the
      mount-point is not really busy.  A workaround is to keep trying
      to unmount the share until it eventually succeeds.  This bug has
      been fixed in &release.current;.</para>

    <para>Forcefully unmounting (<command>umount -f</command>) smbfs
      shares may cause a kernel panic.  This bug has been fixed in
      &release.current;.</para>

    <para>When called on a connected socket file descriptor,
      &man.fstat.2; is supposed to return the number of bytes
      available to read in the <varname>st_size</varname> member of
      <varname>struct stat</varname>. However,
      <varname>st_size</varname> is always erroneously reported as
      <literal>0</literal> on TCP sockets.  This bug has been fixed in
      &release.current;.</para>

    <para>The &man.kqueue.2; <literal>EVFILT_READ</literal> filter
      erroneously indicates that <literal>0</literal> bytes are
      available to be read on TCP sockets, regardless of the number of
      bytes that are actually available. The
      <literal>NOTE_LOWAT</literal> flag for
      <literal>EVFILT_READ</literal> is also broken on TCP sockets.
      This bug has been fixed in &release.current;.</para>

    <para>&os; &release.prev; introduced support for POSIX named semaphores
      but the implementation contains a critical bug that causes
      &man.sem.open.3; to incorrectly handle the opening of the same
      semaphore multiple times by the same process, and that causes
      &man.sem.close.3; to crash calling programs.  This bug has been
      fixed in &release.current;.</para>

    <para>&os; &release.prev; has a minor bug in how the permissions of
      <filename>/dev/tty</filename> are handled.  This can be
      triggered by logging in as a non-<username>root</username>,
      non-<groupname>tty</groupname> group user, and using &man.su.1;
      to switch to a second non-<username>root</username>,
      non-<groupname>tty</groupname> group user.  &man.ssh.1; will
      fail because it cannot open <filename>/dev/tty</filename>.  This
      bug has been fixed in &release.current;.</para>

    <para>&man.growfs.8; no longer works on &man.vinum.4; volumes (and
      presumably, on &man.geom.4; entities) since these subsystems no
      longer fake disklabels, but &man.growfs.8; insists on examining
      a label.</para>

  </sect1>
</article>
