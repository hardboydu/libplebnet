<!--
    FreeBSD Japanese Documentation Project

    $FreeBSD$

    Original revision: 1.480
-->

<articleinfo>
  <title>&os; &release.current; &arch; Release Notes</title>

  <corpauthor>FreeBSD プロジェクト</corpauthor>

  <pubdate>$FreeBSD$</pubdate>

  <copyright>
    <year>2000</year>
    <year>2001</year>
    <year>2002</year>
    <year>2003</year>
    <holder role="mailto:doc@FreeBSD.org">FreeBSD ドキュメンテーション
    プロジェクト</holder>
  </copyright>

  <abstract>
    <para>この &os; &release.current; 用リリースノートには、
<![ %include.historic; [
      &release.prev; 以降の &os; ベースシステムに対する変更点の概要
      が含まれています。
]]>
<![ %no.include.historic; [
      &release.branch; 開発ブランチの &os; ベースシステムに対する最近の
      変更点の概要が含まれています。
]]>
      カーネルとユーザーランド双方の変更点が列挙されているのに加え、
      前のリリース以降に発行されたセキュリティ勧告のうちあてはまる
      ものも含まれています。
      また、アップグレードの際の注意点も載せてあります。</para>
  </abstract>
</articleinfo>

<sect1 id="intro">
  <title>はじめに</title>

  <para>この文書は &arch.print; ハードウェアプラットフォームの
    &os; &release.current; 向けのリリースノートです。
    &os; に最近追加、変更、削除された機能について解説しています。
    また、&os; の前のバージョンからのアップグレードについても言及して
    います。</para>

<![ %release.type.snapshot [

  <para>このリリースノートが対応する &release.type; 配布物は、
    &release.branch; 開発ブランチの &release.prev; から
    将来の &release.next; の間に位置します。
    このブランチのあらかじめコンパイルされたバイナリ &release.type;
    配布物は <ulink url="&release.url;"></ulink> に公開されています。
  </para>

]]>

<![ %release.type.release [

  <para>この &os; &release.current; 配布物は &release.type; 配布物です。
    この配布物はあらゆるミラーの <ulink url="&release.url;"></ulink>
    で見つけることができます。
    この (もしくは他の) &os; の &release.type; 配布物を取得する方法
    は
    <ulink url="http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/">FreeBSD ハンドブック</ulink>
    の
    <ulink url="http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/mirrors.html">
      付録 <quote>FreeBSD を取得する</quote></ulink>
    を参照してください。</para>

]]>
</sect1>

<sect1 id="new">
  <title>更新情報</title>

  <para>この節では
<![ %include.historic; [
    &release.prev; 以降に新たに追加・変更された
    ユーザに影響する機能について説明します。
    一般的に、ここに書かれている変更点のうち &merged;
    という印の付いていないものは &release.branch; に固有のものです。
]]>
<![ %no.include.historic; [
    &release.prev; 以降に新たに追加・変更された
    ユーザに影響する機能について説明します。
    これには他のブランチ (&os; &release.prev.historic; 以降) へと
    最近マージされた機能に加えて、&release.branch; ブランチ
    に固有の項目も含まれます。
]]>
  </para>

  <para>リリースノート項目の多くは、新しいドライバやハードウェア対応、
    新しいコマンドやオプション、重要なバグフィックスや寄贈ソフトウェア
    のアップグレードなどについてのものです。
    &release.prev.historic; 以降に出されたセキュリティ勧告のうち、
    リリースに影響するものについても掲載しています。</para>

  <para>&os; に加えられた変更点のうち、
    スペースの都合上ここに書かれていないものも多数存在します。
    それらはたとえば文書の修正や改良、ごく影響の小さいバグの修正、
    監査で見つかったセキュリティ上好ましくないスタイルで書かれたコードの修正、
    ソースコードの整理などです。</para>

  <sect2 id="kernel">
    <title>カーネルの変更点</title>

    <para arch="i386,pc98">&man.a.out.5; 形式の実行ファイルの利用するには、
      カーネルコンフィグファイルに
      <literal>COMPAT_AOUT</literal> オプションをつけるか、
      <filename>aout.ko</filename> カーネルモジュールを
      ロードしなければならなくなりました。</para>

    <para>&man.acct.2; は、アカウンティングファイルを
      追記モードでオープンするように変更されました。
      これは &man.accton.8; のアカウンティング機能を、
      追記専用ファイルに対して使えるようにするための変更です。&merged;</para>

    <para arch="i386" role="historic">新しく &man.amdpm.4;
      ドライバが追加されました。
      これは AMD 756 チップセットのシステム監視機能へのアクセスを
      提供します。&merged;</para>

    <para arch="i386,alpha,ia64" role="historic">AGP ハードウェア用ドライバ
      &man.agp.4; が追加されました。
      &merged;</para>

    <para arch="i386,pc98">複数の Netgraph モジュール
      (&man.ng.bluetooth.4; 参照) という形で、
      Bluetooth デバイスに暫定対応しました。
      Bluetooth アダプタに対応する 2 つのモジュールが提供されています。
      &man.ng.bt3c.4; ドライバは
      3Com/HP Bluetooth PCCARD アダプタに対応し、
      &man.ng.ubt.4; は、いくつかの
      USB Bluetooth アダプタに対応するものです。

      <note>
        <para>&os; の Bluetooth 対応は、
          現在も作業が続けられている機能の一つです。</para>
      </note>

    </para>


    <para>OpenBSD 由来の新しいカーネル暗号化フレームワークが
      統合されました
      (詳細は &man.crypto.4; と &man.crypto.9; をご覧ください)。
      これは、ソフトウェアで実装された暗号アルゴリズムと
      ハードウェアで実装された暗号アルゴリズムの両方を、
      カーネルから共通の方法で利用できるインターフェースを提供し、
      ユーザアプリケーションから暗号化ハードウェアへアクセスできるように
      するためのものです。
      ハードウェア用デバイスドライバとして、
      hifn ベースのカードに対応した &man.hifn.4; ドライバと
      Broadcom ベースのカードに対応した &man.ubsec.4; ドライバが
      追加されています。&merged;</para>

    <para>&man.ddb.4; に新たなコマンド
      <command>show pcpu</command> が追加されました。
      これは各 CPU の情報を表示します。</para>

    <para role="historic">&man.ddb.4; に新たなコマンド
      <command>hwatch</command>
      <command>dhwatch</command> が導入されました。
      アーキテクチャが対応している必要がありますが、
      これらは (ソフトウェアウォッチポイントを設定する)
      <command>watch</command> および <command>dwatch</command>
      のようにハードウェアウォッチポイントを設定するためのものです。
      &merged;</para>

    <para><filename>devctl</filename> デバイスが追加されました。
      これにより、ユーザランドプログラムは
      いつデバイスがデバイスツリー上で用意されて利用可能になるかを
      知ることができます。
      この機能は主に &man.devd.8; ユーティリティで利用されます。</para>

    <para>&man.devfs.5; の大部分が書き直されました。
      これは <filename>/dev</filename>
      ディレクトリ内のエントリを自動的に構築し、
      デバイスの接続をより適応的に行なうことを可能にします。
      &man.devfs.5; は標準で有効化されていますが、
      <literal>NODEVFS</literal>
      カーネルオプションを使うことで無効化できます。
      また、管理者は <quote>rule</quote> サブシステムを用いて
      新しいデバイスノードがユーザランドからアクセスできるようになる前に、
      そのデバイスノードの特性を設定することが可能です。
      静的なノード (たとえば <filename>/dev/speaker</filename>)、
      動的なノード (<filename>/dev/bpf*</filename> やリムーバブルデバイスの一部)
      の両方に対応しています。
      &man.devfs.5; のマウントは、
      各マウントごとに異なるルールセットを設定することができます。
      これにより、jail 環境などに対して異なるポリシを適用することが可能です。
      ルールとルールセットの操作には、
      &man.devfs.8; ユーティリティを使います。</para>

    <para>PCI Xr ベースのカード、ISA Xem Digiboard カードに対応した
      digi ドライバが新たに追加されました。
      新たに追加された &man.digictl.8; プログラムは (主に)
      PC/Xem のような外部ポートモジュールを持つカードを
      再初期化するためのものです。digi ドライバの追加にともない、
      古い dgm ドライバは削除されました。</para>

    <para>&man.eaccess.2; システムコールが追加されました。
      &man.access.2; と似ていますが、後者は実権限を使うのに対して、
      前者は実効権限を使います。</para>

    <para arch="sparc64">EBus ベースのデバイスに対応しました。</para>

    <para arch="i386,pc98,powerpc">FireWire デバイスへに対する
      初期的な対応が追加されました
      (詳細は &man.firewire.4; をご覧ください)。&merged;</para>

    <para arch="i386" role="historic">Intel 82801AA (ICH) SMBus
      コントローラおよびその互換品に対応した
      &man.ichsmb.4; ドライバが追加されました。&merged;</para>

    <para>各 &man.jail.2; 環境は各々の securelevel で動作することがで
      きるようになりました。</para>

    <para>&man.jail.2; 用の設定可能な sysctl 変数
      が <varname>jail.*</varname> から
      <varname>security.*</varname> へと移動しました。
      他のセキュリティ関連の sysctl 変数は
      <varname>kern.security.*</varname> から
      <varname>security.*</varname> へと移動しました。</para>

    <para role="historic"><varname>kern.maxvnodes</varname> は使用する vnode の
      数を正しく制限するようになりました。
      これまでは、キャッシュされていないページの vnode のみが
      free でき、これにより多くのメモリを積んだマシンが
      多くの小さいファイルにアクセスする際に、制限なしに vnode の
      数を大きくすることが可能でした。
      <literal>vnlru</literal> カーネルスレッドが vnode の解放
      と再利用を行なっています。&merged;</para>

    <para role="historic">カーネルメッセージバッファが
      (アーキテクチャに依存しない)
      sysctl 変数 <varname>kern.msgbuf</varname>
      経由でアクセスできるようになりました。
      それにともない、&man.dmesg.8; が
      <groupname>kmem</groupname> で SGID
      されている必要はなくなりました。&merged;</para>

    <para>カーネル環境変数が &man.kenv.2; システムコールを使って
      動的に変更することができるようになりました。</para>

    <para role="historic">&os; カーネルに &man.kqueue.2;
      イベント通知機能が追加されました。
      これは &man.poll.2;/&man.select.2;
      を置き換えることができる新たなインターフェイスで、
      高パフォーマンスなだけでなく数多くの異なる種類のイベントを
      報告する機能を持っています。
      また、シグナルやプロセスの監視だけでなく、
      ソケット、パイプ、FIFO、ファイルの変更の監視にも対応しています。
      &merged;</para>

    <para arch="i386,pc98" role="historic">新しいカーネルオプション
      <varname>KVA_SPACE</varname>
      が追加されました。
      これはカーネル仮想アドレス空間の大きさを再設定するために使われます。
      &merged;</para>

    <para>labpc(4) ドライバは古くなったため削除されました。</para>

    <para>ローダとカーネルリンカは、
      KLD のある各ディレクトリに存在する
      <filename>linker.hints</filename> というファイルから
      モジュール名およびバージョンと
      KLD ファイル名の対応を調べるようになりました。
      新しく追加されたユーティリティ &man.kldxref.8; は、
      これらのファイルを生成するために使用します。</para>

    <para role="historic">Linux エミュレーションは
      <filename role="package">emulators/linux_base</filename>
      (RedHat 7.X emulation)
      で必要とされるカーネル機能に対応しました。&merged;</para>

    <para role="historic">Linux エミュレーションは、カーネル設定に
      <literal>options SYSVSEM</literal> が必要になりました。&merged;</para>

    <para>Low-Watermark Mandatory Access Control 用
      セキュリティ機構 &man.lomac.4; がカーネルモジュールとして
      追加されました。
      これは管理者からの追加の設定を必要としない、
      従来の UID ベースのセキュリティ機構に加えて使うことのできる
      セキュリティ機構です。
      この機能は DARPA と NAI Labs がスポンサーになっています。</para>

    <para>&os; に TrustedBSD の
      MAC (Mandatory Access Control, 強制アクセス制御)
      フレームワークが追加されました。
      これはシステムのセキュリティポリシの機能性を向上させるもので、
      カーネルのコンパイル時、システム起動時、システム実行中のいつでも
      ロード・リンク可能なカーネルモジュールとして実装されています。
      TrustedBSD MAC はさまざまなイベントに対応するモジュールと、
      ラベル領域のように共通して利用できるセキュリティポリシサービスを提供します。
      今回のリリースには、固定およびフローティングラベルの Biba
      完全性モデルや区画付きマルチレベルセキュリティ (MLS) に加え、
      ファイルシステムファイアウォールなどの数多くの改良型 UNIX
      セキュリティモデルを実現するためのポリシモジュールのサンプルが
      数多く収録されています。
      この機能は、ローカルおよびベンダの
      セキュリティ拡張の開発や保守を容易にするものです。
      この拡張サービスは、カーネルコンフィグファイルに
      <literal>options MAC</literal>
      を追加することにより有効にできます。

      <note>
        <para>MAC フレームワークは、
          今回のリリースにおいて実験的な機能の一つと考えられています。
          デフォルトでは有効にされていません。</para>
      </note>
      </para>

    <para arch="ia64">起動時に
      MCA (Machine Check Architecture) レコードを取得するようになりました。
      レコードは <varname>hw.mca.*</varname> sysctl
      変数として参照することが可能です。
      <!-- hrs:2003/01/05 - MCA is a self-diagnostic
           framework of IA64 (e.g. Itanium family),
           mainly used for so-called RAS system. --></para>

    <para role="historic">カーネル設定パラメータ <varname>maxusers</varname>
      が起動時に変更可能になりました。<varname>maxusers</varname>
      に由来する他のカーネル設定パラメータも起動時に反映されます。
      また、<varname>hz</varname> パラメータも同様に変更可能になっています。
      &merged;</para>

    <para role="historic">カーネル設定パラメータ <varname>maxusers</varname>
      に <literal>0</literal> を指定すると、
      ブート時に適切な値 (32 から 384 の間で、搭載メモリ量に依存して)
      を計算するようになりました
      すべての <filename>GENERIC</filename> カーネルではこの値が
      デフォルトとなりました。&merged;</para>

    <para arch="alpha" role="historic">カーネルオプション
      <varname>MAXMEM</varname>
      と <varname>hw.physmem</varname> 調整可能なローダ変数
      はテスト (やその他の目的) のために、人工的にマシンのメモリサイズ
      を減らすことに使えるようになりました。&merged;</para>

    <para role="historic">カーネル設定パラメータ
      <varname>MAXTSIZ</varname>、<varname>DFLDSIZ</varname>、
      <varname>MAXDSIZ</varname>、<varname>DFLSSIZ</varname>、
      <varname>MAXSSIZ</varname>、<varname>SGROWSIZ</varname>
      は loader で設定可能になりました
      (<varname>kern.maxtsiz</varname>、
      <varname>kern.maxdfldsiz</varname> など)。&merged;</para>

    <para>&man.mutex.9; にプロファイルのためのコードが追加されました。
      これはカーネルコンフィグファイルに
      <literal>MUTEX_PROFILING</literal>
      を加えることにより有効になり、sysctl 変数
      <varname>debug.mutex.prof.*</varname>
      の設定が有効になります。</para>

    <para arch="i386,pc98" role="historic">
      SMP カーネルを設定するためのカーネルオプションである
      <literal>NCPU</literal>、<literal>NAPIC</literal>、
      <literal>NBUS</literal>、<literal>NINTR</literal>
      は削除されました。
      現在 <literal>NCPU</literal> は最大の 16 に設定されており、
      上記のその他のオプションは動的に変化するものとなっています。
      &merged;</para>

    <para role="historic">新しく &man.nmdm.4;
      ヌルモデム端末ドライバが追加されました。
      &merged;</para>

    <para role="historic">&man.open.2; および &man.fcntl.2; に
      <literal>O_DIRECT</literal> フラグが追加されました。
      ファイルオープン時にこのフラグを設定すると、
      読み書き時のキャッシュの影響を最小化します。
      &merged;</para>

    <para role="historic">&man.orm.4; デバイスが追加されました。
      これは他のドライバが誤って
      ROM と重なったアドレスを割り当てることのないよう、
      ISA メモリ I/O 空間内のオプション ROM を取得するためのものです。
      &merged;</para>

    <para>カーネルオプション <literal>P1003_1B</literal> が
      すでに使われなくなっているために削除されました。

    <para arch="i386,pc98">PECOFF (Win32 実行ファイルフォーマット)
      に対応しました。</para>

    <para arch="pc98" role="historic">NEC PC-98NOTE 用のパワーマネージメント
      コントローラである pmc ドライバが追加されました。&merged;</para>

    <para role="historic">POSIX.1b 共有メモリオブジェクトに対応しました。
      実装は通常ファイルを使っていますが、ファイルが
      &man.mmap.2; されている場合は MAP_NOSYNC フラグが自動的に有効化されます。
      &merged;</para>

    <para role="historic"><literal>PQ_*CACHE</literal> オプションが
      <literal>PQ_CACHESIZE</literal>
      という一つのオプションに置き換えられました。
      これにはキャッシュサイズをキロバイト単位で指定します。
      後方互換性を保つため、現在も、従来のオプションに対応しています。
      &merged;</para>

    <para arch="i386,pc98" role="historic">&man.puc.4;
      (PCI <quote>Universal</quote>
      Communications) ドライバが追加されました。
      このドライバは PCI ベースのシリアルポートを &man.sio.4; ドライバに
      接続します。&merged;</para>

    <para>&man.random.4; デバイスが
      <application>Yarrow</application>
      アルゴリズムを使うように書き直されました。
      このアルゴリズムはコンソールデバイス、
      イーサネット、PPP ネットワークインターフェイス、
      大容量記憶デバイスといった、
      さまざまな割り込み要因からエントロピを収集します。
      &man.random.4; デバイスから得られるエントロピは
      シャットダウン時刻実行時だけでなく、
      定期的に <filename>/var/db/entropy</filename>
      に保存されるようになっています。
      また <filename>/dev/random</filename>
      のセマンティクスが変更され、
      エントロピが生成する前でブロックするのではなく、
      疑似乱数データストリームを生成するようになりました。
      これは <filename>/dev/urandom</filename> と完全に同じ動作です。</para>

    <para>カーネルオプション <literal>options REGRESSION</literal>
      が新たに追加されました。これは動作検証やレグレションテスト時に有用な
      インターフェイスや機能を提供します。</para>

    <para><literal>RLIMIT_VMEM</literal> 機能が追加されました。
      これは、あるプロセスに対して、
      &man.mmap.2; 空間を含む、全仮想メモリ空間の大きさに制限を設けるものです。
      制限は &man.login.conf.5; に追加された
      <varname>vmemoryuse</varname> 変数によって設定することができます。
      &merged;</para>

    <para arch="sparc64">SBus ベースのデバイスに対応しました。</para>

    <para arch="sparc64">最近の Sparc Ultra マシンの多くに搭載されている
      Siemens SAB82532 シリアルチップに対応した
      sab ドライバが追加されました。</para>

    <para>&man.sendfile.2; システムコールにおいて、
      送信ファイルサイズの計算でヘッダサイズを
      正しく含めていなかったというバグが修正されました。&merged;</para>

    <para role="historic">&man.snp.4; デバイスが
      モジュールとしてコンパイルできるようになりました。&merged;</para>

    <para arch="i386" role="historic">&man.spic.4; ドライバが追加されました。
      これは Sony 製ラップトップに搭載されているジョグダイアルデバイスへ
      アクセスを提供するものです。
      &man.moused.8; も、このデバイスに対応しています。
      &merged;</para>

    <para>&man.syscons.4;
      ドライバがキーボード操作によるペーストに対応しました。
      標準では <keycap>Shift</keycap>-<keycap>Insert</keycap>
      に設定されています。</para>

    <para role="historic">出荷時の状態で USB デバイスに対応するため、
      <filename>GENERIC</filename> カーネルと
      インストールプログラムが USB デバイスに対応しました。
      現時点で SRM は USB デバイスに対応していないため、
      シリアルコンソールを使っていない場合には
      まだ AT キーボードを使う必要があります。&merged;</para>

    <para>USB オーディオデバイス用の
      uaudio ドライバが追加されました。&merged;</para>

    <para arch="i386,pc98">Belkin F5U103 USB-シリアル変換アダプタ
      (およびその互換製品) に対応する ubsa ドライバが追加されました。
      &merged;</para>

    <para arch="i386,pc98" role="historic">USB モデムに対応した
      &man.umodem.4; ドライバが追加されました。このドライバは
      3Com 5605 と Metricom Ricochet GS wireless USB モデムに対応しています。
      &merged;</para>

    <para arch="i386,pc98" role="historic">標準的な USB スキャナに対応した
      &man.uscanner.4; ドライバが追加されました。
      これは SANE を利用していますので、対応スキャナは
      <ulink url="http://www.mostang.com/sane/">SANE
        ホームページ</ulink>をご覧ください。
      HP ScanJet 4100C、5200C、6300C の動作が確認されています。&merged;</para>

    <para>USB モデムや USB シリアルデバイスなどを tty
      のように見えるようにする
      &man.ucom.4; ドライバが追加されました。
      また、&man.uftdi.4;、&man.uplcom.4;、&man.uvscom.4;
      ドライバはそれぞれ、FTDI シリアルアダプタ、
      Prolific PL-2303 シリアルアダプタ、SUNTAC Slipper U VS-10U に対応しています。
      &merged;</para>

    <para>セキュリティを向上させるため、<literal>UCONSOLE</literal>
      カーネル設定オプションが削除されました。</para>

    <para arch="i386,pc98">
      起動時に ISA デバイスの有効化・無効化・設定を行なうカーネル設定機能
      UserConfig が削除されました。その機能は
      <filename>/boot/device.hints</filename>
      にあるカーネルヒントファイルに置き換えられています。</para>

    <para><literal>USER_LDT</literal>
      カーネルオプションが標準設定で有効化されるようになりました。</para>

    <para>Handspring Visors を USB 経由で接続できるようにするための
      &man.uvisor.4; ドライバが追加されました。&merged;</para>

    <para arch="i386" role="historic">&man.viapm.4;
      ドライバが新しく追加されました。
       これは VIA SMBus 電源管理コントローラに対応しています。 &merged;</para>

    <para>VESA S3 リニアフレームバッファドライバが追加されました。</para>

    <!-- Above this line, order bootloader changes by keyword-->

    <para role="historic">クラッシュダンプに write combining 機能 (訳注:
      データをひとまとめにしてバス使用効率を向上させる機能)
      が実装されました。
      この機能は SCSI、IDE ディスクの両方で
      書き込みキャッシュが無効化されていて、
      メモリのダンプが終了するまで 1 時間近くかかるような場合に有効です。
      &merged;</para>

    <para>カーネルのクラッシュダンプ機構が、
      新しいプラットフォームへの対応、
      コードのロジックの整頓を受けて改良されました。
      この改良の成果の一つとして、
      カーネルダンプのディスク上のフォーマットが変更され、
      バイトオーダ依存性がなくなりました。</para>

    <para>極めて大きいスワップ領域 (67 GB 以上)
      でも、システムがパニックしなくなりました。</para>

    <para arch="alpha">Linux 互換機能が thread に対応しました。</para>

    <para role="historic"><maketarget>buildkernel</maketarget> ターゲットは、
      構築するカーネルのコンフィグレーションファイル名 (複数の場合もあり)
      を <varname>KERNEL</varname> ではなく、
      <varname>KERNCONF</varname> という変数から受け取るようになりました。
      <maketarget>buildkernel</maketarget> の前に
      <maketarget>buildworld</maketarget> を行なう必要はありません
      (ただし <application>binutil</application>
      が更新されたメジャーリリース間でアップグレードを行なう場合、
      もしくは &man.config.8; が更新された場合は
      <maketarget>buildworld</maketarget> を行なう必要があります)。
      &merged;</para>

    <para role="historic">デッドロックを避けるため、
      スワップ領域不足時のプロセス終了処理は
      古いプロセスから行なわれるようになりました。
      さらにその終了処理では、
      プロセスサイズの計算に必要なスワップ領域も考慮に入れるようになりました。
      &merged;</para>

    <para>リンカセット (訳注: ELF カーネル構築時に必要な情報の一つ)
      を生成する必要がなくなりました。
      必要のなくなった gensetdefs(8) は削除されています。</para>

    <para role="historic">ネットワークデバイスのクローニングが新たに実装され、
      それを利用するように &man.gif.4; デバイスが変更されました。
      そのためデバイスインスタンスを追加したい場合は
      カーネルコンフィグレーションファイルに利用する数だけ
      &man.gif.4; を指定するのではなく、
      &man.ifconfig.8; の <option>create</option>
      オプションを使ってください。
      &merged;</para>

    <para>カーネル構築時に &man.config.8; の <literal>ENV</literal>
      指示子を用いることで、(調整可能な)
      カーネル環境変数を設定することができるようになりました。
      <!-- hrs:needs to be revised --></para>

    <para>新しく、idle 時にページをゼロで初期化する機能が追加されました。
      これは <varname>vm.idlezero_enable</varname> sysctl
      変数を使って有効化できます。</para>

    <para arch="i386,pc98" role="historic">カーネルのロードアドレスが
      シンボルテーブルに格納されるようになり、
      ハードコードされたさまざまな定数が削除されました。
      これにより、異なるアドレスでコンパイルされたカーネルに対しても
      &man.ps.1; が正しく動作可能になっています。
      &merged;</para>

    <para role="historic">非常に大きいプロセス (あるいは非常に多数のプロセス)
      のコアダンプが発生した場合でも、
      マシンが長時間ロックしなくなりました。
      &merged;</para>

    <para>&os; のカーネルスケジューラに
      KSEs (Kernel-Scheduled Entities) 機能が追加されました。
      これは、スケジューラアクティベーションと同様、
      1 つのプロセスから複数のスレッドの実行を可能にするものです。
      現時点のカーネルは、スレッド対応に必要な変更の多くが施され、
      スケジューラは各プロセスで複数のスレッドをスケジュールすることが
      できるのですが、スレッドを複数の CPU 上で同時に実行することはできません。
      詳細は &man.kse.2; をご覧ください。

        <note>
	  <para>KSE は、現在も作業が続けられている機能の一つです。</para>
	</note>

    </para>

    <para>カーネルは複数の低レベルコンソールデバイスに対応しています。
      異なったコンソールを操作するには、新しい &man.conscontrol.8;
      ユーティリティを使います。</para>

    <para arch="alpha">コンソールドライバは TGA ベースのディスプレイ
      アダプタに対応しました。</para>

    <para role="historic">インストール CD のカーネルは
      <filename>mfsroot</filename>
      イメージから分離しました。
      これにより、CD ブートに対応しているマシンでは、(フロッピー
      用の削られたカーネルではなく) 完全なカーネルをインストール時に
      使うことができるようになります。&merged;</para>

    <para role="historic">システムのロードアベレージの計算において、
      定期的に実行されるプロセスと同期してしまうことを
      避けるために、サンプリングのタイミングにいくらかの
      ゆらぎを加えるようになりました。&merged;</para>

    <para role="historic">モジュール付きデバッグ用カーネルが構築された場合、
      (例えば <literal>makeoptions DEBUG=-g</literal> を使った場合)
      モジュール自体もデバッグシンボルを含んだ状態で構築されるように
      なりました。
      この副作用として、デバッグ用のモジュールの構築とインストールに、
      以前よりも大きなディスク容量が必要とされるようになりました。
      &merged;</para>

    <para role="historic">カーネルのダンプデバイスは、変更可能なローダ変数
      <varname>dumpdev</varname> で設定できるようになりました。
      その結果、カーネル初期化の遅い段階 (システムがシングルユーザモードに
      入る前) のパニックからも、クラッシュダンプを取れるようになりました。
      &merged;</para>

    <para>カーネルメモリアロケータは Solaris で使われているのと同じように
      スラブ(slab)メモリアロケータとなりました。
      これは CPU の数が増えるに従い線形に近い性能を示す SMP 対応の
      メモリアロケータです。
      また、メモリフラグメンテーションも少なくなります。</para>

    <sect3>
      <title>プロセッサ・マザーボードの対応状況</title>

      <para>BSD/OS 5.0 由来のコードが組み入れられ
        SMP 対応部分が大きく書き直されました。
        SMPng (<quote>SMP Next Generation</quote>)
        の主な特徴の一つに、
        マルチプロセッサの利用効率を大きく損なうスピンロックを使わずに
        カーネル内で複数のプロセスを実行することができる、
        ということがあげられます。
        また割り込みハンドラは、
        割り込みのロックアウトを低減するために
        それぞれコンテキストを持つようになりました。</para>

      <para arch="i386,pc98"><filename>GENERIC</filename> カーネルから
        80386 プロセッサ対応が削除されました。
        このコードは他の IA32
        プロセッサのパフォーマンスを大きく損なう原因となっているためです。
	80386 プロセッサに対応するための
        <literal>I386_CPU</literal> カーネルオプションを
        他の IA32 プロセッサに対応するためのオプションと
	同時に指定することはできなくなりました。
        これにより実行時のプロセッサタイプチェックが削除され、
        80386 における性能が多少向上しています。
	80386 上で動作可能なカスタムカーネルを構築するには、
        カーネルコンフィグレーションファイルに
        <literal>I386_CPU</literal>
        とだけ書いてあるように変更する必要があります。</para>

      <para arch="alpha" role="historic">AlphaServer 1200
	(<quote>Tincup</quote>)
        における動作が確認されました。現時点では CD
        やフロッピディスクからの起動ができませんが、他の Alpha
        マシンでインストールしたディスクを移植したものはきちんと動作します。
        &merged;</para>

      <para arch="alpha">API UP1100 マザーボードにおける動作が確認されました。
      </para>

      <para arch="alpha">API CS20 1U high server における動作が確認されました。
      </para>

      <para arch="alpha">AlphaServer 2100A (<quote>Lynx</quote>)
	に対応しました。</para>

      <para arch="alpha">旧世代の Alpha CPU (EV4 および EV5) が
        新世代の Alpha CPU の命令をエミュレートできるようにするコードが
        カーネルに追加されました。
        これにより、EV4 および EV5 上で
	<application>Adobe Acrobat 4</application>
        のようなバイナリ配布のみのプログラムが利用できるようになります。</para>

      <para arch="alpha" role="historic">Alpha アーキテクチャの SMP
	に対応しました。</para>

      <para arch="i386">FC-PGA2 Pentium III (Tualatin)、
	Transmeta Crusoe、Transmeta Crusoe LongRun
        といった、新しいプロセッサの検出コードが追加されました。
        &merged;</para>

      <para arch="alpha">1.44MB フロッピーディスクにインストール用
	カーネルを収めるため、ハードウェアへの対応がいくつか削除されました。
        削除されたのは Multia、NoName、PC64、EB64、Aspen Alpine、sa
	(SCSI テープ)、amr、
        パラレルポート、vx (3c590、3c595)、pcn (AMD Am79C97x PCI 10/100)、
        sf (Adaptec AIC-6915)、sis (SiS 900/SiS 7016)、ste (Sundance ST201
        (D-Link DFE-550TX))、wb (Winbond W89C840F) です。</para>

      <para arch="i386" role="historic">Streaming <acronym>SIMD</acronym>
	Extensions
        (<acronym>SSE</acronym>) が導入されました。
        SSE 対応をカーネルに組み込むかどうかの制御は
        <literal>CPU_ENABLE_SSE</literal>
	カーネルオプションで行なうことができます。</para>

      <para arch="i386" role="historic"><literal>CPU_ATHLON_SSE_HACK</literal>
	カーネルオプションが追加されました。
	これは最近の Athlon CPU で BIOS が SSE 機能ビットをセットするのを
	忘れている場合に、セットするようにするものです。&merged;</para>

      <para arch="sparc64">&os; が UltraSPARC プラットフォームに
	対応しました。まだ不具合のある部分もありますが、
	Ultra 1/2/5/10/30/60、Enterprise 220R/420R、Netra T1 AC200/DC200、
	Netra T 105、Blade 100 の各マシンに対応しています。
	SMP にも対応しており、
	Ultra 2、Ultra 60、Enterprise 220R、Enterprise 420R
	でテストされています。</para>

      <para arch="i386">いくつかのシステムでは、
        BIOS が PCI デバイスの I/O
        ポートやメモリを動作可能に設定しないために、
        それらを利用することができないものがあります。
        起動ローダから変更可能な
        <varname>hw.pci.enable_io_modes</varname> sysctl 変数
        (デフォルトは <quote>有効</quote> を表す
        <literal>1</literal> に設定されています)
        が設定されている場合、
        &os; はそれらを強制的に有効化し、デバイスを利用できるようにします。</para>

      <para arch="alpha">TurboChannel ベースの Alpha
        マシンでは動作しなくなりました。</para>

      <para arch="i386">AMD &Eacute;lan SC520 に対応しました。
	利用するには、カーネルコンフィグファイルに
	<literal>CPU_ELAN</literal> オプションを追加する必要があります。
	&merged;</para>

      <para arch="i386,pc98">カーネルオプション
        <literal>CPU_DISABLE_CMPXCHG</literal> が追加されました。
        このオプションを有効にすると、
        VMWare 上のクライアント OS の性能が劇的に向上します。

	<note>
	  <para>このオプションは
	    <literal>SMP</literal> 機能と共存できません。</para>
	</note>

	</para>

    </sect3>

    <sect3>
      <title>ブートローダの変更</title>

      <para arch="i386" role="historic"><filename>boot2</filename> に
        <option>-n</option> オプションが追加されました。
	これは、キーボード操作による起動の中断を禁止します。
	&merged;</para>

      <para arch="i386" role="historic">新しい CDROM 用の
	<filename>cdboot</filename>
	ブートストラップユーティリティは、El Torito ブータブル CDROM
	標準に完全には準拠しないいくつかの BIOS
	実装に対してもうまく動作します。
	このブートローダは <quote>エミュレーションではない</quote>
	モードの起動に対応しており、ブータブル CDROM には
	エミュレート用のフロッピディスクイメージが含まれていません。
	&merged;</para>

      <para arch="i386,pc98" role="historic">i386 ブートローダが
	<literal>nullconsole</literal> というコンソールタイプに対応しました。
	これはビデオコンソールもシリアルポートもついていない
	システム向けのものです。
	&merged;</para>

      <para arch="i386,pc98" role="historic">&man.loader.8; が
	<application>bzip2</application> で圧縮されたカーネルと
	モジュールのロードをオプションで対応しました
	(デフォルトでは無効で、コンパイル時に有効にできます)。
	&merged;</para>

      <para arch="i386" role="historic">&os; ブートローダが
	Intel Wired for Management 2.0 (PXE) に対応しました。
	API が異なるため古いバージョンの PXE には対応していません。
	これにより DHCP を使ったネットワーク経由の起動が可能になってい
	ます。&merged;</para>

      <para arch="pc98">PC98 ブートローダが SCSI MO
        メディアからの起動に対応しました。
        &merged;</para>

       <!-- Above this line, order bootloader changes by keyword-->

      <para arch="i386" role="historic">&os; ブートローダに対して、
	疑似フロッピの第一セクタに変更のできる有効な MS-DOS BPB を想定している
	IBM BIOS での起動に対応するための修正が行なわれました。&merged;
	<!-- hrs: need to be revised here --></para>

      <para arch="i386,pc98" role="historic">&os; ブートローダに、
	プローブの段階で
	一行出力する毎にカーネルがちょっと止まるようにする
	<option>-p</option> フラグが追加されました。&merged;</para>

      <para arch="alpha,i386" role="historic">&os; ブートローダは 8K
	より大きなブロック
	サイズのファイルシステムからもブートできるようになりました。
	&merged;</para>

      <para>操作しやすくするため、カーネルとカーネルモジュールは
	<filename>/boot/kernel</filename> ディレクトリに移動しました。
	ブートローダには、
	この変更を可能な限り意識しないで済むような更新がなされています。</para>

      <para arch="alpha,i386,pc98,sparc64">ブートローダが
        UFS1 および UFS2 ファイルシステムの両方からカーネルをロードできるようになりました。</para>
    </sect3>

    <sect3>
      <title>ネットワークインターフェイスの対応状況</title>

      <para role="historic">Cisco Aironet カードに対応した
        &man.an.4; ドライバが Wired Equivalent Privacy (WEP)
        暗号化に対応しました。
        これは &man.ancontrol.8; で設定できます。&merged;</para>

      <para role="historic">&man.an.4; ドライバが Cisco Aironet 350
        シリーズのアダプタに対応しました。
        &merged;</para>

      <para role="historic">&man.an.4; ドライバが <quote>監視 (monitor)</quote>
        モードに対応しました。これは
        &man.ancontrol.8; にオプション
        <option>-M</option> を指定することで有効になります。
        &merged;</para>

      <para role="historic">&man.an.4; ドライバは Cisco LEAP に対応し、
	<quote>Home</quote> WEP キーも使えるようになりました。
	Linux Aironet ユーティリティはエミュレーションで対応しています。
	&merged;</para>

      <para arch="i386,pc98" role="historic">ARCNET token-based
	ネットワークに対応しました。&merged;</para>

      <para arch="i386,pc98" role="historic">
        &man.bge.4; ドライバが追加されました。
        これは 3Com 3c996-T、
        SysKonnect SK-9D21、SK-9D41 および
        Dell PowerEdge 2550 サーバの内蔵ギガビットイーサネット NIC
        などに使われている Broadcom BCM570x
        ファミリのギガビットイーサネットコントローラ用ドライバで、
        出力 TCP/IP チェックサムのオフロード、
        ジャンボフレーム、VLAN タグ挿入・削除機能に加え、
        割り込み低減機能に対応しています。&merged;</para>

      <para arch="i386" role="historic">SMC COM90cx6 ARCNET
	ネットワークアダプタ
	に対応する cm ドライバが追加されました。&merged;</para>

      <para>&man.dc.4; ドライバは、Xircom 3201 と Conexant
	LANfinity RS7112 チップベースの NIC に対応しました。</para>

      <para role="historic">&man.dc.4; ドライバが VLAN に対応しました。
	&merged;</para>

      <para role="historic">&man.de.4; ドライバは、21143 において受信ユニットに
	優先度を与えるのではなく、受信/送信ユニット間で
	ラウンドロビン調停を行なうようになりました。
	これにより高負荷時の送出レートが 10&ndash;15% ほど
	改善されます。&merged;</para>

      <para arch="alpha">&man.ed.4; ドライバに対応しました。</para>

      <para arch="i386,pc98" role="historic">
        &man.ed.4; ドライバが対応している
        Linksys Fast Ethernet PCCARD カードを使う場合、
        &man.pccard.conf.5; の設定行に
        <literal>0x80000</literal> フラグを追加しなければならなくなりました。
        このオプションフラグは必須なもので、
        もし付けていないと Linksys のカードは認識されません。
        &merged;</para>

      <para role="historic">非常に短いパケットもしくは
	ブリッジを有効化している時に
        パニックを引き起こす可能性があった &man.ed.4; ドライバのバグが
        修正されました。
        &merged;</para>

      <para role="historic">&man.ed.4; ドライバが、NetGear FA-410TX
        などが採用している D-Link DL10022 チップに対応しました。
        そのため
	&man.ed.4; を使用する際はカーネルコンフィグレーションファイルに
        <literal>device miibus</literal> を追加しなければならなくなっています。
        &merged;</para>

      <para arch="i386">&man.el.4;
        ドライバがモジュールとしてロードできるようになりました。</para>

      <para arch="i386,pc98,ia64" role="historic">Intel
	82542、82543、82544、82545EM、82546EB ギガビット
	イーサネットコントローラチップベースの NIC に対応する
	&man.em.4; ドライバが追加されました。
	このドライバは VLAN に対応し、82543、82544 ベースのアダプタにおいて
	送信/受信チェックサム負荷低減機能とジャンボフレームに
	対応しています。&merged;</para>

      <para role="historic">&man.faith.4;
	デバイスがロード/アンロード/クローニングに
	対応しました。&merged;</para>

      <para arch="i386,pc98" role="historic">&man.fe.4;
	ドライバが富士通 MB86960A/MB86965A
        ベースのイーサネット PC カードに再び対応しました。&merged;</para>

      <para arch="alpha" role="historic">&man.fpa.4; ドライバが
        Alpha マシン上の Digital DEFPA FDDI アダプタに対応しました。
	&merged;</para>

      <para role="historic">&man.fxp.4;
	ドライバはカーネルコンフィグファイルに
        <literal>device miibus</literal>
	のエントリを必要とするようになりました。
        &merged;</para>

      <para role="historic">&man.fxp.4;
	ドライバに、いくつかの Intel ICH2/ICH2-M
	チップベースのシステムにおける PCI プロトコル違反への
	対応策が追加されました。
	この対応策では、Dynamic Standby Mode を無効にするために
	インターフェイスの EEPROM を上書きします。
	EEPROM の上書き後、新しい設定が有効となるためには
	システムを再起動する必要があります。&merged;</para>

      <para role="historic">&man.fxp.4;
	ドライバは、対応している NIC
        上に受信側の割り込み結合機能とパケットバンドル機能を実装する
        Intel のローダブルマイクロコードに対応しました。
	この機能は &man.ifconfig.8; の <option>link0</option>
	オプションで有効にできます。&merged;</para>

      <para arch="sparc64">Sun GEM ギガビットイーサネット、
	ERI ファストイーサネットアダプタに対応する gem ドライバが
	追加されました。</para>

      <para role="historic">&man.gx.4; ドライバが追加され、Intel 82542 と 82543
	のギガビットイーサネットコントローラチップに対応しました。
	ファイバと銅線の両方のカードに対応しています。
	VLAN タグ付け/挿入は両方のチップで対応しており、82543 では
	さらに TCP/IP チェックサム負荷低減機能にも対応しています。
	&merged;</para>

      <para arch="sparc64">多くの Sun Ultra シリーズにオンボードで
	搭載されている Sun HME ファストイーサネットアダプタ
	に対応する hme ドライバが追加されました。</para>

      <para>DEC <quote>Tulip</quote> PCI
        Fast Ethernet コントローラベースの
        LAN Media Corp WAN アダプタに対応した、
        &man.lmc.4; ドライバが追加されました。</para>

      <para role="historic">Level 1 LXT1001 NetCellerator
        ギガビットイーサネットコントローラチップに対応する
        &man.lge.4; ドライバが新たに追加されました。
        このドライバは SMC、D-Link、Addtron
        製の光ファイバギガビットイーサネットカードを利用するために
	使われるものです。
        Jumbograms および受信時の TCP/IP チェックサムの
	オフロード機能に対応していますが、
        ハードウェア VLAN フィルタには対応していません。
        &merged;</para>

      <para role="historic">Myson ファストイーサネットアダプタ、
	ギガビットイーサネットアダプタに対応する my ドライバが追加されました。
	&merged;</para>

      <para role="historic">National Semiconductor DP83820 および DP83821
        ギガビットイーサネットコントローラチップをベースとした
        PCI ギガビットイーサネットアダプタに対応する
        &man.nge.4; ドライバが新たに追加されました。
        これは D-Link DGE-500T、SMC EZ Card 1000 (SMC9462TX)、
        Asante FriendlyNet GigaNIC 1000TA および 1000TPC、
        Addtron AEG320T に対応しています。
        また、
	このドライバは送受信チェックサムのオフロード機能に対応しています。
        &merged;</para>

      <para role="historic">&man.pcn.4; ドライバが追加されました。
        これは AMD PCnet/FAST アダプタ、PCnet/FAST+ アダプタ、
        PCnet/FAST III アダプタ、
        PCnet/PRO アダプタ、PCnet/Home アダプタ、
        HomePNA アダプタに対応しています。
        これらのアダプタはすでに &man.lnc.4; ドライバが対応していますが、
        &man.pcn.4; ドライバは 32-bit モードで動作し、
        受信時のゼロコピーを実現する RX アラインメント機能を利用しています。
        このドライバはアーキテクチャに依存せず i386、pc98、Alpha
        プラットフォームで動作可能です。
        ただし非 PCI カードに対応するには &man.lnc.4; が必要になります。
        &merged;</para>

      <para role="historic">Webgear Aviator 無線ネットワークカードに対応する
        &man.ray.4; ドライバが追加されました。
        &man.ray.4; インターフェイスの動作は
        &man.raycontrol.8; で変更することが可能です。
        &merged;</para>

      <para arch="i386,pc98">&man.rp.4; ドライバがバージョン 3.02 に更新され、
	モジュールとして構築できるようになりました。&merged;</para>

      <para arch="i386" role="historic">ISA/PCI の point-to-point
	通信インターフェイス
	である Granch SBNI12 シリーズ用の sbni ドライバが
	追加されました。
	これらのデバイスを設定するのに、&os; Ports Collection の
	<filename role="package">sysutils/sbniconfig</filename>
	が利用できます。&merged;</para>

      <para role="historic">&man.sis.4; ドライバが
	SiS 900、SiS 7016 ファストイーサネットコントローラチップ
	(例えば SiS 635、735 マザーボードチップセット上のものなど) と、
        National Semiconductor DP83815 チップセット
	(NetGear FA311-TX および FA312-TX を含む) の
        PCI イーサネットアダプタに対応しました。
        このデバイスは VLAN に対応しています。&merged;</para>

      <para arch="pc98" role="historic">National Semiconductor
        DP8393X (SONIC) イーサネットコントローラに対応した
        snc ドライバが追加されました。
        現時点でこのドライバは PC-98 アーキテクチャでのみ使われています。
        &merged;</para>

      <para>&man.stf.4; デバイスがクローニングに対応しました。</para>

      <para role="historic">&man.tap.4; ドライバが追加されました。
        これはブリッジ構成で使うための仮想イーサネットドライバです。
	このデバイスはクローニング可能です。&merged;</para>

      <para role="historic">&man.ti.4; ドライバが Alteon AceNIC
        1000baseT ギガビットイーサネットカードおよび、
        Netgear GA620T 1000baseT ギガビットカードに対応しました。
        &merged;</para>

      <para role="historic">&man.ti.4;
	ドライバが VLAN タグを正しくマスクするようになりました。
        &merged;</para>

      <para>&man.tx.4;
        ドライバがマルチキャストフィルタリングに完全対応しました。
      <!-- hrs:2003/01/05 -
        This is changing the programming method of MC filter in the chip.
        "true multicast filtering" is not a new feature,
        is not one other than multicast filtering.
        --></para>

      <para role="historic">&man.txp.4; ドライバが追加されました。
        これは 3Com 3XP Typhoon/Sidewinder (3CR990) チップセットベースの
        ネットワークインターフェイスに対応しています。
        &merged;</para>

      <para role="historic">&man.vlan.4;
	デバイスがロード/アンロード/クローン化に
	対応しました。&merged;</para>

      <para role="historic">&man.wi.4;
	ドライバが Prism II、Prism 2.5 ベースの NIC
	に対応しました。104/128 ビット WEP も Prism カードで動くように
	なりました。&merged;</para>

      <para role="historic">&man.wi.4; ドライバを使って、
	&os; ホストを無線アクセスポイントとして使用できるようになりました。
	この機能は &man.ifconfig.8; の <literal>mediaopt hostap</literal>
	オプションで有効にすることができます。ただし、この機能に対応しているのは
	Prism II チップセットベースの無線アダプタのみです。
	&merged;</para>

      <para role="historic">&man.wi.4; ドライバが
	<application>bsd-airtools</application> に対応しました。&merged;</para>

      <para role="historic">xe ドライバがカーネルモジュールとして
        構築できるようになりました。&merged;</para>

      <para role="historic">&man.xl.4; ドライバが
        ラップトップで使われている 3Com 3C556 および
        3C556B MiniPCI アダプタに対応しました。
        &merged;</para>

      <para role="historic">&man.xl.4; ドライバが
        VLAN タグフレームの受信に対応しました
        (ただし <quote>Cyclone</quote> チップセットおよび、
        それ以降の新しいチップセットのみ)。
        &merged;</para>

      <para role="historic">&man.xl.4;
        ドライバが新しく、送信側・受信側双方における TCP/IP
        チェックサムの負荷低減機能に対応しました。これは、
        この機能に対応している 3C905B、3C905C、3C980C などの
        NIC に対して有効です。
	&merged;</para>

      <para role="historic">&man.xl.4;
        ドライバにおいて、
        統計情報のオーバフロー割り込みの処理に関連するバグが修正されました。
        これはパケットの送受信速度が中から高程度になった時に、
        処理速度が低下する原因となっていたものです。
        &merged;</para>

      <para role="historic">インターフェイス一つ一つに用意される
        <varname>ifnet</varname> 構造体に、
        ネットワークインターフェイスが対応している機能と、
        どの機能が有効化されているかを示す部分が追加されました。
        また &man.ifconfig.8; を使って、
        これらの情報を表示することが可能になっています。&merged;</para>

      <para role="historic">インターフェイス一つ一つに用意される
        <varname>if_inaddr</varname>構造体が、
        線形リストからハッシュテーブルに変更されました。
        これにより、多数の別名 IP
        アドレスを持っているホストの性能が向上しています。&merged;</para>

      <para>ネットワークデバイスが特殊ファイルとして
	<filename>/dev/net</filename> 以下に
	自動的に作成されるようになりました。
        これらのデバイスに対しては、(プロトコルやルーティング以外の)
        インターフェイスハードウェア ioctl が使用できます。
        また、<varname>SIOCGIFCONF</varname> ioctl は
        <filename>/dev/network</filename>
        特殊ファイルに対して使用することが可能です。</para>

      <para role="historic">いくつかのネットワークドライバは、
	システムが攻撃や過負荷により耐えられるように、半ポーリング
	モードを実装しました。
	ポーリングを有効にするには、カーネル設定ファイルに
	以下のオプションが必要です:

	<programlisting>options DEVICE_POLLING
options HZ=1000 # not compulsory but strongly recommended</programlisting>

	そして <varname>kern.polling.enable</varname> sysctl 変数
	によりポーリングモードを有効にし、
	<varname>kern.polling.user_frac</varname> sysctl 変数
	によりユーザランド側に確保しておく CPU 時間の割合を
	指定します。
	ポーリングに対応しているデバイスは &man.dc.4;、
	&man.fxp.4;、&man.rl.4;、&man.nge.4;、&man.sis.4; となっています。
	詳しくは &man.polling.4; マニュアルページを参照してください。
	&merged;</para>

      <para arch="i386,pc98" role="historic">
	いくつかのネットワークドライバ (特に &man.dc.4; と
	&man.sis.4;) におけるパケット転送の性能が向上しました。
        これは不必要なバッファコピーの削除によるものです。
        &merged;</para>

      <para>ネットワークスタックに
        <quote>ゼロコピー</quote>
        機能が追加されました。
        これはネットワークスループットにおけるボトルネックの主要因の一つである、
        カーネルとユーザランド間のデータコピーを抑制します。
        送信側のコードはほぼすべてのネットワークアダプタで動作すると思われますが、
        受信側のコードは、ネットワークアダプタの MTU が、
        メモリページサイズ 1 つ分の大きさ (たとえばギガビットイーサネット上の
        jumbo フレーム) 以上に設定できる必要があります。
        詳細は &man.zero.copy.9; をご覧ください。</para>
    </sect3>

    <sect3>
      <title>ネットワークプロトコル</title>

      <para role="historic">&man.accept.filter.9; が追加されました。
        これは listen しているソケット上で接続を新たに受け入れ、
        読み込みを行なう際のオーバヘッドを低減するカーネルの機能です。
        &merged;</para>

      <para role="historic">&man.arp.8; の <option>-d</option>
	オプションフラグにある
        <literal>proxy</literal> という修飾子が
        <option>-s</option> オプションフラグで使われているものと同じ
        <literal>pub</literal> という修飾子に変更されました。
        また、<option>-s</option> および
        <option>-S</option> オプションフラグに
        <literal>only</literal> キーワードが追加されました。
        これは <quote>proxy 専用</quote>
        の公開エントリを作成するために使います。&merged;</para>

      <para role="historic">pthread を使うことにより、
	&man.select.2;/&man.poll.2;
	を使った場合の &man.bpf.4; の読み出しタイムアウトの機能が
	より正しく動作するようになりました。&merged;</para>

      <para role="historic">&man.bridge.4; および &man.dummynet.4;
        に細かな改良とバグ修正が加えられ、ローダブルモジュールに
	なりました。&merged;</para>

      <para role="historic">&man.bridge.4;
	は複数の完全に独立したブリッジクラスタに
	対応し、動的な追加・削除に関してもより安定しました。
	VLAN 機能にも完全に対応しています。&merged;</para>

      <para>IPsec 実装でハードウェア暗号化アクセラレータに対応した
        カーネル &man.crypto.4; フレームワークが使えるようになりました。
        有効にするには、<literal>FAST_IPSEC</literal>
        カーネルオプションを指定します。

        <note>
          <para><literal>FAST_IPSEC</literal> オプションと
            <literal>IPSEC</literal> オプションを同時に指定することはできません。</para>
	</note>

        <note>
          <para>現時点では、<literal>FAST_IPSEC</literal> オプションは
            IPv6 または <literal>INET6</literal> オプションと共存できません。
            </para>
	</note>

	</para>

      <para>&man.gre.4; ドライバが追加されました。
        これは IP パケットを GRE (RFC 1701) や
        minimal IP encapsulation for Mobile IP (RFC 2004)
        を利用してカプセル化を行います。
        &merged;</para>

      <para>ICMP ECHO および TSTAMP
	応答速度に制限が加えられるようになりました。
        open 状態のポート、open 状態にないポートに対して送信されるパケットに
        よって生成される TCP RST は独立したカウンタを用いて制限されており、
        各々異なる種類の速度制限キューとして分けられています。</para>

      <para role="historic">正しいシーケンス番号が送り返されてきた場合に
        ICMP <literal>UNREACH_FILTER_PROHIB</literal> メッセージが
        <literal>SYN_SENT</literal>
	状態にある TCP 接続を RST できるようになりました。
        これは sysctl 変数 <varname>net.inet.tcp.icmp_may_rst</varname>
        で制御することができます。&merged;</para>

      <para>フォワードされたパケットに対して
        ICMP Source Quench メッセージを生成しなくなりました。
        これは sysctl 変数 <varname>net.inet.ip.sendsourcequench</varname>
        を使って、従来の動作に戻すことが可能です。</para>

      <para>IP マルチキャストが VLAN デバイス上で動作するようになりました。
        また、VLAN コードにあったいくつかのバグも修正されています。</para>

      <para role="historic">IPv4 において入ってくる SPD
	のチェックが無視されてしまう
	という IPsec 処理中のバグが修正されました。&merged;</para>

      <para role="historic">&man.ipfw.4; が TCP セグメント内に
        ECN ビットを含む場合にも正しくフィルタ動作を行なうようになりました。
        &merged;</para>

      <para>&man.ipfw.4; が再実装されました。
        (新しいバージョンは <quote>IPFW2</quote> と呼ばれています)。
        &man.ipfw.4; は、
        カーネル内で &man.bpf.4; 命令に似た可変長ルール表現を使っています。
        &man.ipfw.8; に、マッチフィールド連結子
        <literal>or</literal> が新しく追加されていますが、
        (&man.ipfw.8; に記載されている)
        外部に見える部分の動作のほとんどは変更されていません。
        &merged;</para>

      <para role="historic">
	ng_eiface netgraph モジュールが新たに追加されました。
	Netgraph フックへイーサネットフレームを配送する
	イーサネットインターフェースとして振舞います。&merged;</para>

      <para>&man.ng.device.4; netgraph ノードが新たに追加されました。
        これは <filename>/dev</filename> に、
        ネットワークグラフへのエントリポイントとして利用できる        
        デバイスエントリを作成するものです。</para>

      <para role="historic">&man.ng.etf.4; netgraph ノードは Ethernet タイプの
	パケットを、ethertype に応じて異なったフックでフィルタ
	できるようになりました。&merged;</para>

      <para>&man.gif.4; で動作する netgraph ノード
        &man.ng.gif.4; および &man.ng.gif.demux.4;
        が新しく追加されました。</para>

      <para>IP の入力処理を行なうコードに入る前のキューに格納された
        IP パケットに対応する
        netgraph ノード &man.ng.ip.input.4; が新しく追加されました。</para>

      <para>新しい netgraph ノードタイプ &man.ng.l2tp.4; が追加されました。
	これは RFC 2661 に記載されている
	L2TP プロトコルのカプセル化レイヤを実装したものです。
	&merged;</para>

      <para role="historic">&man.netgraph.4; サブシステムに
        &man.ng.mppc.4; と &man.ng.bridge.4; のノードタイプが新たに追加され、
        &man.ng.ether.4; ノードが動的にロード可能になりました。
        また、細かなバグ修正と改良も加えられています。
        &merged;</para>

      <para role="historic">複数のリンク上でパケットの多重化を行なう
        netgraph ノードタイプ &man.ng.one2many.4; が新たに追加されました。
        &merged;</para>

      <para>新しく ng_split ノードタイプが追加されました。
	これは一つの双方向パケットフローを
        二つの単方向パケットフローに分割します。</para>

      <para role="historic">sysctl 変数
	<varname>net.inet.ip.check_interface</varname>
        が新たに追加されました。これは標準設定で on になっており、
        パケットの送信先アドレスと一致するアドレスを持ったインターフェイスに
        パケットが到着したかどうか IP レベルでチェックを行ないます。
        &merged;</para>

      <para role="historic">sysctl 変数
        <varname>net.link.ether.inet.log_arp_wrong_iface</varname>
        が新たに追加されました。これは ARP
        要求が間違ったインターフェイスに到着した時の
	ログ記録を抑制するかどうか制御するためのものです。
        &merged;</para>

      <para role="historic">IP パケットの ID フィールドを乱数化する
        <literal>options RANDOM_IP_ID</literal>
        カーネルオプションが追加されました。
        これはリモートの観測者が、
        各送信パケットに対して一つずつカウントを
	増加させるという標準的な動作から
        マシンのパケット生成速度を推定できないようにするものです。
        &merged;</para>

      <para arch="alpha">SLIP が
        <filename>mfsroot</filename>
        フロッピイメージから削除されました。</para>

      <para role="historic">ACK が遅れるという TCP のバグが修正されました。
        &merged;</para>

      <para role="historic">TCP が TCP Fast Recovery アルゴリズムに対する
	NewReno の変更に対応しました。この動作は sysctl 変数
        <varname>net.inet.tcp.newreno</varname> で制御することができます。
        &merged;</para>

      <para role="historic">TCP が初期 SYN
        セグメントに対してより積極的にタイムアウトするようになりました。
        これにより、初期の接続試行をより早く中断することが可能になっています。
        &merged;</para>

      <para role="historic"><literal>TCP_COMPAT_42</literal>
        カーネルオプションが削除されました。&merged;</para>

      <para role="historic"><literal>TCP_RESTRICT_RST</literal>
	カーネルオプションが削除されました。
        同様の機能は sysctl 変数
        <varname>net.inet.tcp.blackhole</varname> で実現可能です。
        &merged;</para>

      <para role="historic">&man.rc.conf.5; の標準設定において
        TCP の RFC 1323 拡張が有効化されるようになりました。
        &merged;</para>

      <para role="historic">接続が確立される際、三番目の SYN
        セグメントが送られるまでに反応がなかった場合は
        RFC 1323 および RFC 1644 の TCP 拡張が無効化されるようになりました。
        この動作は VJ ヘッダ圧縮の実装にバグがある
        (非常に古い) ターミナルサーバに対応するためのものです。
        &merged;</para>

      <para role="historic">各接続に対して TCP
        テンプレート構造体のメモリ割り当てを行なわないように
        TCP 実装が変更されました。
        これは多くの接続を扱う大規模システムにおいて
	バッファの使用量を低減します。
        &merged;</para>

      <para role="historic">sysctl 変数
        <varname>net.inet.tcp.sendspace</varname> および
        <varname role="historic">net.inet.tcp.recvspace</varname>
        で制御されている TCP の標準バッファサイズがそれぞれ
        32K と 64K に増やされました。
	従来は両方とも 16K のバッファサイズでした。
	輻輳の頻度が上がることを防ぐために、
	<varname>net.inet.tcp.local_slowstart_flightsize</varname>
	のデフォルトの値が無限から 4 に変更されました。
	&merged;
        <note>
	  <para>負荷のかかるホストでは、新しい大きなバッファサイズ
	    では <varname>NMBCLUSTERS</varname> パラメータの値を
	    カーネル設定ファイルか調整可能なローダ変数
	    <varname>kern.ipc.nmbclusters</varname>
	    のどちらかで手動で増やす必要があるかも知れません。
	    mbuf クラスタの状態は
	    <command>netstat -mb</command>
	    で監視することができます。</para>
	</note>
      </para>

      <para role="historic">TCP の実装が
	RFC 1948 (Defending Against Sequence Number Attacks) に対応しました。
	sysctl 変数 <varname>net.inet.tcp.isn_reseed_interval</varname> 
	は RFC 1948 初期シーケンスナンバーの計算において利用される
	秘密データの再設定間隔を制御します。
	&merged;</para>

      <para role="historic">&os; の TCP 実装は、顕著な受信 SYN セグメントの
	キャッシュを実装しました。
	入ってくる SYN セグメントは、TCP three-way handshake
	が完了するまではキャッシュ内にエントリされ、完了後に
	通常通りコネクション用のメモリが確保されます。
	加えて、すべての TCP 初期シーケンス番号 (ISN) がクッキー
	として使われ、エントリがキャッシュから消されてしまっても
	対応する ACK を後で受け付けられるようにします。
	この <quote>syncache</quote> と <quote>syncookies</quote>
	の組合わせにより、ホストは
	TCP ベースの Denial of Service 攻撃により耐えられるように
	なります。
	この機能のスポンサーは DARPA と NAI Labs です。&merged;</para>

      <para role="historic">TCP 実装において、送信側が大きさ 0 のウィンドウ
	を受け取ったときに接続が固まってしまうというバグが
	修正されました。&merged;</para>

      <para role="historic">TCP 実装が、
	IP 層のブロードキャストアドレスに向けられたパケットを
	正しく無視するようになりました。&merged;</para>

      <para>TCP、UDP で使われるエフェメラルポート
	(ephemeral port) の範囲が 1024&ndash;5000 から
	49152&ndash;65535 に変更されました。
	これにより並列に出ていくことのできる接続/ストリームの数が増加します。</para>

    <para>&man.tcp.4; プロトコルの再送タイマが
      <varname>net.inet.tcp.rexmit_min</varname> と
      <varname>net.inet.tcp.rexmit_slop</varname> の、
      2 つの sysctl 変数で操作できるようになりました。
      デフォルトは従来の 1 秒から (Linux のデフォルト値と同じ)
      200 ミリ秒に減らされています。
      これは、対話的な接続における応答遅延の改善や、
      無線のようにパケットロスのある高速回線における、
      タイムアウトからの復帰時間の短縮をねらったものです。</para>

    <para>&man.tcp.4; プロトコルに、
      送信側のウィンドウのサイズを動的に制限して、
      帯域を最大化し、ラウンドトリップタイムを最小にするための
      機能が追加されました。この機能は、
      sysctl 変数 <varname>net.inet.tcp.inflight_enable</varname>
      を使って有効化することが可能です。&merged;</para>

    </sect3>

    <sect3>
      <title>ディスク・記憶装置</title>

      <para arch="i386" role="historic">&man.aac.4; が
        Adaptec PCI-SCSI RAID コントローラの FSA ファミリに対応しました。
	このドライバは、アダプタによって発行されるコマンド、
        ディスクデバイスの脱着、クラッシュダンプ機能、
        CLI 管理に使われる &man.ioctl.2; コマンドが正しく処理される
	ようになり、Adaptec により検証・認定されました。
        &merged;</para>

      <para role="historic">&man.ahc.4; ドライバに対して非常に数多くの更新や
        バグ修正、改良が加えられました。
        それには <quote>RAID Port</quote> モードでの動作、
        AAA や ARO カードを搭載したシステムでの動作が可能になったこと、
        また、パフォーマンスの向上などが含まれています。
        Ultra2/U160
        コントローラでまれにハングアップが発生するといったバグを含め、
        いくつかのバグも修正されています。
        &merged;</para>

      <para arch="i386">&man.ahd.4; ドライバが追加されました。
        これは Adaptec AIC7901, AIC7901A, AIC7902
        Ultra320 PCI-X SCSI コントローラチップに対応しています。
        &merged;</para>

      <para arch="i386" role="historic">
        Adaptec SCSI RAID コントローラファミリ、
        および DPT SmartRAID V、VI ファミリに対応する
        &man.asr.4; ドライバが新たに追加されました。
        &merged;</para>

      <para arch="i386" role="historic">&man.asr.4; ドライバが
        Adaptec 2000S、2005S Zero-Channel RAID コントローラに対応しました。
        &merged;</para>

      <para role="historic">&man.ata.4;
	ドライバが ATA100 コントローラに対応しました。
        さらに ServerWorks ROSB4 ATA33 チップセット、
        CMD 648 ATA66 チップセット、
        CMD 649 ATA100 チップセット、
        Cyrix 5530 にも対応しています。
        &merged;</para>

      <para role="historic">設定をより柔軟に行なえるよう、
        &man.ata.4;
        ドライバの多くのオプションはカーネルコンフィグレーション時だけでなく、
        ブートローダからも設定を変更できるようになりました。
        &merged;</para>

      <para role="historic">&man.ata.4;
	ドライバがタグキューイング機能に対応しました。
        これは <varname>hw.ata.tags</varname> で制御可能で、
        ブートローダからも設定できます。
        &merged;</para>

      <para role="historic">&man.ata.4; ドライバが
        Promise Fasttrak
	コントローラおよび HighPoint HPT370 コントローラのような
        ATA <quote>疑似</quote> RAID コントローラに対応しました。
        &merged;</para>

      <para role="historic">&man.ata.4;
	ドライバは Hardware Notes にも載っているように
	様々な SiS チップセットに対応しました。&merged;</para>

      <para role="historic">&man.ata.4; ドライバが、&man.atacontrol.8; を使った
	ATA RAID の生成、削除、クエリ、再構築に対応しました。&merged;</para>

      <para role="historic">ATAPI CD-R ドライブの BurnProof(TM)
	機能に対応しました。
        &merged;</para>

      <para role="historic">&man.ata.4;
	ドライバは 48-bit アドレスに対応しました。
	137GB より大きなデバイスに対応したことになります。&merged;</para>

      <para role="historic">&man.ata.4;
	ドライバで、VIA 82C686B サウスブリッジチップ
	を使ったシステムにおいて、データが壊れる場合があることへの
	対策が行なわれました。&merged;</para>

      <para>&man.ata.4; ドライバ (および &man.burncd.8;) に
	DVD+RW メディアへの書き込み機能が追加されました。</para>

      <para>&man.ata.4; ドライバが、
	CAM レイヤと CAM ドライバ
	(&man.cd.4;, &man.da.4;, &man.st.4;, &man.pass.4;)
	を経由して、ATA デバイスを
	SCSI デバイスとしてアクセスできるようにする機能に対応しました。
	この機能を有効にするには、
	カーネルコンフィグファイルに
	<literal>device atapicam</literal> を追加する必要があります。
	詳細は &man.atapicam.4; をご覧ください。</para>

      <para>&man.ata.4; ドライバが新しく
        Sil 0680 と VIA 8233/8235 コントローラに対応しました。
        &merged;</para>

      <para>&man.ata.4; ドライバが新しく Acard
	ATP850, ATP860, ATP865 コントローラに対応しました。</para>

      <para arch="pc98">&man.ata.4; ドライバが pc98
        プラットフォームに対応しました。</para>

      <para role="historic">&man.cd.4; ドライバが書き込み操作に対応しました。
        これにより、DVD-RAM、PD
        といった CD デバイスとして認識されるドライブへ書き込むことが可能です。
        ただしこの変更はランダムアクセス可能な
	書き込みデバイスにのみに有効なもので、
        CD-R ドライブのようなシーケンシャルアクセス専用の書き込みデバイスには
        関係しません。CD-R ドライブは &man.cdrecord.1;
        (Ports Collection の
	<filename role="package">sysutils/cdrtools</filename> に含まれています)
        が対応しています。
        &merged;</para>

      <para>&man.cd.4; ドライバが、
        &man.acd.4; ドライバが CDROM のアクセス速度を設定するのに使用している
        <literal>CDRIOCREADSPEED</literal>, 
        <literal>CDRIOCWRITESPEED</literal> ioctl に対応しました。</para>

      <para>&man.targ.4; ドライバが書き直されました。また、
        ダイレクトアクセスデバイスをエミュレートする新しいユーザモードプログラムが
        <filename>/usr/share/examples/scsi_target</filename> に追加されました。</para>

      <para arch="i386" role="historic">SCSI-3
        共通インターフェイスを使うデバイス用の &man.ciss.4; ドライバが追加されました。
	このドライバは Compaq の SmartRAID 5* ファミリ RAID
	コントローラ (5300、532、5i) に対応しています。&merged;</para>

      <para>&man.fdc.4; フロッピーディスクコントローラドライバに
        多くの機能強化が行なわれました。一般的な設定における密度の選択は
	自動化され、ドライバはさまざまなサブデバイスの密度設定
	に柔軟に対応できるようになりました。</para>

      <para>&man.geom.4; ディスク I/O 要求変換フレームワークが追加されました。
        これは、カーネルの上位からのデバイスドライバに対する I/O 要求に、
        さまざまな操作を加えられるように設計された、
	拡張可能なフレームワークです。

	<note>
	  <para>GEOM を有効にしたカーネルは
	    <quote>互換スライス</quote> に対応していません。
	    (i386 と pc98 のみが対応していた) この機能は、
	    (たとえば <filename>/dev/ad0a</filename> のように)
	    ユーザが MBR スライスを指定していない場合に、
            カーネルが自動的に先頭にある有効な &os; スライスを探し出して、
            そのディスクパーティションにアクセスすることができるというものです。
	    GEOM が有効になっているカーネル (デフォルトで有効)
            で MBR スライス中のパーティションを参照するには、
	    完全なパーティション名
	    (たとえば <filename>/dev/ad0s1a</filename>)
	    を指定する必要があります。
	    この変更はごく限られたユーザにしか影響をおよぼさないでしょう。</para>
	</note>

	</para>

      <para>GEOM ベースのディスク暗号化モジュール (GEOM Based Disk Encryption)
        が追加されました。
        これは、四個の暗号保護層と
        最大で四個設定できる変更可能なパスフレーズを利用して、
        <quote>非動作中のディスク (cold disk)</quote> に対するアクセスを排除します。
        より詳細な情報は &man.gbde.4; のマニュアルページをご覧ください。
        このモジュールの操作および管理用に、&man.gbde.8;
        ユーザランドユーティリティが提供されています。
        この機能はデフォルトでは有効にされていません。利用するには
        カーネルコンフィグファイルに
        <literal>options GEOM_BDE</literal> を追加してください。

	<note>
	  <para>この機能は実験的なものと考えられています。</para>
	</note>

	</para>

      <para role="historic">&man.ida.4; ディスクドライバが
	クラッシュダンプに対応しました。
        &merged;</para>

      <para arch="i386" role="historic">&man.iir.4; ドライバが
	Intel 内蔵 RAID コントローラ
	に対応しました。古い ICP Vortex コントローラにも対応しています。</para>

      <para arch="alpha" role="historic">&man.isp.4; が対応している
        SCSI カードに接続されている特定の CDROM
        を認識しないというバグが修正されました。
        &merged;</para>

      <para>&man.isp.4;
        ドライバはファイバチャネルのトポロジ変更を
	積極的に検出するように変更されました。</para>

      <para>&man.isp.4; ドライバが
        Qlogic SCSI カードのターゲットモードに対応しました。
        これには Ultra2、Ultra3、デュアルバスカードが含まれます。</para>

      <para role="historic">&man.isp.4; ドライバが Qlogic 2300/2312 Optical
	Fibre Channel PCI カードに対応しました。&merged;</para>

      <para arch="i386,pc98">&man.matcd.4; ドライバは、
        ライセンス上の問題でソースが修正できないため、削除されました。
        現在この問題に取り組んでおり、&os; の将来のリリースで
        再度このドライバが登場するかも知れません。
        &merged;</para>

      <para>メモリディスクデバイス &man.md.4; に
        &man.vn.4; の機能が統合されました。
        &man.md.4; デバイスは &man.mdconfig.8; で設定できるようになり、
        &man.vn.4; は削除されています。
        また、メモリファイルシステム (MFS) も削除されました。</para>

      <para arch="i386,alpha,pc98,sparc64">mpt
	ドライバが新しく追加されました。
	これは、LSI Logic Fusion/MP アーキテクチャ
	ファイバチャネルコントローラに対応しています。&merged;</para>

      <para arch="i386" role="historic">firmware 6.X 以降を搭載した
        Mylex PCI to SCSI AccelRAID コントローラおよび
        eXtremeRAID コントローラに対応する
        &man.mly.4; ドライバが新たに追加されました。
        &merged;</para>

      <para arch="i386,pc98" role="historic">NetBSD/pc98 から
        ncv、nsp、stg ドライバが移植されました。
        これらは NCR 53C50 / Workbit Ninja SCSI-3 / TMC 18C30、18C50
        ベースの PC-Card/ISA SCSI コントローラに対応しています。
	これらのドライバはモジュールとして構築、ロードできます。
        &merged;</para>

      <para arch="powerpc">The ofw driver, a basic OpenFirmware disk
	driver, has been added.</para>

      <para arch="i386">&man.pst.4; ドライバが新しく追加されました。
	これは Promise SuperTrak ATA RAID コントローラに対応しています。
	&merged;</para>

      <para>NetBSD 由来の RAIDframe ディスクドライバが統合されました。
        このドライバは、ソフトウェアによる RAID 0, 1, 4, 5 機能や、
        (訳注: 循環スペア RAID 5 やインターリーブデクラスタリングなどの)
        その他の RAID 機能を提供します。
        詳細は &man.raid.4; ドライバのマニュアルページをご覧ください。
        &man.raidctl.8; ユーティリティは
        ディスクアレイの設定や設定解除に利用されます。
        この機能はデフォルトでは無効にされており、
        有効にするにはカーネルコンフィグファイルに
        <literal>device raidframe</literal> を追加する必要があります。

	<note>
	  <para>この機能は実験的なものと考えられています。</para>
	</note>

	</para>

      <para>&man.sa.4; エラー処理にあったいくつかの問題点が修正されました。
        これには
        <quote>テープドライブが &man.mt.1; <option>stat</option>
          に追随せずにまわってしまう</quote>
        という問題も含まれています。</para>

      <para><varname>SCSI_DELAY</varname> 設定パラメータが、
	<varname>kern.cam.scsi_delay</varname> sysctl 変数を利用して
        起動時および実行時に変更できるようになりました。</para>

      <para>Tekram TRM-S1040 SCSI チップセットが搭載された
        SCSI アダプタに対応する &man.trm.4; ドライバが追加されました。
        &merged;</para>

      <para arch="i386" role="historic">3ware ATA RAID に対応する
        &man.twe.4; ドライバが追加されました。&merged;</para>

      <para role="historic">&man.wd.4; 互換デバイスが
        &man.ata.4; ドライバから削除されました。
        &merged;</para>
    </sect3>

    <sect3>
      <title>ファイルシステム</title>

      <para>&os; カーネルが新たに名前付き拡張属性 (named extended attributes)
        に対応しました。
        これはカーネルおよび高い権限を持つユーザランドプロセスが、
        ファイルとディレクトリに
	属性情報をタグ付けすることを可能にするものです。
        拡張属性は TrustedBSD プロジェクトに対応するために追加されたもので、
        特に ACL、ケーパビリティ情報、必須アクセス制御ラベルが含まれています
        (詳細は <filename>/usr/src/sys/ufs/ufs/README.extattr</filename>
        参照)。</para>

      <para role="historic">ライセンスの変更により
        Soft Updates がカーネルソースツリーの主要部に統合され、
        <filename>GENERIC</filename> カーネルでの利用が可能になりました。
        &merged;</para>

      <para>FFS にファイルシステムのスナップショット機能が追加されました。
        詳細は <filename>/usr/src/sys/ufs/ffs/README.snapshot</filename>
        にあります。</para>

      <para>&man.statfs.2; および &man.df.1; は
        Soft Updates 利用時に commit
        されて解放されたファイルとブロック数を記録するようになりました。</para>

      <para role="historic">非常に大容量のファイルシステムで
	スーパブロックが破損する可能性のあった
        FFS におけるバグが修正されました。
        &merged;</para>

      <para role="historic">ISO-9660 ファイルシステムに対し、新たに
        ロード可能なキャラクタ変換ルーチンに
	対応するためのフックが追加されました。
        良く使われる変換ルーチンは
        <filename role="package">sysutils/cd9660_unicode</filename>
        の port に含まれています。&merged;</para>

      <para>&man.kernfs.5; は廃止され、削除されました。</para>

      <para role="historic">NFS クライアントにおいて、
        <literal>O_EXCL|O_CREAT</literal>
        オープン時に不正なアクセスタイムを生成するバグが修正されました。
        &merged;</para>

      <para role="historic"><varname>nfsnode</varname>
        ハッシュテーブルを効率化し、NFS 性能を向上させるために
        (Fowler/Noll/Vo ハッシュアルゴリズムに基づく) 新しい
        NFS ハッシュ関数が実装されました。
        &merged;</para>

      <para>クライアント側における
        NFS ロックが実装されました。</para>

      <para>カーネル内で複雑に混ざりあっていた NFS のコードが、
        保守と将来的な開発を容易にするためにクライアント側と
	サーバ側に分離されました。</para>

      <para>ファイルシステムにアクセス制御リスト (ACLs) が導入されました。
        ACL はファイルやディレクトリに対して、
        より粒度の細かく自由度の高いアクセス制御を可能にするもので、
        TrustedBSD プロジェクトから統合されたものです。
        詳細は
        <filename>/usr/src/sys/ufs/ufs/README.acls</filename>
        をご覧ください。</para>

      <para role="historic">FFS のディレクトリ配置の優先アルゴリズム
	(<literal>dirprefs</literal>) が変更されました。
	ディレクトリブロックをディスク内で分散させるのではなく、
	ディレクトリブロックに関連したグループにまとめようと試みます。
	&os; Ports ツリーのように巨大なディレクトリ階層を横断する
	ような操作の速度がアップします。
	この変更は表面的にはなんの影響も与えませんし、
	新しいディレクトリに対しては自動的に適用されます。&merged;</para>

      <para arch="i386,pc98" role="historic">カーネルが smbfs (CIFS)
	に対応しました。
	SMB 共有を扱うのにはユーザランドプログラムの
	&man.smbutil.1; と &man.mount.smbfs.8; が利用できます。
	&man.mount.smbfs.8; は <literal>LIBMCHAIN</literal> と
	<literal>LIBICONV</literal> がカーネルに組み込まれて
	いなくても、自動的に <filename>smbfs.ko</filename>
	モジュールをロードしてしまうことに
	注意してください。&merged;</para>

      <para>一貫性を維持するため、
        fdesc、fifo、null、msdos、portal、umap、union
        の各ファイルシステムはそれぞれ
        fdescfs、fifofs、msdosfs、nullfs、portalfs、umapfs、
        unionfs という名前に変更され、
        モジュールや mount_* プログラムなども名前が変更されました。
        また、&man.fstab.5; 内にある <literal>msdos</literal>
        ファイルシステムのエントリが変更なしに動作できるよう、
        互換性を維持するための
        <quote>措置</quote>
        が &man.mount.8; に加えられています。</para>

      <para>疑似ファイルシステム pseudofs が新たに追加されました。
        &man.linprocfs.5; と &man.procfs.5; は pseudofs
	を利用するように変更されています。</para>

      <para role="historic">巨大なディレクトリ用に、
        <literal>dirhash</literal> と呼ばれる単純なハッシュをベース
	とした検索効率化処理が追加されました。
        <literal>UFS_DIRHASH</literal> カーネルオプション
        (<filename>GENERIC</filename> カーネルでデフォルトでオン)
	の設定により、メモリを多少余分に使って巨大なディレクトリの
	操作速度を向上させることが可能です。&merged;</para>

      <para role="historic">VM サブシステムはデフォルトで UFS ディレクトリ用の
	メモリ要求を担うようになりました
	(この挙動は <varname>vfs.vmiodirenable</varname> sysctl 変数
	で制御されます)。&merged;</para>

      <para role="historic">SCSI CDROM
	からルートファイルシステムがマウントできない
	バグが修正されました (ATAPI CDROM は問題ありません)
	&merged;</para>

      <para role="historic">ファイルシステムテストツール
	<application>fsx</application> を使うことにより発見された
	いくつかのバグが修正されました。
	ある状況下で (主に NFS を使っている際に)
	これらのバグはデータの破壊やカーネルパニックを引き起こして
	いました。&merged;</para>

      <para><filename>/etc/fstab</filename> に記されている
	ネットワークファイルシステム (NFS や smbfs ファイルシステム
	など) がスタートアップの初期化時にきちんとマウントされる
	ようになりました。
	これらのマウントはネットワークが初期化された後まで遅延
	されます。</para>

      <para>UDF (Universal Disk Format) の読みとりに対応しました。
        UDF はパケットライトで書かれた CD-RW やほとんどの
        DVD-Video ディスク製品で使われています。
        UDF のディスクをマウントするには &man.mount.udf.8;
        コマンドを使います。</para>

      <para>UFS2 ファイルシステム対応の基本部分が追加されました。
        UFS2 の主な新機能は次のとおりです。

	<itemizedlist>
	  <listitem>
	    <para>64-bit プロックポインタに対応するため、
              inode が 256 バイトに拡張。</para>
	  </listitem>

	  <listitem>
	    <para>ファイルの作成時刻のフィールドの追加。</para>
	  </listitem>

	  <listitem>
	    <para>ネイティブな拡張属性の実装。
	      これにより、1 つの inode に格納できる属性領域のサイズの最大が、
              ファイルシステムのブロックサイズの 2 倍まで拡張されています。
	      この領域はアクセス制御リスト (ACL) と
	      MAC ラベルでの利用を目的としていますが、
	      システムの拡張やユーザアプリケーションで
	      利用することもできます。</para>
            <!-- hrs:2003/01/05 -
            "a native extended attribute" means
            UFS Extended Attributes implemented by rwatson@,
            and "native" probably means "UFS2 has naturally it,
            but UFS1 does not."  When you want to use the
            feature with UFS1, "options UFS_EXTATTR" and
            several operations using extattrctl(8) are needed.
            So, it is not native, isn't it?
            -->
	  </listitem>
	</itemizedlist>

        UFS2 は &man.newfs.8; にオプションを指定するか、
        &man.sysinstall.8; のパーティション設定画面で選択すことができますが、
        デフォルトのディスクフォーマットは UFS1 です。
        64 ビットのプラットフォームでは、UFS2
        ルートファイルシステムから起動することができます。
      </para>

      <para>この節で説明している新機能に対応するため、
        UFS1 スーパブロックのフォーマットが少し変更されました。
        この変更は、&os; 4.7-RELEASE より古いシステムから、
        &os; &release.current; かそれ以降のシステムで作成した
        ローカルの UFS1 ファイルシステムを
        &man.mount.8; もしくは &man.fsck.8;
        しようとした場合に、互換性の問題を生じるかもしれません。
        &os; 4.7-RELEASE とそれ以降のシステムとは、
        完全な互換性があります。これは通常、
        複数のバージョンの &os;
        をインストールしたデュアルブートマシンで問題となります。</para>
    </sect3>

     <sect3>
      <title>PCCARD 対応</title>

      <para arch="i386,pc98" role="historic">pccard ドライバおよび
	&man.pccardc.8;
        が複数の
        <quote>カード着脱音</quote>
        に対応しました。
        &merged;</para>

      <para role="historic">比較的新しいマシンの多くで、PCCARD
	デバイスの割り込みを
        ISA もしくは PCI のいずれかの割り込み経路に設定することが
	可能になりました。
        &man.pcic.4; ドライバが更新され、新たにその両方の割り込み経路に対応
        (以前は ISA のみの対応でした) しています。&merged;
        ほとんどのラップトップ型 PC における PCMCIA
        デバイスの設定が簡単で柔軟に行なえるようになっています。
        また、さまざまある PCI バスを使った
	Cardbus ブリッジ (Orinoco 社の PCI NIC
        で使われています) にも対応しました。
        PCI 割り込み経路制御が原因で、
        マシンの異常停止やパニック等の問題が発生するものもありますが、
        その場合は従来の ISA 割り込み経路制御に
	設定することで問題を解決できる可能性があります。
        その際には <filename>/boot/loader.conf</filename>
        にある次の行を書き換えてください。</para>

      <programlisting role="historic">hw.pcic.intr_path="1"
hw.pcic.irq="0"</programlisting>

      <para role="historic">&os; を問題の発生するマシンにインストールする際は、
        一番最初の起動中、ブートローダに次の行を入力すると良いでしょう。</para>

      <screen role="historic"><prompt>ok</prompt> <userinput>set hw.pcic.intr_path="1"</userinput>
<prompt>ok</prompt> <userinput>set hw.pcic.irq="0"</userinput></screen>

      <para arch="i386">NEWCARD が暫定的に Cardbus に対応しました。
	このコードは 32 ビットと 16 ビット両方のカードに対応し、
        すべての CardBus
        ブリッジに加え、TI-1030 PCMCIA-PCI ブリッジに対応しています。
        その他の PCMCIA-PCI ブリッジ、ISA
        ブリッジにはまだ対応していません。</para>

      <para arch="i386">NEWCARD が
        <filename>GENERIC</filename> カーネルのデフォルトの
        PCCARD/CardBus システムになりました。</para>

    </sect3>

    <sect3>
      <title>マルチメディアへの対応状況</title>

      <para arch="i386" role="historic">&man.pcm.4; ドライバが
        ESS Solo 1、Maestro-1、Maestro-2、Maestro-2e に対応しました。
        また Forte Media fm801、ESS Maestro-2e、
        VIA Technologies VT82C686A サウンドカード/サウンドチップにも対応し、
        いくつか他の更新も行なわれました。
        別にあった SoundBlaster 8 および SoundBlaster 16
        用ドライバは従来の統一ドライバに置き換えられ、
        CMedia CMI8338/CMI8738 サウンドチップ用ドライバ、
        S3 SonicVibes チップセット用ドライバがそれぞれ新たに追加されています。
        &merged;</para>

      <para arch="i386" role="historic">Avance Logic ALS4000
	用ドライバが新たに追加されました。
        &merged;</para>

      <para arch="i386" role="historic">ESS Maestro-3/Allegro
	用ドライバが新たに追加されました。
        ただしライセンス上の問題があるため、
        それを含んだカーネルを構築することはできません。
        &merged;
        このドライバを利用するには、次の行を
        <filename>/boot/loader.conf</filename> に追加してください。</para>

      <programlisting role="historic">snd_maestro3_load="YES"</programlisting>

      <para arch="i386">VT8233
        オーディオコントローラのドライバが、
        すべてのリビジョンのハードウェアに対応しました。
        このドライバは、カーネルコンフィグファイルに
        <literal>device pcm</literal> を追加するか、
        <filename>/boot/loader.conf</filename> に
        <literal>snd_via8233="YES"</literal> と追加することで
        起動時にロードすることが可能です。
        このドライバは、VIA から提供された資料を用いて開発されました。
        &merged;</para>

      <para role="historic">&man.bktr.4; ドライバがバージョン 2.18 に更新され、
        非常に多くの新機能が提供されています。
        新しいチューナタイプの追加および
        KLD モジュールとメモリ割り当ての改良が行なわれ、
        モジュールのアンロード、再ロード時の &man.devfs.5;
        のバグが修正されました。
        また、新たに Hauppauge モデル 44xxx WinTV カード
        (音声多重が搭載されていないもの) に対応しています。&merged;</para>

      <para arch="i386,pc98" role="historic">D-Link DSB-R100 USB
	ラジオに対応する ufm ドライバ
	が追加されました。&merged;</para>

      <para role="historic">サウンドモジュールを構築している場合
        <command>kldload snd</command>
        とするだけでドライバ等の必要なものすべてをロードすることが
	できるようになりました。&merged;</para>

      <para>ハードウェア音量制御機能を持つサウンドカード用の新しい
        API が追加されました。</para>

      <para arch="i386" role="historic">Intel 443MX、810、815、815E
        統合サウンドデバイス用のドライバが追加されました。&merged;</para>

      <para arch="i386" role="historic">via82c686 サウンドドライバが
	VIA VT8233 に対応しました。&merged;</para>

      <para arch="i386" role="historic">ich サウンドドライバが SiS 7012
	チップセットに
	対応しました。&merged;</para>

      <para arch="i386">ich サウンドドライバに、
	ich4 オーディオ対応の基本部分が追加されました。&merged;</para>

      <para arch="i386">DRI (Direct Rendering Infrastructure)
	用ドライバが追加されました。
	このドライバは <application>XFree86</application> に
	3D アクセラレーション機能を提供します。
	対応するビデオカードは
	3Dlabs Oxygen GMX 2000 (gammadrm)、
	AGP Matrox G200/G400/G450/G550 (mgadrm)、
	3dfx Voodoo 3/4/5/Banshee (tdfxdrm)、
	AGI ATI Rage 128 (r128drm)、
	AGP ATI Radeon (radeondrm) です。</para>

    </sect3>

    <sect3>
      <title>寄贈ソフトウェア</title>

      <para>ブートローダで使用されている
        Forth Inspired Command Language
        (<application>FICL</application>) が
        バージョン 3.02 に更新されました。</para>

      <para>自動設定および電源管理の規格で業界標準となっている
        ACPI (Advanced Configuration and Power Interface)
        に新しく対応しました。
        ACPI の機能は <application>Intel ACPI Component
          Architecture</application> プロジェクトから提供されているもので、
        ACPI CA 20021118 スナップショットに更新されています。
	旧来の APM 標準を用いるアプリケーション向けの後方互換性
	も提供されました。</para>

      <sect4>
        <title>IPFilter</title>

	<para><application>IPFilter</application> はバージョン
	  3.4.29 に更新されました。&merged;</para>

	<para role="historic"><application>IPFilter</application> が IPv6
	  に対応しました。&merged;</para>

      </sect4>

      <sect4 arch="i386">
        <title>isdn4bsd</title>

	<para><application>isdn4bsd</application> が
          バージョン 1.0.2 に更新されました。</para>

	<para role="historic">&man.ifpi.4; ドライバが追加されました。
          これは AVM Fritz!Card PCI コントローラに対応しています。
          &merged;</para>

	<para role="historic">&man.ifpi2.4; ドライバが追加されました。
          これは AVM Fritz!Card PCI version 2 コントローラに対応しています。
          &merged;</para>

	<para role="historic">Cologne Chip Designs HFC デバイスを
          <application>isdn4bsd</application> に対応させる
          &man.ihfc.4; ドライバが新たに追加されました。
          &merged;</para>

        <para role="historic">NETjet-S / Teles PCI-TJ デバイスを
          <application>isdn4bsd</application> に対応させる
          &man.itjc.4; ドライバが新たに追加されました。
          &merged;</para>

        <para role="historic">実験的なものですが、
          &man.isic.4; <application>isdn4bsd</application> ドライバが
          Eicon.Diehl DIVA 2.0 および 2.02 ISA PnP ISDN カードに対応しました。
          &merged;</para>

	<para role="historic">&man.isic.4; ドライバは Compaq Microcom 610 ISDN
	  ISA PnP カードに内応しました。&merged;</para>

	<para role="historic">&man.i4bcapi.4; および &man.iavc.4;
	  ドライバにより
          AVM 製の Active CAPI ベースの ISDN カードに対応しました。
          対応しているカードは
          AVM B1 PCI/AVM B1 ISA Basic Rate カード、
          AVM T1 Primary Rate カードです。
          &merged;</para>

	<para role="historic">&man.isdnd.rc.5; ファイルに新たなキーワード
          <literal>maxconnecttime</literal> が追加されました。
          これは一つの接続がオープン状態にある時間を制限します。
          &merged;</para>

	<para role="historic">&man.isdnphone.8; に、
          キーパッドを使ってメッセージを PBX や電話交換局に送ることができる
          <option>-k</option> オプションが追加されました。
          &merged;</para>

	<para><application>isdn4bsd</application> が
	  Q.931 のサブアドレッシングに対応しました。</para>
      </sect4>

      <sect4 id="kame-kernel">
        <title>KAME</title>

        <para role="historic">IPv6 スタックが KAME プロジェクトの
          2001 年 5 月 28 日づけのスナップショットを
	  ベースとしたものになりました。
          この節の項目のほとんどは、それが取り込まれたことによるものです。
          KAME IPv6 スタックのユーザランドにおける更新情報は
          <xref linkend="kame-userland"> に書かれています。
            &merged;</para>

        <para role="historic">&man.gif.4; が RFC 1933 ではなく RFC 2893
	  準拠のものになりました。
          イングレスフィルタの制御は
          <literal>IFF_LINK2</literal>
          インターフェイスフラグで行なうことが可能です。
          &merged;</para>

	<para role="historic"><application>IPsec</application> が多少改良され、
          Rijndael、SHA2 アルゴリズムを利用できるようになりました。
          特許の問題のため IPsec の RC5 対応は削除されています。
          &merged;</para>

	<para role="historic">&man.stf.4; が RFC 3056 に準拠し、
          イングレスフィルタの制御を
          <literal>IFF_LINK2</literal>
          インターフェイスフラグで行なえるようになりました。
          &merged;</para>

	<para role="historic">IPv6 が物理ネットワーク上の不正なアドレス
          (ループバックアドレスなど) を厳密にチェックするようになりました。
          &merged;</para>

	<para role="historic"><varname>IPV6_V6ONLY</varname>
          ソケットオプションに完全対応しました。
          このオプションに関するカーネルの標準動作は
          sysctl 変数 <varname>net.inet6.ip6.v6only</varname>
          によって制御されます。
          &merged;</para>

	<para role="historic">RFC 3041
	  (Privacy Extensions for Stateless Address
          Autoconfiguration) に対応しました。
          これは sysctl 変数
          <varname>net.inet6.ip6.use_tempaddr</varname>
          で有効化することができます。
          &merged;</para>
      </sect4>
    </sect3>
  </sect2>

  <sect2 id="security">
    <title>セキュリティ関連の修正</title>

    <para role="historic">&man.sysinstall.8;
      においてインストール時に二種類の
      <quote>セキュリティプロファイル</quote>
      が選べるようになりました。
      これらのプロファイルは &man.rc.conf.5; に書かれている
      さまざまなシステムサービスを
      新規インストール時に有効化・無効化することで、
      異なるレベルのシステムセキュリティを実現します。
      &merged;</para>

    <para role="historic">不正な ELF
      実行イメージを用いてシステムを停止させることができるバグが修正されました
      (セキュリティ勧告 FreeBSD-SA-00:41 参照)。
      &merged;</para>

    <para role="historic">Linux 互換機能にあったセキュリティホールが修正されました
      (セキュリティ勧告 FreeBSD-SA-00:42 参照)。
      &merged;</para>

    <para role="historic">バッファオーバフローによる
      不正利用の可能性を低減するため、
      多くのプログラムにある文字列操作ライブラリの呼び出し部分が
      修正されました。
      &merged;</para>

    <para role="historic">TCP の初期シーケンス番号に、
      さらに強度に優れた乱数が使われるようになりました
      (セキュリティ勧告 FreeBSD-SA-00:52 参照)。
      &merged;</para>

    <para role="historic">&man.tcpdump.1; にあったいくつかのバッファオーバフロー問題が
      修正されました
      (セキュリティ勧告 FreeBSD-SA-00:61 参照)。
      &merged;</para>

    <para role="historic">&man.top.1; にあったセキュリティホールが修正されました
      (セキュリティ勧告 FreeBSD-SA-00:62 参照)。
      &merged;</para>

    <para role="historic">&man.gethostbyname.3; の「一つ違い」エラーによる
      潜在的なセキュリティホールが修正されました
      (セキュリティ勧告 FreeBSD-SA-00:63 参照)。
      &merged;</para>

    <para role="historic">&man.ncurses.3;
      ライブラリにあった潜在的なバッファオーバフロー問題が修正されました。
      これは &man.systat.1; から任意のコードの実行を可能にします。
      (セキュリティ勧告 FreeBSD-SA-00:68 参照)。
      &merged;</para>

    <para role="historic">サーバの資源を大量に消費させることが可能な
      &man.telnetd.8; にあるセキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-00:69 参照)。
      &merged;</para>

    <para role="historic">&man.ppp.8;
      の <literal>nat deny_incoming</literal> コマンドが
      正しく動作するようになりました
      (セキュリティ勧告 FreeBSD-SA-00:70 参照)。
      &merged;</para>

    <para role="historic">&man.csh.1;/&man.tcsh.1; の一時ファイルを利用して
      ユーザが書き込み可能な任意のファイルを上書きさせることができる
      セキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-00:76 参照)。
      &merged;</para>

    <para role="historic">標準設定では &man.ssh.1; バイナリが
      root で SUID されなくなりました。
      &merged;</para>

    <para role="historic">Kerberos IV 実装に対して、環境変数問題、
      潜在的なバッファオーバフロー問題、
      チケットファイルの上書き問題に関連する修正が行なわれました。
      &merged;</para>

    <para role="historic">&man.telnet.1;
      が環境変数に対して適切なフィルタ処理を行なうようになりました。
      &merged;</para>

    <para role="historic">&man.procfs.5; にあったいくつかのセキュリティ上の弱点が
      修正されました (セキュリティ勧告 FreeBSD-SA-00:77 参照)。
      &merged;</para>

    <para role="historic">サーバが &man.ssh-agent.1; および <literal>X11Forwarding</literal>
      を正しく無効化できないという
      <application>OpenSSH</application> のバグが修正されました
      (セキュリティ勧告 FreeBSD-SA-01:01 参照)。
      &merged;</para>

   <para role="historic">&man.ipfw.8; および &man.ip6fw.8; が
      到着した TCP セグメントを誤って <literal>established
        (確立済み)</literal>の接続の一部として扱ってしまう危険性のある
      バグが修正されました
      (セキュリティ勧告 FreeBSD-SA-01:08 参照)。
      &merged;</para>

    <para role="historic">それが &man.crontab.5; 文法に則ったファイルであれば、
      すべてのユーザがシステム上の任意のファイルを
      読み込むことができる危険性がある
      &man.crontab.1; のバグが修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:09 参照)。
      &merged;</para>

    <para role="historic"><groupname>wheel</groupname> グループがアクセス可能なファイルの
      先頭 16 バイトが読み出せてしまう危険性を持った
      &man.inetd.8; のセキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-01:11 参照)。
      &merged;</para>

    <para role="historic">安全でない一時ファイルを使用してしまうという
      &man.periodic.8; のバグが修正されました
      (セキュリティ勧告 FreeBSD-SA-01:12 参照)。
      &merged;</para>

    <para role="historic"><application>OpenSSH</application> において、
      RSA 認証の失敗を検出した時にサーバ暗号鍵を再生成することで
      (ホスト暗号鍵ではなく) サーバ暗号鍵を推定することが可能になる攻撃を
      (単に接続制限をかけるのではなく) 防止するためのコードが加えられました。
      (セキュリティ勧告 FreeBSD-SA-01:24 参照)。
      &merged;</para>

    <para role="historic">セキュリティ上の危険性を低減するため、
      出力書式指定文字列を使用しているたくさんのプログラムが修正されました。
      &merged;</para>

    <para role="historic">一時ファイルを使用するたくさんのプログラムが
      セキュリティを考慮した形に修正されました。
      &merged;</para>

    <para role="historic">攻撃者から TCP、UDP の <quote>セション</quote>
      を切断できる可能性のある ICMP のバグが修正されました。
      &merged;</para>

    <para role="historic">特定の不正なパケットを送ることで &man.timed.8;
      をクラッシュさせることができるような
      &man.timed.8; のバグが修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:28 参照)。
      &merged;</para>

    <para role="historic">特定の不正なパケットを送ることで &man.rwhod.8;
      をクラッシュさせることができるような
      &man.rwhod.8; のバグが修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:29 参照)。
      &merged;</para>

    <para role="historic">ユーザがアクセス権限を持たないデータへの
      不正アクセスを可能にする競合状態が発生するという
      &os; FFS および EXT2FS 実装に存在していた
      セキュリティホールが修正されました
      (セキュリティ勧告 FreeBSD-SA-01:30 参照)。
      &merged;</para>

    <para role="historic">&man.ntpd.8; に存在した、
      リモートから悪用可能なセキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-01:31 参照)。
      &merged;</para>

    <para role="historic"><application>IPFilter</application>
      のフラグメントキャッシュに存在していたセキュリティホールが修正されました
      (セキュリティ勧告 FreeBSD-SA-01:32 参照)。
      &merged;</para>

    <para role="historic">FTP サーバ上で任意のコードを実行可能にするような
      &man.glob.3; のバッファオーバフロー問題が修正されました。
      さらにある種のサービス妨害攻撃を防止するため、
      &man.glob.3; に対して、
      戻り値として返される一致パス名の数の上限を指定できるようになりました。
      &man.ftpd.8; はこの機能を使うようになっています。
      (セキュリティ勧告 FreeBSD-SA-01:33 参照)。
      &merged;</para>

    <para role="historic">TCP の初期シーケンス番号がより徹底的に乱数化されるようになりました
      (セキュリティ勧告 FreeBSD-SA-01:39 参照)。
      互換性に問題がある可能性が考えられるため、このセキュリティ上の修正は
      sysctl 変数
      <varname>net.inet.tcp.tcp_seq_genscheme</varname>
      で有効化・無効化の制御が可能です。
      &merged;</para>

    <para role="historic">(再帰的にファイルシステムを探索するアプリケーションで使われる)
      &man.fts.3; ルーチンに存在していた、
      指定したディレクトリ階層の外にあるファイルを操作することが可能である、
      というセキュリティ上の弱点が修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:40 参照)。
      &merged;</para>

    <para role="historic"><application>OpenSSH</application>
      は競合状態を解消するため、認証の転送ファイルを
      unlink する前にそのユーザの UID に切り替えるように変更されました。</para>

    <para role="historic">親プロセスから exec された子プロセスにおいて、
      実際にはいくつかのシグナルハンドラがそのままになってしまう
      欠陥が修正されました
      (セキュリティ勧告 FreeBSD-SA-01:42 参照)。
      攻撃者はこれを利用して setuid
      されたバイナリの権限で任意のコードを実行できます。
      &merged;</para>

    <para role="historic">&man.tcpdump.1; に含まれていた、
      リモートから悪用可能なバッファオーバフロー問題が修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:48 参照)。&merged;</para>

    <para role="historic">&man.telnetd.8; に含まれていた、
      リモートから悪用可能なバッファオーバフロー問題が修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:49 参照)。&merged;</para>

    <para role="historic">sysctl 変数 <varname>net.inet.ip.maxfragpackets</varname>
      および <varname>net.inet.ip6.maxfragpackets</varname>
      が新たに加えられました。
      これらは IPv4、IPv6 パケットの
      フラグメントが消費するメモリ量の上限を設定し、
      ある種のサービス妨害攻撃を防ぐためのものです
      (セキュリティ勧告 FreeBSD-SA-01:52 参照)
      &merged;</para>

    <para role="historic"><filename>inetd.conf</filename>
      におけるすべてのサービスが
      標準の新規インストールで無効化されるようになりました。
      また &man.sysinstall.8; では、
      <filename>inetd.conf</filename> の編集機能に加えて
      &man.inetd.8; そのものの有効化/無効化の選択が追加されています。
      &merged;</para>

    <para role="historic">二点間 (point-to-point) リンクにおける
      &man.ipfw.8; <literal>me</literal>
      ルール実装の欠陥が修正されました。
      以前の <literal>me</literal>
      フィルタルールは二点間インターフェイスのローカル側 IP
      アドレスだけでなく、
      リモート側 IP アドレスにもマッチしてしまいます (セキュリティ勧告
      FreeBSD-SA-01:53 参照)。
      &merged;</para>

    <para role="historic">&man.procfs.5; にあったセキュリティ上の弱点が修正されました。
      これはプロセスから他のプロセスのメモリ空間にある
      機密情報を読むことができるよいうものです
      (セキュリティ勧告 FreeBSD-SA-01:55 参照)。
      &merged;</para>

    <para role="historic"><application>tcp_wrappers</application> にある
      <literal>PARANOID</literal>
      ホスト名チェック機能がきちんと動作するようになりました
      (セキュリティ勧告 FreeBSD-SA-01:56 参照)。
      &merged;</para>

    <para role="historic">ローカルから悪用可能な &man.sendmail.8;
      のセキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-01:57 参照)。
      &merged;</para>

    <para role="historic">リモートから root 権限を不正に奪うことが可能な
      &man.lpd.8; のセキュリティ上の弱点が修正されました
      (セキュリティ勧告 FreeBSD-SA-01:58 参照)。
      &merged;</para>

    <para role="historic">&man.rmuser.8; に存在していた競合状態が修正されました。
      これは非常に限られた時間ですが
      <filename>/etc/master.passwd</filename>
      が誰でも読み込み可能な状態になるというものです
      (セキュリティ勧告 FreeBSD-SA-01:59 参照)。
      &merged;</para>

    <para role="historic"><application>UUCP</application> の弱点は修正されました
      (セキュリティ勧告 FreeBSD-SA-01:62 参照)。
      標準のシステムパスに存在する、<username>root</username>
      が所有者となっていないあらゆるバイナリに
      <literal>schg</literal> フラグが設定されるようになりました。
      これは &man.cron.8; を経由したり、あるいは
      <username>root</username>
      ユーザやそのバイナリ所有者以外のユーザから実行し、
      そのバイナリを悪用することを防ぐためです。
      また <filename>/etc/periodic/daily/410.status-uucp</filename> から
      実行される &man.uustat.1; は、
      <username>root</username> 権限ではなく
      <username>uucp</username> ユーザ権限で実行されるように変更されて
      います。
      &os; -CURRENT では、<application>UUCP</application> は
      Ports Collection に移され、もはやベースシステムの一部ではなくな
      りました。&merged;</para>

    <para role="historic">&man.semop.2;
      システムコールに存在していたバッファオーバフロー問題による
      セキュリティホールが修正されました。&merged;</para>

    <para role="historic"><literal>UseLogin yes</literal> が指定されているときに、
      ユーザが任意の権限でコードを実行できるという
      <application>OpenSSH</application> のセキュリティホールが
      修正されました。
      デフォルトでは <literal>UseLogin no</literal> という
      設定になっています。
      (セキュリティ勧告 FreeBSD-SA-01:63 参照)。&merged;</para>

    <para role="historic">&man.pkg.add.1; において、バイナリパッケージがインストールされる
      際にローカル上の攻撃者が中身を変更できるような一時ディレクトリの
      使い方が修正されました。
      (セキュリティ勧告 FreeBSD-SA-01:64 参照)。&merged;</para>

    <para role="historic"><filename>/etc/master.passwd</filename> の中身が
      見えてしまう &man.pw.8; の競合条件が修正されました
      (セキュリティ勧告 FreeBSD-SA-02:02 参照)。&merged;</para>

    <para role="historic">&man.k5su.8; のバグにより、一度スーパユーザ権限を
      与えられたことのあるプロセスが、再び獲得することができました。
      このバグは修正されています。
      (セキュリティ勧告 FreeBSD-SA-02:07 参照)。&merged;</para>

    <para role="historic"><application>OpenSSH</application> の多重化に関するコードにおいて
      <quote>一つ違い (off-by-one)</quote> バグが修正されました。
      このバグは認証されたリモートユーザが
      &man.sshd.8;
      に任意のコードをスーパユーザ権限で実行したり、
      悪意のある SSH サーバがクライアントユーザの権限で
      (クライアントユーザの) システム上の任意のコードを実行することが可能です。
      詳細はセキュリティ勧告 FreeBSD-SA-02:13
      をご覧ください。&merged;</para>

    <para role="historic"><application>zlib</application> には、
      メモリを複数回解放するように仕向けることが可能な
      プログラミング上の誤りが存在します。
      &os; が採用している &man.malloc.3;/&man.free.3; ルーチンは
      この誤りによるセキュリティ上の弱点はありませんが、
      アプリケーションが特殊な細工が施された不正な圧縮データブロックを
      受け取った場合、この仕組みを悪用して
      機能を正常に働かなくさせたり異常終了させることが可能です。
      なお、この <application>zlib</application> のバグは修正済みです。
      この問題の回避方法および解決方法はセキュリティ勧告
      FreeBSD-SA-02:18
      をご覧ください。&merged;</para>

    <para role="historic">TCP SYN cache (<quote>syncache</quote>) と
      SYN cookie (<quote>syncookie</quote>) の実装にあった、
      正規の TCP/IP トラフィックによりマシンを
      クラッシュさせる可能性のあるバグが修正されました。
      この問題の回避方法や修正パッチはセキュリティ勧告
      FreeBSD-SA-02:20
      をご覧ください。&merged;</para>

    <para role="historic">リモートの攻撃者から攻撃対象のマシン上のメモリを
      枯渇させることのできる、経路表のメモリリークが修正されました。
      回避方法やパッチはセキュリティ勧告
      FreeBSD-SA-02:21
      をご覧ください。&merged;</para>

    <para role="historic">システムクラッシュを起こす可能性のある
      memory-mapped I/O のバグが修正されました。
      詳細と解決方法はセキュリティ勧告
      FreeBSD-SA-02:22
      をご覧ください。&merged;</para>

    <para role="historic">標準入出力ファイル記述子を操作することによって、
      SUID されたプログラムを悪用して不正にファイルを
      読み書きすることが可能なセキュリティホールが修正されました。
      この問題に関する解決策はセキュリティ勧告
      FreeBSD-SA-02:23
      をご覧ください。&merged;</para>

    <para role="historic">&man.k5su.8; は (&man.su.1; のように)
      権限を行使するユーザが <groupname>wheel</groupname> グループに
      所属していることを必要としないため、予想に反した挙動を示す可能性があります。
      このような状況を回避するために、
      &man.k5su.8; はデフォルトで (事実上、上記の機能を無効化するために)
      SUID せずにインストールされるようになりました。
      詳細はセキュリティ勧告
      FreeBSD-SA-02:24
      をご覧ください。&merged;</para>

    <para role="historic">&man.bzip2.1; ユーティリティに、
      事前に警告することなく既存のファイルを上書きしたり、
      許可属性の競合状態により意図しないユーザにファイルのアクセスを許す
      といった複数の弱点が発見されました。
      この問題は新しい <application>bzip2</application>
      の統合で修正されました。
      詳細はセキュリティ勧告
      FreeBSD-SA-02:25
      をご覧ください。&merged;</para>

    <para role="historic">TCP SYN cache (<quote>syncache</quote>) の実装において
      accept filter (&man.accept.filter.9; 参照) が使用されていた時に
      リモートの攻撃者がサービス妨害を実現できる可能性のあるバグが修正されました。
      詳細はセキュリティ勧告
      FreeBSD-SA-02:26
      をご覧ください。&merged;</para>

    <para role="historic">&man.rc.8; においてシェルのグロブ演算子が不適切な使われ方をしていたため、
      <filename>/tmp/.X11-unix</filename> が存在せず、システムを再起動可能な場合、
      ユーザが任意のファイルの中身を消すことができるようになっていました。
      このバグは修正されました。
      詳細はセキュリティ勧告
      FreeBSD-SA-02:27
      をご覧ください。&merged;</para>

    <para role="historic">悪意を持ったドメインネームサーバや
      DNS メッセージを生成できる攻撃者が悪用可能な、
      リゾルバのバッファオーバフロー問題が修正されました。
      詳細はセキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:28.resolv.asc">FreeBSD-SA-02:28</ulink>
      をご覧ください。&merged;</para>

    <para>不正な NFS パケットによって悪用される可能性がある、
      &man.tcpdump.1; のバッファオーバフロー問題が修正されました。
      詳細はセキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:29.tcpdump.asc">FreeBSD-SA-02:29</ulink>
      をご覧ください。&merged;</para>

    <para>高い権限を放棄したプロセスに対して、&man.ktrace.1; を使った追跡
      (trace) 操作ができないようになりました。
      これにより、そのプロセスが権限を放棄する前に得たセキュリティ上重要な
      情報の漏洩を防ぐことができます。この問題の詳細は、
      セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:30.ktrace.asc">FreeBSD-SA-02:30</ulink>
      をご覧ください。&merged;</para>

    <para>任意のファイルの許可属性を変更するのに使用可能な、
      &man.pppd.8; にあった競合状態が修正されました。
      詳細はセキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:32.pppd.asc">FreeBSD-SA-02:32</ulink> をご覧ください。&merged;</para>

    <para>ベースシステムの <application>OpenSSL</application>
      が新しいバージョンにアップグレードされ、
      <application>OpenSSL</application>
      に存在していた複数のバッファオーバフロー問題が修正されました。
      この問題の詳細は、
      セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:33.openssl.asc">FreeBSD-SA-02:33</ulink> をご覧ください。&merged;</para>

    <para>XDR デコーダにあったヒープバッファオーバフローが修正されました。
      この問題の詳細は、
      セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:34.rpc.asc">FreeBSD-SA-02:34</ulink> をご覧ください。&merged;</para>

    <para>ローカルユーザが FFS
      ファイルシステム上の任意のブロックを読み書きできるというバグが修正されました。
      この問題の詳細は、セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:35.ffs.asc">FreeBSD-SA-02:35</ulink> をご覧ください。&merged;</para>

    <para>NFS サーバのコードに含まれていた、
      リモートからのサービス妨害攻撃を可能にするバグが修正されました。
      この問題の詳細は、セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:36.nfs.asc">FreeBSD-SA-02:36</ulink> をご覧ください。&merged;</para>

    <para>&man.kqueue.2; 機構を使うことで、
      ローカルユーザがシステムパニックを引き起こすことができる可能性のあるバグが修正されました。
      この問題の詳細は、セキュリティ勧告
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:37.kqueue.asc">FreeBSD-SA-02:37</ulink> をご覧ください。&merged;</para>

    <para>カーネルメモリの大きな部分を返してしまうという、
      いくつかのシステムコールにあった境界チェックのバグが修正されました。
      この問題の詳細は、
      <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:38.signed-error.asc">FreeBSD-SA-02:38</ulink> をご覧ください。&merged;</para>

    <para><filename>libkvm</filename> を使っているアプリケーションから
      セキュリティ上重要な記述子が漏洩する可能性があるバグが修正されました
      この問題の詳細は <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:39.libkvm.asc">FreeBSD-SA-02:39</ulink>
      をご覧ください。&merged;</para>

    <para>kadmind(8) および k5admin にあったバッファオーバフロー問題が修正されました。
      詳細はセキュリティ勧告 <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:40.kadmind.asc">FreeBSD-SA-02:40</ulink> をご覧ください。
      &merged;</para>

    <para>&man.smrsh.8; にあった、
      実行可能なプログラムの制限をユーザから無効にすることができるという
      プログラム上の誤りが修正されました。
      詳細はセキュリティ勧告 <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:41.smrsh.asc">FreeBSD-SA-02:41</ulink> をご覧ください。
      &merged;</para>

    <para>DNS リゾルバ (&man.resolver.3;) にあった、
      アプリケーションを動作不能にする可能性のあるバッファオーバフロー問題が修正されました。
      詳細はセキュリティ勧告 <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:42.resolv.asc">FreeBSD-SA-02:42</ulink> をご覧ください。
      &merged;</para>

    <para><application>BIND</application>
      における複数のセキュリティ上の弱点が修正されました。
      詳細はセキュリティ勧告 <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:43.bind.asc">FreeBSD-SA-02:43</ulink> をご覧ください。
      &merged;</para>

    <para>&man.fpathconf.2; システムコールにあった、
      ローカルユーザからシステムをクラッシュさせたり、
      高い権限を不正に取得するために利用可能な、
      ファイル記述子の漏洩問題が修正されました。
      詳細はセキュリティ勧告 <ulink
      url="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-02:44.filedesc.asc">FreeBSD-SA-02:44</ulink> をご覧ください。
       &merged;</para>

  </sect2>

  <sect2 id="userland">
    <title>ユーザランドの変更点</title>

    <para>コンパイラツールチェーンから、
      &man.a.out.5; 形式の実行ファイルを作成する機能が削除されました。</para>

    <para>&man.adduser.8; および &man.rmuser.8; が、
      Perl スクリプトから &man.sh.1; スクリプトに変更されました。</para>

    <para role="historic">&man.ancontrol.8; もしくは &man.wicontrol.8;
      の最初の引数が <literal>-</literal> で始まっていない場合は
      インターフェイス名と判断するようになりました。&merged;</para>

    <para role="historic">&man.apmd.8; に新しい設定指示子
      <literal>apm_battery</literal> が追加され、
      バッテリレベルのモニタリング機能および、
      バッテリ残量のパーセント量や残り時間を基準とした
      コマンドの実行が可能になりました。
      指定方法は
      <filename>/etc/apmd.conf</filename>
      にあるコメントアウトされた例をご覧ください。
      &merged;</para>

    <para role="historic">&man.arp.8; は各 ARP エントリに対して適切な
      インターフェイス名を表示するようになりました。&merged;</para>

    <para>&man.arp.8; は FDDI や ATM インターフェイスに対して
      <literal>[fddi]</literal> や <literal>[atm]</literal>
      タグを表示するようになりました。</para>

    <para>FORTRAN キャリッジ制御文字を解釈する
      &man.asa.1; ユーティリティが追加されました。</para>

    <para>&man.at.1; に新しく、リモートジョブを削除する
      <option>-r</option> と、時間を POSIX
      時間フォーマットで指定するための
      <option>-t</option> オプションに対応しました。</para>

    <para>&man.at.1; に
      ジョブを削除する <option>-r</option> オプションと
      POSIX 時刻フォーマットで時間を指定する <option>-t</option> オプションが
      追加されました。</para>

    <para role="historic">&man.ata.4; ドライバの動作を制御するコマンド
      &man.atacontrol.8; が追加されました。&merged;</para>

    <para>システムの &man.awk.1; が
      <application>BWK awk</application> になりました。</para>

    <para>&man.basename.1; に <option>-a</option> フラグと
      <option>-s</option> フラグが追加され、複数のファイルに対して
      &man.basename.3; 関数を実行できるようになりました。</para>

    <para>&man.biff.1; に、新しい引数 <option>b</option> が追加されました。
      これは、新しいメール到着時の <quote>ベル通知</quote> を有効にします
      (<command>biff y</command> のように、端末には表示されません)。
      &merged;</para>

    <para>&man.biff.1; が
      標準入力、標準出力、標準エラー出力の順に
      起動された端末のファイル記述子を利用するようになりました。
      これにより、シェルのリダイレクト機能
      (<command>biff n &lt; /dev/ttyp1</command>)
      を利用し、他の端末へ通知を切替えることができます。</para>

    <para arch="pc98" role="historic">PC-98
      ブートマネージャのインストール・設定用ユーティリティである
      &man.boot98cfg.8; が新たに追加されました。
      &merged;</para>

    <para role="historic">&man.burncd.8;
      に、マルチセションモードに対応するためのオプション
      <option>-m</option> が追加されました
      (デフォルト動作ではシングルセションでディスクをクローズします)。
      また、イメージファイルのリストが格納されたファイルを指定するための
      <option>-l</option> オプションも追加されています
      (ファイル名 <filename>-</filename> を指定することで標準入力
      <literal>stdin</literal> を使用することが可能)
      &merged;</para>

    <para>&man.burncd.8; が新しくディスクアトワンス
      (Disk At Once; DAO) モードに対応しました。
      オプション <option>-d</option>
      でこのモードを選ぶことが可能です。&merged;</para>

    <para>&man.burncd.8; は VCD や SVCD に書き込めるように
      なりました。&merged;</para>

    <para>&man.burncd.8; が、
      <option>-s</option> オプションの値に
      <literal>max</literal> を指定すると、
      そのドライブの最大書き込み速度を設定するようになりました。
      &merged;</para>

    <para>&man.bzgrep.1;、&man.bzegrep.1;、&man.bzfgrep.1; が追加され、
      &man.bzip2.1; で圧縮されたファイルを
      &man.grep.1; することができるようになりました。</para>

    <para role="historic">&man.c89.1;
      がシェルスクリプトからバイナリ実行ファイルに置き換えられ、
      いくつかあった小さなバグが修正されました。
      &merged;</para>

    <para>&man.calendar.1; に新しく、
      週末を特別扱いせず <option>-A</option> と同じ機能を実現する
      <option>-W</option> オプションと、
      <quote>金曜日</quote> (訳注:「週末」の前日を表す曜日)
      を変更する <option>-F</option> オプションが追加されました。</para>

    <para arch="i386,pc98" role="historic">機能限定版の
      &man.camcontrol.8; がインストール
      用フロッピーに入りました。
      これにより、<quote>緊急ホログラフィックシェル</quote> の中から
      ブート後に接続されたデバイスを再スキャンしたり、
      SCSI バスに接続されたデバイスを見たりすることができるように
      なりました。&merged;</para>

    <para role="historic">&man.cat.1;
      が新しく UNIX ドメインソケットの読み出しに対応しました。
      &merged;</para>

    <para>&man.catman.1; が Perl スクリプトから
      C プログラムに変更されました。</para>

    <para role="historic">&man.cdcontrol.1; が <literal>cdid</literal>
      コマンドに対応しました。このコマンドは CDDB
      データベースと同じアルゴリズムを使って CD
      シリアル番号を表示します。
      &merged;</para>

    <para role="historic">&man.cdcontrol.1; のデフォルトデバイスが
      <envar>CDROM</envar> という環境変数で設定できるようになりました。
      &merged;</para>

    <para role="historic">&man.cdcontrol.1; が新たに、
      音楽 CD 再生時に指定した数だけ前後のトラックへ移動するためのコマンド、
      <literal>next</literal> および <literal>prev</literal>
      に対応しました。
      &merged;</para>

    <para>&man.cdcontrol.1; が
      CDROM ドライブの最大速度を設定する
      <literal>speed</literal> コマンドに対応しました
      (速度に <literal>max</literal> と指定することで、
      ドライブの最大速度と同じ値に設定することも可能)。
      &merged;</para>

    <para><filename>libc</filename> に、&os; ベースシステムのユーティリティが
      &os; 4 互換モードと <quote>規格準拠</quote> モード (デフォルト) の
      どちらで動作するのかを指定するライブラリ関数
      &man.check.utility.compat.3; が追加されました。
      設定は &man.malloc.3; と同様、
      環境変数かシンボリックリンクで行ないます。</para>

    <para>&man.chflags.1; が
      <filename>/usr/bin</filename> から
      <filename>/bin</filename> に移動しました。</para>

    <para role="historic">&man.chio.1; に、
      物理位置ではなくボリュームタグで要素を指定する機能と、
      要素を以前の位置に戻す機能が追加されました。
      &merged;</para>

    <para>&man.chmod.1; に新しいオプション
      <option>-h</option> が追加されました。
      これはシンボリックリンクの許可属性の変更に対応するものです。</para>

    <para>&man.chmod.1; に
      <option>-v</option> オプションが複数回指定した場合、
      ファイルのモードを変更するときに、
      新旧のモードを表示するようになりました。</para>

    <para role="historic">&man.chown.8; が <option>-R</option> オプションなしで
      実行された場合に、
      コマンドライン引数で指定されたシンボリックリンクを
      正しく辿るようになりました。&merged;</para>

    <para>&man.chown.8; におけるユーザとグループの区切り文字に
      <literal>.</literal> を使うことができなくなりました。
      これは <literal>.</literal> 文字を含むユーザ名に対応するためです。</para>

    <para><filename>&lt;sys/param.h&gt;</filename> を include する場合、
      <literal>CSMG_*</literal> マクロを使う必要がなくなりました。</para>

    <para role="historic">&man.col.1; に新しいオプション
      <option>-p</option> が追加されました。
      これは不明なコントロールシーケンスを処理せずに通過させるためのものです。
      &merged;</para>

    <para role="historic"><filename>compat3x</filename> 配布物が更新され、
      &os; 3.5.1-RELEASE のライブラリが含まれるようになりました。
      &merged;</para>

    <para>&os; 4-STABLE との互換性を提供する
      <filename>compat4x</filename> 配布物が追加されました。
      これには、&os; 4.7-RELEASE
      で配布されているライブラリのサブセットが含まれています。</para>

    <para role="historic">&man.config.8;
      で本来エラーとなるべきだったさまざまな警告が、
      適切な終了コードを持った致命的なエラーに置き換えられました。
      これは <literal>make buildkernel</literal>
      において致命的なエラーが無視されてしまうこと、
      またユーザがエラーに気付かず不正なカーネルを
      構築してしまうことを防ぐためのものです。
      &merged;</para>

    <para role="historic">&man.config.8; に含まれていた数多くの
      バッファオーバフロー問題が修正されました。
      &merged;</para>

    <para>&man.cp.1; に
      (非標準の) <option>-n</option> オプションが追加されました。
      これは、ファイルを上書きする際の確認に対して、 自動的に
      <quote>no</quote> を回答するものです。&merged;</para>

    <para>コンテキストを判断してファイルの分割を行なう
      &man.csplit.1; ユーティリティが新たに追加されました。</para>

    <para role="historic">ソースファイルで C++ 風の <literal>//</literal>
      コメント
      が使われている場合でも、&man.ctags.1; が壊れたタグを
      作成しないようになりました。&merged;</para>

    <para>&man.ctags.1; がデフォルトで
      typedef, struct, union, enum 宣言のタグを生成するようになりました
      (デフォルトで <option>-t</option> オプションが追加されます)。
      新しく追加された <option>-T</option> オプションを利用すると、
      従来どおりの動作になります。</para>

    <para>&man.daemon.3; へのコマンドラインインターフェイスを提供する
      &man.daemon.8; プログラムが新しく追加されました。
      &man.daemon.8; は自身を制御端末から切り離し、
      コマンドラインで指定されたプログラムを実行します。
      これは任意のプログラムをデーモンとして実行させることを可能にします。
      &merged;
    </para>

    <para>&man.devd.8; ユーティリティが追加されました。
      これは、デバイスがデバイスツリー上に現われ利用可能になった際に
      任意のコマンドを実行することのできるユーザランドデーモンです。
      このプログラムは &man.pccardd.8; のいくつかの機能の汎用化したものです。

      <note>
        <para>&man.devd.8; は、現在も作業が続けられている機能の一つです。</para>
      </note>

      </para>

    <para>&man.devinfo.8; というデバイスツリーとリソース使用状況を
      表示する簡単なツールが追加されました。</para>

    <para role="historic">&man.df.1; に新しいオプション <option>-l</option>
      が追加されました。
      これはローカルにマウントされたファイルシステムの情報のみを表示します。
      &merged;</para>

    <para role="historic">&man.disklabel.8; のパーティションサイズとして、
      従来のセクタ数だけでなくキロバイト、メガバイト、
      ギガバイトという表現が新たに使用できるようになりました。
      &merged;</para>

    <para>diskpart(8) は廃止され、削除されました。</para>

    <para role="historic">&man.dmesg.8; へ、
      &man.syslogd.8; の記録および <filename>/dev/console</filename>
      の出力が含まれているメッセージバッファ全体を表示するための
      オプション <option>-a</option> が追加されました。
      &merged;</para>

    <para role="historic">&man.du.1; に新しいオプション <option>-I</option>
      が追加されました。
      これは指定されたシェルグロブにマッチするファイル・サブディレクトリを
      無視するためのものです。
      &merged;</para>

    <para role="historic">&man.dump.8; が、下位階層に対して
      <literal>nodump</literal> フラグの継承を行なうようになりました。
      &merged;</para>

    <para>&man.dump.8; に、使用中の UFS および UFS2 ファイルシステムを
      安全にダンプする <option>-L</option> オプションが追加されました。
      一貫性のあるダンプイメージを取得するため、&man.dump.8;
      はファイルシステムのスナップショットを作成し、
      そのスナップショットに対してダンプを実行します。
      ダンプの作成が完了すると、スナップショットは削除されます。</para>

    <para>&man.dump.8; に、ディスクブロックをキャッシュする
      <option>-C</option> オプションが追加されました。
      これは、パスの間のファイルシステム更新を反映しないという欠点がありますが、
      ダンプ速度を向上させることが可能です。</para>

    <para role="historic">&man.dump.8; の <option>-T</option> オプションが、
      後続するオプションを余計に無効化してしまっていた問題が修正されました。
      &merged;</para>

    <para role="historic">&man.dump.8; に新しいオプション <option>-D</option>
      が追加されました。
      これにより <filename>/etc/dumpdates</filename>
      ファイルパスの変更が可能になります。
      &merged;</para>

    <para role="historic">&man.dump.8;
      は自動的なバックアップを監視する際に便利なように、
      進行状況をプロセスタイトルに表示するようになりました。&merged;</para>

    <para>&man.dump.8; にダンプサイズの予測を出力し終了するだけの
      <option>-S</option> オプションが追加されました。&merged;</para>

    <para role="historic">&man.edquota.8; に新しいオプション
      <option>-f</option>
      が追加されました。これは (オプション <option>-p</option>
      で指定される) quota プロトタイプの設定対象を、
      一つのファイルシステムに限定するために使われます。&merged;</para>

    <para role="historic"><filename>/etc/rc.firewall</filename> と
      <filename>/etc/rc.firewall6</filename> は、
      <varname>firewall_type</varname> 変数にルールファイルが設定されている
      場合や、存在しないファイアウォールタイプを設定した場合に、独自の
      ハードコードされたルールを追加しないようになりました
      (これはサイトのファイアウォールポリシを仮定して動作することを
      やめるためのものです)。
      加えて、<literal>closed</literal> ファイアウォールタイプは
      &man.rc.firewall.8; マニュアルページに記述されているように
      動作するようになりました。&merged;</para>

    <para role="historic">ローカルのカスタマイズや管理を楽にするために、
      <filename>/etc/security</filename> の機能は &man.periodic.8;
      フレームワークの配下の一連のスクリプトに分割されました。
      これらのスクリプトは <filename>/etc/periodic/security/</filename>
      に置かれています。&merged;</para>

    <para>&man.expr.1; が
      POSIX.2-1992 (および POSIX.1-2001) 準拠しました。
      ただし、いくつかのプログラムは &man.expr.1; の古い歴史的な動作に依存しており、
      引数をコマンドラインオプションと誤って解釈しないようにするための
      指定を適切に行ないません
      (大きなものに、GNU プログラムの多くが使っている
      <filename role="package">devel/libtool</filename> の
      port/package があります)。
      &man.check.utility.compat.3;
      で説明されている互換モードを有効にすると、
      &man.expr.1; を従来と同じ動作にすることが可能です。</para>

    <para>&man.fbtab.5; はターゲットデバイスとして、特定のデバイスや
      ディレクトリだけではなく、グロブマッチングパターンも受け付ける
      ようになりました。</para>

    <para arch="i386,pc98">&man.fdisk.8; は、
      コマンドラインに何も指定されていなければデバイスを検索せずに、
      ルートデバイスからデフォルトデバイス名を解決するようになりました。</para>

    <para>フロッピーディスクからデータを読み出すためのプログラム
      &man.fdread.1; が新たに追加されました。
      これは &man.fdwrite.1; と対になるもので、
      異常のあるメディアからデータを取り出す手段を提供し、
      複雑な手順で &man.dd.1;
      を実行しなくて済むようにする目的で設計されています。</para>

    <para role="historic">&man.find.1; に新しいオプション
      <option>-empty</option> が追加されました。
      これはファイルもしくはディレクトリが空の場合に真を返します。
      &merged;</para>

    <para role="historic">&man.find.1;
      に以下の新しいオプションが追加されました。
      <option>-iname</option> および <option>-ipath</option> は
      大文字小文字を区別しないマッチングを行ない、
      <option>-regexp</option> および <option>-iregexp</option>
      正規表現マッチングを行ないます。
      <option>-E</option>
      オプションを使うことで拡張正規表現を用いることも可能になっています。
      &merged;</para>

    <para role="historic">&man.find.1; にファイルのタイムスタンプを
      比較するための新しいオプション
      <option>-anewer</option>、
      <option>-cnewer</option>、<option>-mnewer</option>、
      <option>-okdir</option>、<option>-newer[acm][acmt]</option>
      が追加されました。
      後者のオプションでは、さまざまな時間単位で指定することが可能です。
      &merged;</para>

    <para role="historic">&man.finger.1; が、
      &man.finger.conf.5; ファイル経由で別名へ
      finger させる機能に対応しました。
      &merged;</para>

    <para>&man.finger.1; が <filename>.pubkey</filename>
      ファイルに対応しました。&merged;</para>

    <para>&man.finger.1; に、
      GECOS 情報の表示をユーザのフルネームのみに制限する
      <option>-g</option> フラグが追加されました。&merged;</para>

    <para>&man.finger.1;
      に、リモートの問い合わせに使うアドレスファミリを指定する
      <option>-4</option> フラグと
      <option>-6</option> フラグが追加されました。&merged;</para>

    <para role="historic">&man.fmt.1; が書き直され、
      従来あった数多くのバグが修正されました。&merged;</para>

    <para role="historic">書式指定文字列の一貫性をチェックする関数
      &man.fmtcheck.3; が新たに追加されました。
      &merged;</para>

    <para>&man.fold.1; に、
      指定バイト位置で改行する <option>-b</option> フラグ、
      単語境界で改行する <option>-s</option> フラグが追加されました。
      &merged;</para>

    <para role="historic">&man.fsdb.8; に新しく
      <literal>blocks</literal> コマンドが追加されました。
      これは指定された inode に割り当てられたブロックを表示します。
      &merged;</para>

    <para role="historic">&man.fsdb.8; に
      ある特定の inode に割り当てられたブロックの一覧を表示する
      <literal>blocks</literal> コマンドが追加されました。&merged;</para>

    <para>&man.fsck.8; が、
      フォアグラウンドチェック (<option>-F</option>)
      およびバックグラウンドチェック (<option>-B</option>) に対応しました。
      &man.fsck.8; は従来、ファイルシステムをマウントする前に実行され、
      実行終了時点でチェックがすべて完了していましたが、
      バックグラウンドチェックが利用できる場合、&man.fsck.8; は
      2 回実行されます。
      最初の実行は従来と同様の時点、
      つまりファイルシステムがマウントされる前に、
      バックグラウンドチェックが不可能なすべてのファイルシステムに対して
      <option>-F</option> オプションフラグが指定された形で実行されます。
      そしてもう一度、システムがマルチユーザモードに移行してから
      バックグラウンドチェックが可能なすべてのファイルシステムに対して
      <option>-B</option> オプションフラグが指定された形で実行されます。
      バックグラウンドチェックはフォアグラウンドチェックと
      異なり非同期で実行されるため、
      チェック中に他のシステム動作も並行して処理することが可能です。
      この機能を起動時に有効化するかどうかは、
      &man.rc.conf.5; の
      <varname>background_fsck</varname> オプションで制御できます。</para>

    <para role="historic">&man.fsck.ffs.8; は <literal>SIGINFO</literal>
      シグナル (通常、tty から control-T を押下することで発生します)
      を受け取った直後、
      現在のフェイズ番号と対応する進行状況を示す行を出力するようになりました。
      &merged;</para>

    <para>&man.fsck.ffs.8; が、<option>-B</option>
      オプションでマウントされている FFS ファイルシステムに対する、
      バックグラウンドでのファイルシステムチェックに対応しました
      (これらのファイルシステムで Soft Updates
      機能が有効化されている必要があります)。
      また <option>-F</option> オプションフラグは、
      指定されたファイルシステムをフォアグラウンドで
      チェックする必要があるかどうかを指定します。</para>

    <para role="historic">MS-DOS ファイルシステムの一貫性をチェックするユーティリティ
      &man.fsck.msdosfs.8; が新たに追加されました。
      &merged;</para>

    <para role="historic">&man.ftpd.8; に新しいオプションが追加されました。
      追加されたのは、読み出し専用にする <option>-r</option> オプション、
      <literal>EPSV</literal> を無効にする <option>-E</option> オプションです。
      情報漏洩を低減するための修正および、
      コンパイル時にポート番号の範囲を設定する機能も加えられています。
      &merged;</para>

    <para>&man.ftpd.8; に、新しく
      <option>-m</option> オプションが追加されました。
      これは、ファイルシステム上の許可属性に従い、
      ゲストユーザも既存のファイルを変更できるようにするものです。
      これは特に、ゲストユーザがアップロードする際の途中再送
      (resume) を可能にします。&merged;</para>

    <para>&man.ftpd.8; に、新しく
      <option>-M</option> オプションが追加されました。
      これは、ゲストユーザがディレクトリを作成できないようにします。
      &merged;</para>

    <para>&man.ftpd.8; に新しいオプション <option>-o</option>
      および <option>-O</option> が追加されました。
      <option>-o</option> はすべてのユーザ、
      <option>-O</option> はゲストユーザに対して
      <literal>RETR</literal> コマンドを無効化します。
      これと <option>-A</option> オプション、
      および適切なファイル許可属性を組み合わせることで、
      比較的安全なアップロード用
      anonymous FTP サーバを構築することが可能です。&merged;</para>

    <para>&man.ftpd.8; に、新しく
      <option>-W</option> オプションが追加されました。
      これは、FTP セションのログを &man.wtmp.5; に記録しないようにします。
      &merged;</para>

    <para>FireWire サブシステムをユーザから操作・制御するための
      &man.fwcontrol.8; ユーティリティが追加されました。
      &merged;</para>

    <para arch="i386,pc98" role="historic">&man.gdb.1;
      がハードウェアウォッチポイントに対応しました
      (カーネルデバッグレジスタおよび &os; 4.0 で導入された対応コードを利用)。
      &merged;</para>

    <para>&man.getconf.1; ユーティリティが追加されました。
      これは POSIX、X/Open パスの値、
      あるいはシステム設定変数の値を出力します。
      &merged;</para>

    <para role="historic">新しいライブラリ関数 &man.getprogname.3;、
      &man.setprogname.3; が追加されました。
      これらは現在実行されているプログラムのプログラム名を
      操作するためのもので、
      エラー報告ルーチンで出力に一貫性を持たせるために使用されます。
      &merged;</para>

    <para>gifconfig(8) が削除され、
      その機能は &man.ifconfig.8; の
      <option>tunnel</option> と <option>deletetunnel</option>
      コマンドに統合されました。</para>

    <para>&man.gprof.1; に現在動作しているカーネルから動的にシンボル
      参照を解決するための <option>-K</option> オプションが追加
      されました。
      この変更により、KLD モジュールが適切にコンパイルされていれば、
      プロファイルすることができるようになりました。</para>

    <para arch="ia64">EFI GPT パーティションを操作する
      gpt ツールが追加されました。</para>

    <para role="historic">成長型 FFS ファイルシステム &man.growfs.8;
      が新たに追加されました。
      また、既存のファイルシステムのメタ情報をダンプする
      &man.ffsinfo.8; ユーティリティも追加されています。
      &merged;</para>

    <para role="historic">&man.groups.1; および &man.whoami.1;
      シェルスクリプトは
      &man.id.1; へ完全に統合され、両方とも廃止されました。&merged;</para>

    <para>単にエミュレーションカーネルモジュールをロードするだけの機能を持つ
      ibcs2(8)、 linux(8)、osf1(8);、svr4(8)
      スクリプトが削除されました。現在のカーネルモジュールシステムは、
      それらを必要に応じて自動的に、依存関係を満たすようロードします。</para>

    <para role="historic">&man.indent.1;
      に新しい書式オプションがいくつか追加されました。
      &merged;</para>

    <para role="historic">&man.ifconfig.8;
      コマンドに <option>link</option> パラメータが追加され、
      インターフェイスのリンク層アドレスを設定できるようになりました。
      &merged;</para>

    <para role="historic">&man.ifconfig.8; コマンドが
      CIDR の / 記号を用いた記法に対応しました。
      &merged;</para>

    <para role="historic">&man.ifconfig.8; コマンドが
      IEEE 802.11 無線ネットワークデバイスのパラメータ設定に対応しました。
      対応しているのは &man.wi.4; および &man.an.4; デバイスで、
      &man.awi.4; デバイスは一部のみ対応しています。
      &merged;</para>

    <para role="historic">&man.ifconfig.8;
      コマンドはデフォルトで対応メディアのリストを
      表示しないように変更されました。
      リストの表示は <option>-m</option> オプションを指定時に行なわれます。
      &merged;</para>

    <para>&man.ifconfig.8; に、インターフェイスを
      プロミスキャス (promiscuous) モードにする機能が追加されました。
      これは、新しく追加された <option>promisc</option> フラグを使います。
      &merged;</para>

    <para>&man.ifconfig.8; に、パケットの送出を遮断する
      <literal>monitor</literal> フラグが追加されました。
      この機能は、他ネットワークへ影響をおよぼさずに、
      そのネットワークのトラフィックを監視するのに役立ちます。</para>

    <para role="historic">&man.faithd.8;
      に対応するための &man.inetd.8; 文法が、
      他の BSD と互換性のあるものに変更されました。
      &merged;</para>

    <para role="historic">&man.inetd.8; の <literal>ident</literal>
      プロトコル対応が整頓・更新されました。
      &merged;</para>

    <para role="historic">&man.inetd.8;
      が UNIX ドメインソケットに対応しました。
      &merged;</para>

    <para>デフォルトでは、
      &man.inetd.8; は起動時に &man.rc.8; から起動しなくなりました。
      しかし、&man.sysinstall.8; を使ったバイナリインストールの際には、 
      &man.inetd.8; を有効にするかどうかの選択ができるようになっています。
      また、&man.inetd.8; は <filename>/etc/rc.conf</filename>
      に次の行を加えることでも有効にすることが可能です。</para>

    <programlisting>inetd_enable="YES"</programlisting>

    <para>&man.inetd.8; に、同一の IP アドレスからの同時アクセス数の最大値を
      各サービスに対して設定する機能が追加されました。&merged;</para>

    <para role="historic">&man.install.1; に数多くの新機能が追加されました。
      それには既存の対象ファイルのバックアップを作成する
      <option>-b</option> および <option>-B</option> オプション、
      <quote>安全な</quote> (アトミックなコピー) 操作を行なう
      <option>-S</option> オプションの追加が含まれています。
      標準で <option>-c</option> (コピー) オプションが有効化されるようになり、
      <option>-D</option> (デバッグ) オプションは廃止されました。
      また、&man.install.1; は <option>-d</option> (ディレクトリ作成)
      オプションと <option>-C</option> (変更されたファイルのみコピー)
      オプションが同時に指定された場合に警告を表示するようになっています。
      &merged;</para>

    <para role="historic">IP Filter が
      &man.rc.conf.5; による起動時の設定と初期化に対応しました。
      &merged;</para>

    <para role="historic">&man.ipfstat.8; に &man.top.1; 風の表示を行なう
      <option>-t</option> オプションが追加されました。
      &merged;</para>

    <para role="historic"><option>-d</option>
      オプションを指定されなかった場合は
      &man.ipfw.8;
      が動的ファイアウォールルールを表示しないように変更されました。
      <option>-e</option>
      オプションでは有効期限の切れた動的ルールが表示されます。</para>

    <para role="historic">&man.ipfw.8;
      に新機能 (<literal>me</literal>) が追加されました。
      これにより IP
      アドレスが動的に変化するインターフェイス上の
      パケットに一致させることができます。
      &merged;</para>

    <para role="historic">&man.ipfw.8; に特定のアドレス対におけるセション数を
      制限することができる <literal>limit</literal> タイプの
      ファイアウォールルールが追加されました。&merged;</para>

    <para>&man.ipfw.8; フィルタルールは、IPv4 precedence フィールド
      の値にマッチできるようになりました。</para>

    <para role="historic">&man.ip6fw.8;
      にファイル読み込み時のプリプロセッサ機能と
      <option>-q</option> (quiet) フラグが新たに追加されました。
      &merged;</para>

    <para role="historic">&man.ispppcontrol.8; が削除され、
      その機能が &man.spppcontrol.8; に統合されました。&merged;</para>

    <para role="historic">&man.k5su.8; のバイナリがデフォルトで
      <username>root</username> に
      SUID されずにインストールされるようになりました。
      この機能が必要なユーザは、
      手動で &man.k5su.8; の実行ファイルの許可属性を変更するか、
      ソースからのアップグレードの前に
      <literal>ENABLE_SUID_K5SU=yes</literal>
      を
      <filename>/etc/make.conf</filename> に加えてください。
      &merged;</para>

    <para>&man.kbdmap.1; と &man.vidfont.1; が
      Perl スクリプトから C プログラムに変更されました。</para>

    <para role="historic">カーネル環境変数をダンプする &man.kenv.1;
      コマンドが新たに追加されました。
      &merged;</para>

    <para>&man.kenv.1; がカーネル環境変数の設定・削除に対応しました。</para>

    <para role="historic">Perl スクリプトだった &man.keyinfo.1; が
      C プログラムに変更されました。&merged;</para>

    <para>kget(8) ユーティリティが削除されました
      (これは UserConfig 専用のユーティリティであり、
      &os; &release.current; には UserConfig がありません)。</para>

    <para role="historic">&man.killall.1; が Perl スクリプトから 
      C プログラムに変更されました。
      そのため、<option>-m</option> オプションは
      Perl の正規表現文法ではなく、
      &man.regex.3; の正規表現文法に従います。
      &merged;</para>

    <para>&man.killall.1; が、<option>-z</option>
      フラグが指定されない場合にゾンビプロセスを
      kill しようとしなくなりました。</para>

    <para role="historic">新しいユーティリティ &man.kldconfig.8;
      が追加されました。
      これにより、
      カーネルモジュールの検索パスの操作を簡単に行なうことができます。
      &merged;</para>

    <para>ユーザランドから ktr トレースバッファをダンプする
      &man.ktrdump.8; ユーティリティが追加されました。</para>

    <para role="historic">&man.last.1; に <option>-d</option>
      オプションフラグが追加されました。
      これは、ある特定の日時・時刻にログインしていたユーザの
      <quote>スナップショット</quote> を表示します。</para>

    <para role="historic">&man.last.1;
      に、セッションの開始時間に年を含めるようにする
      <option>-y</option> フラグが追加されました。&merged;</para>

    <para role="historic">各ユーザのログイン時間を表示する
      &man.lastlogin.8; ユーティリティが NetBSD から移植されました。
      &merged;</para>

    <para role="historic">セキュリティを向上させるため、
      &man.ldconfig.8;
      がディレクトリの所有者および許可属性をチェックするようになりました。
      このチェックは <option>-i</option>
      オプションを用いることで抑制できます。
      &merged;</para>

    <para role="historic">&man.ldd.1;
      が実行ファイルだけでなく共有ライブラリにも
      使えるようになりました。&merged;</para>

    <para>&man.ldd.1; に、各ロードされたオブジェクトが必要とする
      すべてのオブジェクトのリストを表示する
      <option>-a</option> フラグが追加されました。</para>

    <para><filename>libc</filename> が標準でスレッドセーフになりました。
      <filename>libc_r</filename> にはスレッド関数のみが含まれています。</para>

    <para role="historic">パスワード認証ハッシュライブラリを
      設定可能にするために
      <filename>libcrypt</filename> と
      <filename>libdescrypt</filename> が統合されました。
      des ハッシュアルゴリズムをコンパイルしない指定を明示的にしていない限り、
      md5 と des の両方のハッシュアルゴリズムが利用可能です。
      &merged;</para>

    <para role="historic"><filename>libcrypt</filename> が Blowfish
      パスワードハッシュに対応しました。
      &merged;</para>

    <para arch="i386" role="historic"><filename>libdisk</filename>
      を用いることで、
      <filename>boot0</filename>
      起動ローダのインストール時設定ができるようになりました。
      &merged;</para>

    <para role="historic"><filename>libstand</filename> が
      <application>bzip2</application> で圧縮されたファイルを含む
      ファイルシステムに対応しました。&merged;</para>

    <para><filename>libstand</filename> は UFS ファイルシステム中
      のファイルの中身を上書きすることができるようになりました
      (ファイルシステムが dirty もしくは inconsistent かもしれない
      ので、ファイルを大きくしたり削ったりすることはできません)。
    </para>

    <para role="historic"><filename>libstand</filename> が複数の物理メディアに
      分割された巨大なカーネルやモジュールを読み込むことが
      できるようになりました。&merged;</para>

    <para role="historic"><filename>libfetch</filename> が passive FTP
      で用いる TCP ポート番号範囲の既定値が変更されました。
      これは &man.fetch.1; の動作に影響しますが、
      <option>-U</option>
      オプションを使うことで従来と同じ動作をさせることが可能です。
      &merged;</para>

    <para role="historic"><filename>libfetch</filename>
      がコールバック認証に対応しました。&merged;</para>

    <para role="historic"><filename>libfetch</filename> が
      <envar>HTTP_USER_AGENT</envar> 環境変数に対応しました。
      &merged;</para>

    <para><filename>libgmp</filename> が
      <filename>libmp</filename> で置き換えられました。</para>

    <para><filename>libposix1e</filename> の関数が
      <filename>libc</filename> に統合されました。</para>

    <para role="historic"><filename>libusb</filename> の名前が、NetBSD
       の命名規則に合わせて <filename>libusbhid</filename> に変更されました。
       &merged;</para>

    <para role="historic">&man.ln.1; に、
      既存のファイルを上書きする前にユーザに確認を行なうようにする
      <option>-i</option> オプションが追加されました。
      &merged;</para>

    <para role="historic">&man.ln.1; に、処理対象ファイルがリンクだった場合に
      それをたどらないようにする <option>-h</option>
      オプションフラグが追加されました。
      また、他の実装との互換性を高めるため <option>-n</option>
      オプションフラグも同じ目的で使用可能です。
      &merged;</para>

    <para>&man.lock.1; に、現在使用している端末がロックされている時に
      VTY の切替えを無効にする <option>-v</option> フラグが追加されました。
      これにより、ひとつの端末からコンソール全体を
      ロックすることができるようになります。&merged;</para>

    <para role="historic">&man.logger.1; から直接リモートの syslog
      にメッセージを送信できるようになりました。
      &merged;</para>

    <para role="historic">&man.login.1; が
      <application>PAM</application> モジュールで設定された環境変数の
      export に対応しました。&merged;</para>

    <para>&man.lpc.8; に改良が加えられました。
      <command>lpc clean</command> は多少安全な動作をするように変更され、
      新しく導入された <command>lpc tclean</command> コマンドにより、
      <command>lpc clean</command>
      コマンドで削除されるファイルをチェックすることができます。
      <command>lpc topq</command> が再実装され、
      移動するジョブを
      (ジョブ番号の範囲やホスト名などを使って)
      より柔軟に指定できるようになりました。
      また、印刷キューの最後にジョブを移動する
      <command>lpc bottomq</command> コマンドと、
      プリンタの状態メッセージを設定できる
      <command>lpc setstatus</command> コマンドが追加されました。&merged;</para>

    <para role="historic">&man.lpd.8; に新しいオプションが 2 つ追加されました。
      <option>-c</option> オプションフラグは
      すべての接続エラーのログを &man.syslogd.8; に送り、
      <option>-W</option>
      オプションフラグは予約済みポート以外からの接続を許可します。
      &merged;</para>

    <para role="historic">&man.lpd.8; の制御ファイルにおいて、一部ですが
      <literal>o</literal> というタイプの印刷ファイルに対応しました。
      これは <application>MacOS</application> 10.1 で生成された
      PostScript 形式ファイルの印刷を可能にするためのものです。
      &merged;</para>

    <para role="historic">&man.lpd.8; が
      <option>-p</option> と同じ意味を持ち、よりわかりやすい
      <option>-s</option> フラグを認識するようになりました
      (これらの フラグは &man.lpd.8; がネットワーク経由の
      プリントジョブ用ソケットを開かないようにします)。&merged;</para>

    <para role="historic">&man.lpd.8; now implements a new <literal>rc</literal>
    <para role="historic">&man.lpd.8; に新しく
      <literal>rc</literal> printcap オプションが実装されました。
      この bool オプションがリモートホストのプリントキューに指定されると、
      <command>lpr -#<replaceable>n</replaceable></command>
      というユーザの要求に対して、&man.lpd.8; はデータファイルを
      指定回数分繰り返して転送します。&merged;</para>

    <para role="historic">&man.lpr.1;, &man.lpd.8;, &man.syslogd.8;,
      &man.logger.1;
      といったベースシステムに含まれるその他のネットワークユーティリティが
      IPv6 に対応しました。
      &merged;</para>

    <para role="historic">リモートプリンタのキューに対して
      <command>lprm -</command> が動作するようになりました。
      &merged;</para>

    <para role="historic">&man.ls.1; は (対応端末上で)
      <option>-G</option> オプションを使うことで、
      リストのカラー表示ができるようになりました。
      <envar>CLICOLOR</envar> 環境変数を設定することで、
      デフォルトでカラー表示を行なうことが可能です。
      &merged;</para>

    <para role="historic">&man.ls.1; に
      <option>-h</option> フラグが追加されました。
      <option>-l</option> フラグと組み合わせると、 
      ファイルに単位 (訳注: B, KB, MB など) をつけて
      3 以下の桁数でファイルサイズを出力させることができます。&merged;</para>

    <para>The &man.ls.1; にリストを一行で表示する <option>-m</option> フラグ、
      ディレクトリ名の後ろに <literal>/</literal> を付加する
      <option>-p</option> フラグ、
      ファイル名を行方向にソートして表示する
      <option>-x</option> フラグが追加されました。
      &merged;</para>

    <para role="historic">&man.m4.1; が &man.cpp.1; で利用されている
      <literal>#line</literal> 指示子を受け付けるようになりました。
      &merged;</para>

    <para role="historic">&man.mail.1; に新しいオプション
      <option>-E</option> が追加されました。
      これは本文が空のメッセージを送信しないようにするためのものです。
      &merged;</para>

    <para role="historic">&man.make.1; において、
      <literal>:C///</literal> (正規表現置換)、
      <literal>:L</literal> (小文字変換)、
      <literal>:U</literal> (大文字変換)
      という変数修飾子が新たに追加されました。
      これらは OpenBSD/NetBSD にある &man.make.1; プログラムと、
      &os; の差異を低減させるためのものです。
      &merged; </para>

<!--
    <para>ユーザランド &man.ppp.8; に対して、
      数多くの更新とバグ修正が加えられました。
      &merged;</para>

    <para>&man.fsck.8; ラッパが導入されました
      これは &man.fsck.8; を (&man.mount.8; のように)
      異なる種類のファイルシステムに対して動作可能にするためのものです。</para>

    <para>(<filename>/etc/fstab</filename> のような)
      複数のパス番号を扱う場合の &man.fsck.8; の動作が、
      複数の物理ディスクにまたがる
      ファイルシステムを考慮したものに変更されました。</para>

    <para>IP Filter が &man.rc.conf.5;
      による起動時の設定・初期化に対応しました。
      &merged;</para>
-->

    <para>&man.make.1; に新しいオプション <option>-C</option> が追加されました。
      これは、ターゲットを構築する前に、
      カレントディレクトリを指定されたディレクトリに移動します。
      &merged;</para>

    <para role="historic">不正な空のサフィクスの処理にあった
      &man.make.1; のバグおよび、
      カレントディレクトリの許可属性に対する不適切な仮定、
      バッファオーバフローの可能性のある部分が修正されました。
      &merged;</para>

    <para role="historic"><filename>make.conf</filename> 変数に新しく
      <varname>CPUTYPE</varname> が追加されました。
      これは <application>OpenSSL</application>
      のようなコードのコンパイル時に、
      特定プロセッサ用の最適化を行なうようコンパイラを制御するためのものです。
      &merged;</para>

    <para role="historic">&os; <filename>Makefile</filename>
      インフラストラクチャが
      NetBSD に由来する <varname>WARNS</varname> 指示子に対応しました。
      この指示子は <varname>CFLAGS</varname>
      にコンパイラの警告オプションフラグを追加するかどうかを
      比較的コンパイラの種類に依存しない形で制御することを可能にするものです。
      &merged;</para>

    <para>&man.makewhatis.1; が
      Perl スクリプトから C プログラムに変更されました。</para>

    <para><quote>catpage</quote> (繰り返し表示されるためにあらかじめ
      フォーマットされキャッシュされたマニュアルページ) の生成に
      関連する弱点を減らすために、&man.man.1; は
      <username>man</username> に SUID された状態で
      インストールされなくなりました。
      その結果、&man.man.1; は一般ユーザの代わりにシステムの catpage
      を作成することはできなくなりました。
      ユーザが catpage を保持しているディレクトリに対して書き込み権限
      を持っている場合 (例えばユーザ自身の manpage) や、
      実行しているユーザが <username>root</username> の場合には、
      catpage を作成することができます。</para>

    <para arch="ia64">MCA (Machine Check Architecture) レコードをデコードするための
      mca ユーティリティが追加されました。</para>

    <para>新しいコマンド &man.mdmfs.8; が追加されました。
      これは &man.mdconfig.8; コマンド、
      &man.disklabel.8; コマンド、
      &man.newfs.8; コマンド、
      &man.mount.8; コマンドに関連するラッパで、
      廃止された &man.mount.mfs.8; コマンドのオプションが利用できます。</para>

    <para role="historic">&man.mergemaster.8; が
      <filename>/etc/mergemaster.rc</filename>
      ファイルを読み込むようになりました。
      また、必要に応じて (<command>newaliases</command> などの)
      ユーザが実行すべきコマンドをユーザに知らせるようになっています。
      &merged;</para>

    <para role="historic">&man.mergemaster.8;
      が新たに 2 つのフラグに対応しました。
      <option>-p</option> フラグは
      <quote>pre-<literal>buildworld</literal></quote> モードを有効にします。
      これは、<literal>buildworld</literal> および
      <literal>installworld</literal> のシステムアップグレードステップを
      成功させるために不可欠なファイル群を比較するものです。
      <option>-C</option> フラグは、
      &man.mergemaster.8; がうまく動作した後、
      <filename>/etc/rc.conf</filename> で指定されているオプションと
      <filename>/etc/defaults/rc.conf</filename> で
      定義されているデフォルトのオプションを比較します。&merged;</para>

    <para>&man.mesg.1; が SUSv3 に適合しました。
      他のものと同様に、
      標準入力、標準出力、標準エラー出力の順に
      起動された端末のファイル記述子を利用するようになりました。
      これにより、シェルのリダイレクト機能
      (<command>mesg n &lt; /dev/ttyp1</command>)
      を利用し、他の端末への書き込みアクセスを制御することができます。</para>

    <para role="historic">長い間利用されていなかった mk_cmds(1) および、関連する
      <filename>libss</filename> ライブラリが削除されました。&merged;</para>

    <para>&man.mountd.8; と &man.nfsd.8; が
      <filename>/sbin</filename> から
      <filename>/usr/sbin</filename> に移動しました。</para>

    <para role="historic">&man.moused.8; に新しいオプション
      <option>-a</option> が追加されました。
      これはマウスポインタの加速を制御するためのものです。
      &merged;</para>

    <para role="historic">侵入検知システム (IDS; intrusion-detection system)
      への応用を容易にするため、
      &man.mtree.8; において
      プロトタイプの作成・検証時に除外する
      パス名を列挙したファイルが利用できるようになりました。
      &merged;</para>

    <para>&man.mv.1; に、
      (非標準の) <option>-n</option> オプションが追加されました。
      これは、ファイルを上書きする際の確認に対して、
      自動的に <quote>no</quote> を回答するものです。&merged;</para>

    <para role="historic">&man.natd.8; に &man.ipfw.8; のルールにより遮断された
      ために再評価できないパケットを記録する
      <option>-log_ipfw_denied</option> オプションが追加されました。
      &merged;</para>

    <para role="historic">&man.netstat.1; の <quote>使用中 (in use)</quote>
      のパーセント表示量が、ネットワーク mbuf
      の使用量を正確に反映するようになりました。
      &merged;</para>

    <para role="historic">&man.netstat.1; に、
      表示桁が足りない場合のアドレス表示の切り詰めを抑制する
      <option>-W</option> オプションフラグが追加されました。
      &merged;</para>

    <para role="historic">&man.netstat.1; は、
      各インターフェイスの入出力パケットを
      アドレス単位で追跡するようになりました。
      &merged;</para>

    <para role="historic">&man.netstat.1; に、統計情報をリセットする
      <option>-z</option> オプションフラグが追加されました。
      &merged;</para>

    <para role="historic">&man.netstat.1; に、アドレスを数字で、
      ポート番号をシンボルで表示する新しいオプション
      <option>-S</option> が追加されました。
      &merged;</para>

    <para role="historic">&man.newfs.8; に write combining 機能 (訳注:
      データをひとまとめにして I/O 効率を向上させる機能)
      が実装されました。
      これにより、以前と比べて新しいファイルシステムの作成が最大
      7 倍速くなっています。
      &merged;</para>

    <para role="historic">&man.newfs.8; に、新しいファイルシステムの
      Soft Updates 機能を有効化する <option>-U</option>
      オプションフラグが追加されました。
      &merged;</para>

    <para role="historic">&man.newfs.8;
      の設定の一つである 1 グループに対するシリンダ数 (cylinders/group)
      の既定値が、
      現在のファイルシステムパラメータに設定可能な最大値に設定されるようになりました。
      以前はこの標準値が 16 に固定されていましたが、 
      現在は <option>-c</option> オプションで値を設定することが可能になっています。
      この変更には、&man.fsck.8;
      の性能向上と断片化 (fragmentation) の低減という効果があります。
      &merged;</para>

    <para role="historic"><anchor id="newfs-block-frag-sizes">&man.newfs.8;
      により作成される新しいファイルシステムの
      デフォルトのブロックサイズ、フラグメントサイズは、
      8192 バイトと 1024 バイトから 16384 バイトと 2048 バイトに
      変更されました。
      この変更によりいくらか性能が向上し、もう少しディスクスペースを
      消費するようになっています。&merged;</para>

    <para>最近のハードディスクでは有効に働かない古い機能の多くが、
      &man.newfs.8; から削除されました。
      <option>-O</option>、<option>-d</option>、
      <option>-k</option>、<option>-l</option>、<option>-n</option>、
      <option>-p</option>、<option>-r</option>、<option>-t</option>、
      および <option>-x</option> フラグがそれに該当します。</para>

    <para>&man.newfs.8; に
      UFS1 ファイルシステム、UFS2 ファイルシステムの作成を選択する
      <option>-O</option> フラグが追加されました。</para>

    <para>現在のグループを新しいグループに切り替える
      &man.newgrp.1; ユーティリティが追加されました。</para>

    <para>&man.newsyslog.8; がデフォルトで
      ログファイルの圧縮に &man.bzip2.1; を使うようになりました
      (<filename>/etc/newsyslog.conf</filename> には、
      &man.gzip.1; を利用する従来の動作を指定することも可能です)。</para>

    <para>&man.newsyslog.8; に、エントリの圧縮処理の開始前に、
      前回開始した圧縮処理を強制終了させる
      <literal>W</literal> フラグ (エントリのグループの場合は
      <literal>G</literal> フラグ) が追加されました。
      この機能は、大きいファイルを同時に圧縮する処理でシステムが過負荷に
      なるのを避けるためのものです。
      &merged;</para>

    <para>次回の起動で使用するカーネルと起動フラグを指定するための
      &man.nextboot.8; ユーティリティが追加されました。この機能は
      &os; 2.2 に初めて登場していたものです。</para>
    <!-- hrs:2003/01/13 - need to be revised -->

    <para><application>NFS</application> が IPv6 に対応しました。</para>

    <para role="historic">&man.ngctl.8;
      が与えられたフックにデータパケットを送る
      <option>write</option> コマンドに対応しました。&merged;</para>

    <para>&man.nice.1; に、実行するユーティリティの
      <quote>nice 値</quote> を指定する
      <option>-n</option> オプションが追加されました。&merged;</para>

    <para><application>nsswitch</application>
      機能が NetBSD からマージされました。
      &man.nsswitch.conf.5; ファイルを作成することで、
      &man.passwd.5; や &man.group.5; といったさまざまなデータベースを、
      通常のテキストファイル、NIS、Hesiod
      を経由して検索するように &os; を設定することが可能です。
      
      <filename>/etc/nsswitch.conf</filename> ファイルが存在しない場合は、
      システム起動時に <filename>/etc/hosts.conf</filename>
      から自動生成されます。また、古いバイナリでは
      <filename>/etc/hosts.conf</filename> が使われる可能性があるので、
      このファイルが存在しない場合はシステム起動時に
      <filename>/etc/nsswitch.conf</filename> を使って自動生成されます。</para>

    <para>&man.od.1; に、
      入力アドレスの起点を指定する <option>-A</option> オプション、
      ダンプするバイト数を指定する <option>-N</option> オプション、
      ダンプを何バイトスキップするか指定する <option>-j</option> オプション、
      符号付きの 10 進数で出力する <option>-s</option> オプション、
      出力形式を指定する <option>-t</option> オプションが追加されました。
      &merged;</para>

    <para arch="sparc64">OpenFirmware デバイスツリーを調べるための
      &man.ofwdump.8; ユーティリティが追加されました。</para>

    <para><application>PAM</application>
      のアカウント管理、セション管理に対応しました。</para>

    <para><application>PAM</application> の設定は
      単一のファイル <filename>/etc/pam.conf</filename> ファイル
      ではなく、<filename>/etc/pam.d/</filename> 内の
      ファイルで行われるようになりました。
      <filename>/etc/pam.d/README</filename> に詳細があります。</para>

    <para>エコーサービスを提供する
      &man.pam.echo.8; モジュールが追加されました。</para>

    <para>&man.pam.exec.8; モジュールが追加されました。
      これはプログラムの実行サービスを提供します。</para>

    <para>&man.pam.ftp.8; モジュールが追加されました。
      これは anonymous FTP ユーザの認証を可能にするものです。</para>

    <para>&man.ftpusers.5; ファイルをチェックする
      &man.pam.ftpusers.8; モジュールが追加されました。</para>

    <para>Kerberos 5 認証と
      &man.su.1; に対して
      <filename>$HOME/.k5login</filename> を使った認可
      (authorization) を行なう
      &man.pam.ksu.8; モジュールが追加されました。</para>
    <!-- hrs:2003/01/06 -
         "authorization" in Kerberos means permitting someone to
         login another system (which needs "authentication," of course). -->

    <para>ログインセションを &man.utmp.5;、&man.wtmp.5;、
      &man.lastlog.5; データベースに記録する
      &man.pam.lastlog.8; モジュールが追加されました。</para>

    <para><filename>/etc/login.access</filename> をチェックする
      &man.pam.login.access.8; モジュールが追加されました。</para>

    <para>&man.nologin.5; を利用してログインを拒否する
      &man.pam.nologin.8; モジュールが追加されました。</para>

    <para>&man.opie.4; を使った認証制御を可能にする
      &man.pam.opie.8;、&man.pam.opieaccess.8; モジュールが追加されました。
      &merged;</para>

    <para>パスワードの変更の際に入力されたパスワードの品質をチェックする
      &man.pam.passwdqc.8; モジュールが追加されました。</para>

    <para>&man.rhosts.5; 認証に対応した
      &man.pam.rhosts.8; モジュールが追加されました。</para>

    <para>スーパーユーザのみが認証に利用できる
      &man.pam.rootok.8; モジュールが追加されました。</para>

    <para>&man.ttys.5; に書かれている TTY の <quote>security</quote> を
      チェックする &man.pam.securetty.8; モジュールが追加されました。</para>

    <para>ユーザの自己認証を可能にする
      &man.pam.self.8; モジュールが追加されました。</para>

    <para role="historic">SSH のパスフレーズと暗号鍵対を使った認証を
      可能にする &man.pam.ssh.8; が追加されました。
      また、このモジュールは
      &man.ssh-agent.1; を呼び出してセションの管理も行ないます。
      &merged;</para>

    <para>あるグループ (デフォルトは <groupname>wheel</groupname>) に
      所属しているかどうかでの認証を可能にする
      &man.pam.wheel.8; モジュールが追加されました。</para>

    <para role="historic">&man.passwd.1; および &man.pw.8; で
      パスワードハッシュアルゴリズムを切り替えられるようになりました。
      <filename>/etc/login.conf</filename> にある
      <literal>passwd_format</literal> をご覧ください。
      &merged;</para>

    <para role="historic">&man.patch.1; に、
      標準入力ではなく、ファイルからパッチを読み込むことを指定する
      <option>-i</option> コマンドラインフラグが追加されました。
      &merged;</para>

    <para>パス名の妥当性や他の POSIX システムとの移植性をチェックする
      &man.pathchk.1; ユーティリティが追加されました。&merged;</para>

    <para role="historic">&man.pax.1; に対して数多くの改良が加えられました。
      その改良には、
      &man.cpio.1; 機能の追加、
      &man.tar.1; 互換機能の強化、
      &man.gzip.1; および &man.compress.1; 機能を提供する
      <option>-z</option> オプションおよび
      <option>-Z</option> オプションの追加、
      バグ修正が含まれます。&merged;</para>

    <para role="historic">&man.pciconf.8; は <option>-l</option> オプションと
      連携して設定されたデバイスの vendor/device 情報を表示する
      <option>-v</option> オプションに対応しました。
      デフォルトの vendor/device データベースは
      <filename>/usr/share/misc/pci_vendors</filename>
      にあります。&merged;</para>

    <para role="historic">&man.periodic.8; の動作が
      <filename>/etc/defaults/periodic.conf</filename> および
      <filename>/etc/periodic.conf</filename>
      で制御できるようになりました。
      &merged;</para>

    <para role="historic">&man.ping.8; に、送出パケットの TTL を設定する
      <option>-m</option> オプションが追加されました。
      &merged;</para>

    <para role="historic">&man.ping.8;
      に、パケットが返って来ない場合にビープ音を鳴らす
      <option>-A</option> オプションが追加されました。&merged;
    </para>

    <para>&man.ping.8; に、応答を一回受け取った後に終了する
      <option>-o</option> フラグが追加されました。</para>

    <para role="historic">ユーザランド &man.ppp.8;
      に、数多くの更新とバグ修正が行なわれました。
      &merged;</para>

    <para role="historic">&man.ppp.8; に、新たに
      <literal>tcpmssfixup</literal> オプションが追加されました。
      これは送信および到着 TCP SYN パケットを調整し、
      最大受信セグメントサイズがインターフェイスの MTU を超えないようにします。
      &merged;</para>

    <para role="historic">&man.ppp.8; が IPv6 に対応しました。&merged;</para>

    <para role="historic">&man.pppd.8; (カーネル PPP の制御用プログラム)
      のインストール時の許可属性が <literal>4555</literal>
      から <literal>4550</literal> に、
      所有者/グループが
      <username>root</username><literal>:</literal><groupname>dialer</groupname>
      に変更されました (つまり、実行できるユーザが制限されました)。
      &man.pppd.8; を利用している場合は、グループ設定を変更する必要があります。
      &merged;</para>

    <para role="historic">&man.pr.1; に、
      端末への出力を一時停止するよう指示する
      <option>-f</option>、<option>-p</option> フラグが追加されました。
      &merged;</para>

    <para>prefix(8) が削除され、
      その機能は &man.ifconfig.8; の
      <option>eui64</option> コマンドに統合されました。</para>

    <para role="historic">&man.ps.1; の <option>-W</option>
      オプション (指定された
      スワップデバイスから情報を取得する) がいつからか
      使えなくなっていました。このオプションは削除されました。&merged;</para>

    <para>&man.pselect.3; ライブラリ関数 (POSIX.1 で導入された
      &man.select.2; を若干強力にしたもの)
      が追加されました。</para>

    <para role="historic">&man.pwd.1;
      に、与えられたパス名を物理ファイルシステムの
      パス名に正規化する
      &man.realpath.1; プログラムの機能が統合されました。
      &merged;</para>

    <para>&man.pwd.1; に、論理カレントディレクトリを表示する
      <option>-L</option> フラグが追加されました。&merged;</para>

    <para>&man.quota.1; に
      NFS ファイルシステムのクォータチェックを抑制する
      <option>-l</option> フラグが追加されました。</para>

    <para>&man.rand.3; の疑似乱数生成器実装に対して、
      結果の乱雑さをより向上させるための改良が加えられました。</para>

    <para>&man.rarpd.8; に
      <filename>/tftpboot</filename> ディレクトリを変更する
      <option>-t</option> フラグが追加されました。
      &merged;</para>

    <para role="historic">&man.rc.8; に &man.rc.conf.5;
      環境変数間の依存関係を処理する枠組が追加されました。
      &merged;</para>

    <para role="historic">&man.rc.8; は起動時に、
      <filename>/var/run</filename> および
      <filename>/var/spool/lock</filename>
      に含まれるディレクトリでないファイルをすべて削除するようになりました。
      &merged;</para>

    <para>&man.rcmd.3; はリモート実行のために &man.rsh.1; の代わりに
      実行するプログラムを <envar>RSH</envar> 環境変数で
      指定できるようになりました。
      そのため、&man.dump.8; のようなプログラムも通信手段として
      &man.ssh.1; を使うことができるようになりました。</para>

    <para>&man.rdist.1; がベースシステムから削除され、
      &os; Ports Collection の
      <filename role="package">net/44bsd-rdist</filename>
      として用意されるようになりました。</para>

    <para role="historic">&man.reboot.8; に、
      再起動時のカーネルを指定する
      <option>-k</option> オプションが追加されました。
      &merged;</para>

    <para>&man.renice.8; コマンドに、
      プロセスの優先度に対する増分を指定する
      <option>-n</option> オプションが追加されました。&merged;</para>

    <para role="historic">&os; の &man.resolver.3;
      実装が EDNS0 に対応しました。
      これは IPv6 対応の resolver、DNS サーバとの動作に必要となるものです。
      &merged;</para>

    <para role="historic">&man.rfork.2; の補助関数として
      &man.rfork.thread.3; 関数が追加されました。
      この関数を使えば、
      複雑なスタック置換コードを実装する必要はありません。
      &merged;</para>

    <para role="historic">&man.rm.1; の <option>-v</option>
      オプションフラグが、
      削除されるファイルの完全なパス名を表示するように変更されました。
      &merged;</para>

    <para role="historic">&man.route.8; で間接経路が変更された際、
      ゲートウェイ経路とその変更された経路とが同じサブネットになっている場合に
      より正確な表示が行なわれるようになりました。&merged;</para>

    <para role="historic">&man.netstat.1; との互換性を高めるため、
      &man.route.8; は
      <literal><replaceable>net</replaceable>/<replaceable>bits</replaceable></literal>
      という書式ではなく
      <literal><replaceable>host</replaceable>/<replaceable>bits</replaceable></literal>
      という書式を使うようになりました。&merged;</para>

    <para role="historic">&man.route.8; が、新たに
      <quote>代理専用 (proxy only)</quote>
      の公開済み ARP エントリを作成できるようになりました。&merged;</para>

    <para role="historic">&man.route.8; の <option>add</option> コマンドは
      <option>-ifp</option> と <option>-ifa</option> の修飾子に
      対応しました。&merged;</para>

    <para>&man.portmap.8; が &man.rpcbind.8; に置き換えられました。</para>

    <para>&man.rpcgen.1; は、
      <filename>/usr/libexec/cpp</filename> ではなく
      (NetBSD のように)
      <filename>/usr/bin/cpp</filename>
      を使うようになりました。</para>

    <para>NetBSD 由来の &man.rpc.lockd.8; が統合されました。
      このデーモンは
      クライアント側の NFS ロックを提供するためのものです。</para>

    <para role="historic">ELF 動的リンカである &man.rtld.1;
      のパフォーマンスが向上しました。
      &merged;</para>

    <para role="historic">RSA Security 社が <application>RSA</application>
      アルゴリズムに関する特許権を放棄したため、
      <application>OpenSSL</application> に含まれる本来の RSA
      アルゴリズム実装が標準状態で有効化されるようになり、
      合衆国在住であるかどうかに関わらず
      <filename role="package">rsaref</filename> port および
      <filename>librsaUSA</filename>、<filename>librsaINTL</filename>
      を使用する必要がなくなりました。
      &merged;</para>

    <para>&man.rtld.1; は <varname>LD_TRACE_LOADED_OBJECTS_ALL</varname>
      環境変数が定義されていた場合、ロードされる各オブジェクトの
      名前を表示するようになりました。</para>

    <para role="historic">&man.savecore.8;
      にクラッシュダンプ作成後のクリアを抑制する新しいオプション
      <option>-k</option> が追加されました。
      またこれによりクラッシュダンプに 0
      の連続が書かれなくなり、容量と時間の短縮も実現します。
      &merged;</para>

    <para role="historic">2GB 以上の RAM を搭載したマシンでも
      &man.savecore.8; が正常に動作するようになりました。
      &merged;</para>

    <para role="historic">&man.sed.1; に、拡張正規表現に対応する
      <option>-E</option> オプションが追加されました。
      &merged;</para>

    <para>&man.sed.1; に、指定ファイルそのものを編集する
      <option>-i</option> オプションが追加されました。&merged;</para>

    <para role="historic">&man.send-pr.1;
      に、障害報告の <literal>Fix:</literal>
      セクションにファイルを挿入するための
      <option>-a</option> オプションが追加されました。
      &merged;</para>

    <para>ファイルシステムの Access Control Lists を管理するコマンド
      &man.setfacl.1; および
      &man.getfacl.1; が追加されました。</para>

    <para role="historic">&man.setproctitle.3; が
      <filename>libutil</filename> から
      <filename>libc</filename> に移動しました。
      &merged;</para>

    <para role="historic">&man.sh.1;
      は効率をあげるために <command>test</command>
      をビルトインコマンドとして実装しました。&merged;</para>

    <para>他のビルトインコマンドと比べてそれほど価値があるとは
      思えないため、&man.sh.1; はもはや <command>printf</command>
      をビルトインコマンドとして実装しません
      (もちろんこの機能は &man.printf.1; 外部コマンドとして
      利用可能です)。</para>

    <para>&man.sh.1; に、出力のリダイレクトで既存の通常ファイルを
      上書きする操作を禁止する <option>-C</option> オプションと、
      未定義の変数を展開しようとした時にエラーを発生させる
      <option>-u</option> オプションが追加されました。&merged;</para>

    <para>&man.sh.1; 内蔵の <command>cd</command> コマンドに、
      論理モードを指定する <option>-L</option> フラグと
      物理モードを指定する <option>-P</option> フラグがそれぞれ追加されました。
      デフォルトは論理モードです。
      このデフォルトは、<varname>physical</varname> という
      &man.sh.1; オプションで 変更できます。&merged;</para>

    <para>&man.sh.1; 内蔵の <command>jobs</command> コマンドに、
      PID のみを表示する <option>-s</option> フラグと
      出力に PID を含める <option>-l</option> フラグが追加されました。
      &merged;</para>

    <para>&man.sh.1; にシェルの行編集機能のキーバインドを変更する
      <command>bind</command> 内蔵コマンドが追加されました。

    <para>&man.sh.1; 内蔵の <command>export</command> および
      <command>readonly</command> コマンドに、
      <quote>portable</quote> フォーマットで出力する
      <option>-p</option> フラグが追加されました。&merged;</para>

    <para>&man.sh.1; は
      <command><replaceable>command</replaceable> &amp; &amp;&amp;
      <replaceable>command</replaceable></command>, <command>&amp;&amp;
      <replaceable>command</replaceable></command>, や <command>||
      <replaceable>command</replaceable></command>. のような構文を
      拒否するようになりました。&merged;</para>

    <para role="historic">&man.sockstat.1; に、
      <option>-c</option> および <option>-l</option>
      オプションフラグが追加されました。これはそれぞれ、
      接続済みもしくは listen 中のソケットを一覧表示します。
      &merged;</para>

    <para>&man.spkrtest.8; が
      Perl スクリプトから &man.sh.1; スクリプトに変更されました。</para>

    <para role="historic">&man.split.1;
      が 2GB を超えるファイルの分割に対応しました。
      &merged;</para>

    <para>&man.split.1; に、分割ファイルの接尾子に使用する文字数を指定する
      <option>-a</option> オプションが追加されました。&merged;</para>

    <para><filename>&lt;sys/select.h&gt;</filename> を
      SUSv2/POSIX 規格に適合させるため、
      <literal>struct selinfo</literal> および関連する関数が
      <filename>&lt;sys/selinfo.h&gt;</filename>
      に移動しました。</para>

    <para role="historic">&man.strstr.3; の変形である &man.strnstr.3; と
      &man.strcasestr.3; が実装されました。&merged;</para>

    <para role="historic">&man.stty.1; が新たに
      <literal>erase2</literal> コントロール文字に対応しました。
      これを用いると、たとえば
      <keycap>Delete</keycap> キーおよび
      <keycap>Backspace</keycap> キーの両方を
      erase 文字として利用することが可能になります。
      &merged;</para>

    <para>&man.su.1; が認証に <application>PAM</application>
      を使うようになりました。</para>

    <para>デバイス上のページングとスワップ処理を無効にする
      &man.swapoff.8; コマンドが追加されました。
      関連するコマンド &man.swapctl.8; も、他の BSD にあるような
      &man.swapon.8; と &man.swapoff.8;
      へのインタフェースに対応しました。

      <note>
        <para>&man.swapoff.8;
          機能は実験的なものと考えられています。</para>
      </note>
    </para>

    <para role="historic">起動時の &man.syscons.4;
      設定は、アーキテクチャに依存しない
      <filename>/etc/rc.syscons</filename>
      で行なうように変更されました。
      &merged;</para>

    <para role="historic">&man.sysctl.8;
      が新たに、変数名のみを表示するためのオプション
      <option>-N</option> に対応しました。
      &merged;</para>

    <para role="historic">&man.sysctl.8; のオプション
      <option>-A</option> および <option>-X</option>
      はそれぞれ <option>-ao</option>
      および <option>-ax</option> に置き換えられ、
      従来のオプションは廃止されました。
      また、動作を指定する <option>-w</option>
      オプションは必要性がないため削除されました。
      &merged;</para>

    <para role="historic">&man.sysctl.8; は変数名と値を分けるのに
      <literal>:</literal> ではなく <literal>=</literal>
      を使うようにする <option>-e</option> オプション
      に対応しました。
      これは出てきた出力をまた &man.sysctl.8; に戻す場合などに
      有用です。&merged;</para>

    <para>&man.sysctl.8; に
      変数の説明を出力する <option>-d</option> フラグが追加されました。</para>

    <para role="historic">&man.sysinstall.8; が、バイナリアップグレードの際に
      <filename>/etc/mail</filename> をきちんと保存するようになりました。
      &merged;</para>

    <para>&man.sysinstall.8; に新しいダイアログ表示関数が導入され、
      より直観的なものになりました。
      &merged;</para>

    <para>&man.sysinstall.8; のデフォルトのルートパーティションのサイズが、
      i386 版と pc98 版が 100MB、Alpha 版が 120MB にそれぞれ変更されました。
    </para>

    <para>インストール手順を単純化するため、
      &man.sysinstall.8; が
      <filename>/usr/sbin</filename> に移動しました。
      &man.sysinstall.8; のマニュアルページも、
      他のユーティリティと同様の方法でインストールされるようになっています。</para>

    <para role="historic">&man.sysinstall.8; がインストール中に KLD を
      ロードできるようになりました。&merged;</para>

    <para role="historic">インストールメディアから実行された場合、
      &man.sysinstall.8; は
      <literal>mfsroot</literal> フロッピーかファイルシステムイメージ
      の <filename>/stand/modules</filename> ディレクトリ
      内に見つかったデバイスドライバを自動的にロードするようになりました。
      その結果、それらのドライバはカーネルのブートメッセージには
      現れないことに注意してください。
      &man.sysinstall.8; デバッグスクリーンに追加情報が提供されます。
      &merged;</para>

    <para role="historic">&man.sysinstall.8; がルートファイルシステムを除き、
      作成する全てのファイルシステムにおいて Soft Updates を
      デフォルトで有効にするようになりました。&merged;</para>

    <para role="historic">&man.sysinstall.8; において、<quote>auto</quote>
      パーティション分割モードが作成するパーティションの
      大きさが、より妥当なデフォルト値となるようになりました。
      自動可変サイズのパーティションは、他のパーティション
      が削除されると自動的にその容量を吸収するようになりました。
      &merged;</para>

    <para>&man.sysinstall.8; は新規インストールの際にデフォルトで
      &man.procfs.5; をマウントしなくなりました。
      この変更はセキュリティの向上をねらったものですが、
      &man.procfs.5; を手動で、あるいは &man.fstab.5;
      ファイルに指定することでマウントすることは可能です。</para>

    <para role="historic">未完成ですが、&man.sysinstall.8; が
      (複数の CD による配布のような)
      複数のボリュームを利用するインストールにおいて、
      正しいボリュームから package を拾い出す機能に対応しました。
      &merged;</para>

    <para role="historic">&man.syslogd.8; に新たなオプション
      <option>-n</option> が追加されました。
      これは syslog 要求に対する DNS 問い合わせを抑制します。
      &merged;</para>

    <para role="historic">&man.syslogd.8; が新たに、
      ログを <filename>/dev/console</filename> に出力する
      <literal>LOG_CONSOLE</literal> ファシリティ
      (標準設定では無効) に対応しました。
      &merged;</para>

    <para role="historic">&man.syslogd.8;
      に新しく <option>-b</option> オプションが追加されました。
      これは &man.syslogd.8; を、
      利用可能なすべてのアドレスではなく指定アドレスへ bind
      させるためのものです。&merged;</para>

    <para role="historic">&man.syslogd.8;
      に新しく、重複した行を圧縮する機能を無効に
      する <option>-c</option> フラグが追加されました。&merged;</para>

    <para>&man.systat.1; に、新しく <option>-ifstat</option>
      ディスプレイモードが追加されました。
      これは、システム上の有効かインタフェースを通過するネットワークトラフィックを表示します。</para>

    <para>端末のタブストップを設定する
      &man.tabs.1; ユーティリティが追加されました。</para>

    <para role="historic">&man.tail.1;
      が 2GB を超えるファイルの処理に対応しました。
      &merged;</para>

    <para role="historic">&man.tar.1; が <varname>TAR_RSH</varname>
      環境変数に対応しました。
      これは主に、
      転送手段として &man.ssh.1; を利用できるようにするためのものです。
      &merged;</para>

    <para role="historic">&man.telnet.1;
      が標準で autologin と暗号化に対応しました。
      また、暗号化を抑制するオプション <option>-y</option>
      も追加されています。&merged;</para>

    <para role="historic">&man.telnet.1; に新しいオプション
      <option>-u</option> が追加されました。
      これは UNIX ドメイン (<literal>AF_UNIX</literal>)
      ソケットへの接続を可能にするものです。
      &merged;</para>

    <para>&man.termcap.5; データベースは、
      <application>XFree86</application> 由来の
      <literal>xterm</literal> 端末タイプを使うようになりました。
      これにより &man.xterm.1; はデフォルトでカラー表示が可能になり、
      環境変数 <varname>TERM</varname> に <literal>xterm-color</literal>
      を設定するという回避策はもう必要なくなりました。
      <literal>xterm-color</literal> 端末タイプを利用していると、
      アプリケーションから (害はありませんが) 警告が出るかも知れません。</para>

    <para role="historic">&man.tftp.1; と &man.tftpd.8; が
      IPv6 に対応しました。&merged;</para>

    <para role="historic">&man.tftpd.8;
      に新しいオプション <option>-c</option> および
      <option>-C</option> が追加されました。
      これらは接続したクライアントの IP アドレスに応じて
      &man.chroot.2; 先の変更を可能にするものです。
      また &man.tftp.1; および &man.tftpd.8; は、
      65535 ブロックよち大きいファイルが転送できるように修正されています。
      &merged;</para>

    <para>&man.tftpd.8; が RFC 2349 (TFTP Timeout Interval
      and Transfer Size Options) に対応しました。
      この機能は (HP i2000 Itanium サーバが採用している)
      EFI ブートマネージャのようなファームウェアが
      <application>TFTP</application>
      を使ってイメージから起動するために必要となるものです。</para>

    <para arch="alpha">&man.timed.8; が Alpha 上で動作するように
      なりました。</para>

    <para>Transport Independent RPC
    (<application>TI-RPC</application>) が統合されました。</para>

    <para role="historic"><envar>TMPDIR</envar> を用いて
      &man.tmpnam.3; における一時ファイルの場所を指定できるようになりました。
      &merged;</para>

    <para>&man.tip.1; が <application>OpenBSD</application>
      由来のものに更新されました。
      &man.cu.1; の代用品として動作することができます。</para>

    <para>&man.top.1; が、
      tty の持つ最大の表示幅を利用するようになりました。</para>

    <para>&man.touch.1; に新しいオプション
      <option>-h</option> が追加されました。
      これはコマンドの作用をシンボリックリンクのリンク先ではなく、
      リンクそのものに対して行なうことを指定するものです。</para>

    <para>&man.tr.1; が、一部の等価クラス
      (equivalence class, 対応しているロケールのみ) に対応しました。
      &merged;</para>

    <para>&man.tr.1; に第一引数で指定された文字の補集合を表す
      <option>-C</option> フラグが追加されました。</para>

    <para role="historic">ファイルを指定した長さに切り詰めたり、
      拡張したりするための &man.truncate.1;
      ユーティリティが新たに追加されました。
      &merged;</para>

    <para>&man.tunefs.8; に、UFS ファイルシステムの
      <literal>FS_ACLS</literal> 管理フラグおよび
      <literal>FS_MULTILABEL</literal> 管理フラグの有効化・無効化を指定する
      <option>-a</option> フラグと
      <option>-l</option> フラグがそれぞれ追加されました。</para>

    <para>&man.ipfw.8; と類似した
      &man.ugidfw.8; ユーティリティが追加されました。
      これは <literal>mac_bsdextended</literal>
      MAC (Mandatory Access Control)
      ポリシのルールセットを管理するためのものです。</para>

    <para role="historic">&os; コンソールがウクライナ語に対応しました。
      &merged;</para>

    <para>&man.cu.1; と &man.rmail.8; を除いて、
      <application>UUCP</application> は
      ベースシステムから削除されました。
      現在は Ports Collection の
      <filename role="package">net/freebsd-uucp</filename> にあります。</para>

    <para>&man.unexpand.1; に、
      &man.expand.1; と同じようにタブ位置を指定する
      <option>-t</option> オプションが追加されました。&merged;</para>

    <para role="historic">&man.units.1;
      に対していくつかの更新とバグ修正が加えられました。
      &merged;</para>

    <para>&man.usbdevs.8; に、各デバイスに対応するデバイスドライバ
      を表示する <option>-d</option> フラグが追加されました。</para>

    <para role="historic">USB Human Interface Devices の操作を行なうための、
      &man.usbhidctl.1; ユーティリティが追加されました。
      &merged;</para>

    <para role="historic">&man.uuencode.1; と &man.uudecode.1; に
      出力ファイルを指定する <option>-o</option> が追加されました。
      &man.uuencode.1; は <option>-m</option> フラグを指定すると
      base64 エンコーディングを行なうようになりました。 
      また、&man.uudecode.1; は自動的に
      base64 ファイルをデコードするようになっています。&merged;</para>

    <para>&man.uuencode.1; と &man.uudecode.1; の base64 変換機能が、
      それぞれ &man.b64encode.1; と &man.b64decode.1;
      という名前で実行することで自動的に有効になるようになりました。
      (訳注: &man.b64encode.1; は &man.uuencode.1; の、
      &man.b64decode.1; は &man.uudecode.1; のハードリンクです)。
      &merged;</para>

    <para>&man.uuidgen.1; ユーティリティが追加されました。
      これは新しく導入された &man.uuidgen.2; システムコールを利用して
      OSF/DCE 1.1 version 1 UUID と互換性のある
      Universally Unique Identifier を一つ (ないしそれ以上) 生成します。</para>

    <para role="historic">&man.vidcontrol.1; に新しいオプション
      <option>-g</option>
      が追加されました。これは
      <literal>VESA_800x600</literal> ラスタテキストモードにおいて、
      テキストサイズを指定するためのものです。
      &merged;</para>

    <para role="historic">&man.vidcontrol.1; において、
      フォントロード時のフォントサイズ指定を省略できるようになりました。
      また、エラー処理部分にいくつかの改良も加えられています。
      &merged;</para>

    <para role="historic">&man.vidcontrol.1; に &man.syscons.4;
      画像バッファのスナップショットをとるための新しいオプション
      <option>-p</option> が追加されました。
      このオプションによるスナップショットは、
      Ports Collection に含まれる
      <filename role="package">graphics/scr2png</filename>
      ユーティリティで操作することができます。
      &merged;</para>

    <para role="historic">&man.vidcontrol.1; に、
      指定した tty の履歴バッファをクリアする新しいオプション
      <option>-C</option> が追加されました。
      また <option>-h</option> オプションを使うことで、
      履歴バッファの大きさを設定することが可能です。
      &merged;</para>

    <para>&man.vidcontrol.1; に、VTY  の切替えを無効にする
      <option>-S</option> フラグが追加されました。&merged;</para>

    <para>&man.vinum.8; のストライプサイズの既定値が
      256KB から 279KB に変更されました。
      これは各ストライプに対してスーパブロックを均等に割り振るためです。</para>

    <para role="historic">&man.wall.1;
      に新しいオプション <option>-g</option> が追加されました。
      これは指定したグループに属するユーザ全員にメッセージを送ります。
      &merged;</para>

    <para role="historic">&man.watch.8; に &man.snp.4; デバイスを使うようにする
      <option>-f</option> オプションが追加されました。&merged;</para>

    <para>&man.wc.1; がバイトではなく文字をカウントする
      <option>-m</option> フラグに対応しました。</para>

    <para>&man.whereis.1; が Perl スクリプトから C プログラムに変更されました。
      &man.locate.1; の起動を抑制する <option>-x</option> フラグ、
      出力行の先頭に現れるクエリ名の表示を抑制する
      <option>-q</option> フラグが追加されました。</para>

    <para>&man.whereis.1; に、
      検索対象のファイルタイプに一致する最初のものだけでなく、
      マッチするものすべてを表示する
      <option>-a</option> フラグが追加されました。</para>

    <para>Perl スクリプトだった &man.which.1; が
      C プログラムに変更されました。</para>

    <para>&man.who.1; に数多くのオプションが追加されました。
      <option>-H</option> はカラムヘッダを出力し、
      <option>-T</option> は &man.mesg.1; の設定を表示します。
      <option>-m</option> は <option>am i</option> と等価であり、
      <option>-u</option> はアイドル時間の表示、
      <option>-q</option> はログイン名を列で表示します。&merged;</para>

    <para role="historic">&man.whois.1; は、IP アドレスの問い合わせを
      ARIN に送るように変更されました。
      <option>-Q</option> オプションが指定されておらず、
      ARIN への問い合わせが APNIC もしくは RIPE
      参照する場合には、適切なサーバに再問い合わせが行なわれます。
      &merged;</para>

    <para role="historic">&man.whois.1;
      に、簡単に特定の whois サーバへ直接問い合わせ
      を送ることができるようになる <option>-c</option> オプション
      が追加されました。&merged;</para>

    <para>&man.wicontrol.8; に、
      <literal>hostap</literal>
      モードの際に接続中のステーションの一覧を表示する
      <option>-l</option> フラグと
      利用可能なアクセスポイントの一覧を表示する
      <option>-L</option> フラグが追加されました。</para>

    <para>&man.xargs.1; に新しいオプション <option>-I</option>
      <replaceable>replstr</replaceable> が追加されました。
      これは標準入力から読み込まれたデータをコマンドライン引数の最後ではなく、
      指定した点に挿入するように制御するためのものです
      (&os; 独自の <option>-J</option> オプションと同様の機能です)。
      &merged;</para>

    <para>&man.xargs.1; に、入力を指定行数ごとに区切り、
      それを引数にして入力がなくなるまで複数回コマンドを呼び出すという
      <option>-L</option> オプションが追加されました。&merged;</para>

    <para>&man.xargs.1; に、ユーティリティを複数並列に実行する
      <option>-P</option> オプションが追加されました。</para>

    <para role="historic">コンパイラが FSF が提供している
      C/C++ ランタイム初期化コードを使用するように変更されました。
      この変更によりFSF が公開しているソースとの親和性だけでなく、
      各種 egcs および gcc の移植版が生成するコードとの互換性が向上しています。
      &merged;</para>

    <para role="historic">スレッドライブラリに対して、
      シグナル操作の変更、バグ修正、パフォーマンスの改良
      (システムコールスレッド切り替えの抑制を含む) が加えられました。
      &man.gdb.1; のスレッド対応も、その変更を反映して更新されています。
      &merged;</para>

    <para role="historic">国際化対応のために非常に多くの追加が行なわれました。
      &os; は今回、
      <literal>LC_MONETARY</literal>、
      <literal>LC_NUMERIC</literal>、および
      <literal>LC_MESSAGES</literal>
      の各カテゴリのロケールに完全対応しています。
      また多くのアプリケーションが、
      この対応を反映するように更新されています。&merged;</para>

    <para role="historic">X11R6 や他の UNIX 系 OS との互換性を高めるため、
      ロケール名の変更が行なわれました。
      たとえば <literal>en_US.ISO_8859-1</literal> は
      <literal>en_US.ISO8859-1</literal> に変わっています。
      これに対する後方互換性は <filename>/etc/locale.alias</filename>
      に含まれるエントリによって提供されています。&merged;</para>

    <para>C ライブラリ中のさまざまなルーチンが
      <quote>ワイド</quote> 文字に対応しました。
      この対応は &man.wctype.3; のような文字クラス関数、
      &man.getwc.3; のようなワイド文字入出力関数、
      &man.wprintf.3;, &man.wscanf.3; のような書式入出力関数にわたります。
      &man.multibyte.3; 文字への変換関数にも対応しています。</para>

    <para role="historic">
      <filename>/usr/src/share/examples/BSD_daemon/</filename> に
      スケーラブルな Beastie 画像が追加されました。
      &merged;</para>

    <para role="historic">数多くのマニュアルページに対して、
      内容および組版用マークアップの改訂が行なわれました。
      &merged;</para>

    <para>多くのユーティリティとライブラリが改良され、
      Single UNIX Specification (SUSv3) および
      IEEE Std 1003.1-2001 (<quote>POSIX.1</quote>)
      との適合性が向上しました。
      個々のユーティリティにおいて追加された機能は
      リリースノートに記載されています。
      個々のユーティリティやライブラリ関数の標準への適合性は
      そのマニュアルページに記載されています。</para>

    <para>ベースシステムから BSD
      に伝統的に含まれていた数々のゲームが削除されました。
      これには adventure(6), arithmetic(6), atc(6),
      backgammon(6), battlestar(6), bs(6), canfield(6), cribbage(6),
      fish(6), hack(6), hangman(6), larn(6), mille(6), phantasia(6),
      piano(6), pig(6), quiz(6), rain(6), robots(6), rogue(6),
      sail(6), snake(6), trek(6), wargames(6), worm(6), worms(6),
      wump(6) が含まれます。
      各ゲームへのアクセスを制限するのに利用されていた
      dm(8) は必要がなくなったため、削除されました。
      &man.fortune.6; のように
      <quote>ユーティリティともみなせる</quote>
      ゲームは残されています。</para>

    <sect3>
      <title>寄贈ソフトウェア</title>

      <para><application>am-utils</application> がバージョン
        6.0.7 に更新されました。</para>

      <para>Bell Labs の <application>awk</application>
	( <quote>BWK awk</quote> や <quote>The One True	AWK</quote>
	として知られています ) の 2002 年 12 月 13
        日時点のスナップショットが統合されました。
	<command>awk</command>、<command>nawk</command>
	としてインストールされます。</para>

      <para role="historic"><application>bc</application>
        がバージョン 1.04 から 1.06 に更新されました。
        &merged;</para>

      <para role="historic"><application>BIND</application> 配布物に含まれる
        ISC ライブラリが
        <filename>libisc</filename> として構築されるようになりました。
        &merged;</para>

      <para><application>BIND</application> が
        <literal>NOADDITIONAL</literal>
	オプションで構築されるようになりました。
        これは良くある設定ミスに対して、
        &man.named.8; により一貫性の高い動作をさせるためのものです。
        &merged;</para>

      <para><application>BIND</application> がバージョン
        8.3.3 に更新されました。&merged;</para>

      <para><application>Binutils</application> が
	2002/10/27 の 2.13.2 プレリリーススナップショットに
	更新されました。</para>

      <para role="historic"><application>bzip2</application>
	バージョン 1.0.2 が統合されました。
        これによりベースシステムに &man.bzip2.1; プログラムおよび、
        <filename>libbz2</filename> ライブラリが導入されました。
	&merged;</para>

      <para>ベースシステムに <application>bzip2</application>
        スイート全体、特に <command>bzip2recover</command>
        がインストールされるようになりました。&merged;</para>

      <para role="historic">&man.ee.1; <application>Easy Editor</application>
        がバージョン 1.4.2 に更新されました。
        &merged;</para>

      <para><application>file</application>
	がバージョン 3.39 に更新されました。
        </para>

      <para><application>gcc</application> が、
	<application>gcc</application>
	3.2.1 のリリースバージョンに更新されました。
	<warning>
	  <para><application>gcc</application>
	    3.2.1 の C++ ABI は、
            以前のバージョンのものと互換性がありません。</para>
	</warning>
      </para>

      <para role="historic">&man.gcc.1; は、
        従来のスレッド対応ライブラリとスレッド非対応ライブラリという分割を
	廃止し、
        その二つが統合された <filename>libgcc</filename>
	を使用するようになりました。
        <filename>/usr/lib/libgcc_r.a</filename> は削除して構いません.
        &merged;</para>

      <para>&man.gcc.1; が
        <envar>GCC_OPTIONS</envar> 環境変数に対応しました。
        この変数には <application>GCC</application>
        のデフォルトオプションを指定します。
        &merged;</para>

      <para><application>gdb</application> がバージョン
        5.2.1 に更新されました。</para>

      <para role="historic"><application>GNATS</application> がバージョン
        3.113 に更新されました。
        &merged;</para>

      <para><application>gperf</application> がバージョン
        2.7.2 に更新されました。</para>

      <para><application>groff</application>
	および関連ユーティリティが更新され、
        FSF バージョン 1.18.1 になりました。</para>

      <para><application>Heimdal Kerberos</application> がバージョン
        0.5.1 に更新されました。
        &merged;</para>

      <para role="historic">&os; に含まれているバージョンの
	<application>IPFilter</application> には、NAT エントリ
	とステートフルルール用に作成されたステート情報を
	ディスクに保存し、リブート後に再生することができる
	&man.ipfs.8; プログラムが含まれています。
	&man.rc.conf.5; で、起動時にこれらの機能を設定することが
	できます。&merged;</para>

      <para><application>ISC DHCP</application> クライアントがバージョン
        3.0.1RC11 に更新されました。</para>

      <para role="historic"><application>Kerberos IV</application> がバージョン
        1.0.5 に更新されました。
        &merged;</para>

      <para>&man.more.1; コマンドが &man.less.1; に置き換えられました、
        ただし <command>more</command> というコマンド名はそのまま使用
        できます。&merged;
        <application>less</application> のバージョン 371 が統合されました。
      </para>

      <para>ベースシステムにおける
        XML を使用するユーティリティの利便性を向上するために、
        <filename>libbsdxml</filename> という名前の
        XML 処理ライブラリが追加されました。
        このライブラリの大部分は基本的に <application>expat</application>
        1.95.5 を統合したものですが、
        Ports Collection を利用してインストールした
        <application>expat</application> と衝突するのを避けるために
        異なる名前でインストールされています。</para>

      <para><application>libpcap</application> がバージョン
        0.7.1 に更新されました。&merged;</para>

      <para><application>libreadline</application> がバージョン
        4.2 に更新されました。</para>

      <para><application>libz</application> が 1.1.4 に
	更新されました。</para>

      <para><application>lint</application> は NetBSD &man.lint.1; の
	2002 年 7 月 19 日時点のスナップショットに更新されました。</para>

      <para>&os; の &man.ftp.1; プログラムが
	<application>lukemftp</application>
	1.6 beta 2 (NetBSD 由来の FTP クライアント)
	に置き換えられました。
	これにより、より自動化された動作や、標準への準拠、転送レート制御、
	カスタマイズ可能なコマンドラインプロンプトなどが
	提供されます。
	いくつかの環境変数やコマンドライン引数が変更となっています。</para>

      <para>OpenBSD から 2002 年 4 月 26 日時点の
	&man.m4.1; が統合されました。&merged;</para>

      <para><application>ncurses</application> がバージョン
        5.2-20020615 に更新されました。</para>

      <para role="historic"><application>NTP</application>
	プログラムスイートがバージョン
        4.1.1b に更新されました。</para>

      <para><application>OpenPAM</application>
        (<quote>Daffodil</quote> リリース) が
	<application>Linux-PAM</application> に代わって
	統合されました。</para>

      <para><application>OPIE</application>
        ワンタイムパスワードスイートがバージョン 2.4 に更新されました。
        &merged;
        これは <application>S/Key</application>
        の機能を完全に置き換えるものです。&merged;</para>

      <para><application>Perl</application> が
	&os; のベースシステムから削除されました。
	なお、Perl は &os; Ports Collection から、
	package としてインストールするか、もしくは
        &man.sysinstall.8; のメニューから
        <guimenuitem>Perl distribution</guimenuitem>
        を選択することでインストールすることができます。
	Perl のベースシステムから削除の削除は、
        今後のアップグレードと保守を容易にすることを目的としています。
        ベースシステムの Perl 依存性を減らすため、
	多くのユーティリティがシェルスクリプトや
	C プログラムで書き直されました
	(書き直されたユーティリティは、リリースノート中に記載されています)。

        <note>
          <para>Perl の削除作業は、まだ完了していません。</para>
        </note>

         <note>
           <para>&man.sysinstall.8; の配布物のほとんどには、
            新しい Perl 配布物が含まれています。
            そのため、Perl
            がベースシステムとは独立して更新されるという点を除いて、
            この変更をユーザが意識することはほとんどないでしょう。</para>
         </note>
      </para>

      <para><application>GNU ptx</application> が
	ベースシステムから削除されました。
	ペースシステムでは利用されておらず、
	更新や保守がされていないことが理由です。
	この機能が必要なユーザは
	<filename role="package">textproc/textutils</filename> カテゴリから
	当該ユーティリティをインストールしてください。</para>

      <para>NetBSD から
        <literal>rc.d</literal> フレームワークが導入されました。
        これは、従来のシステムのスタートアップ部分を
        <quote>task 指向</quote> のスクリプト群として細かく分割して
        <filename>/etc/rc.d</filename> に配置し、
        そのスタートアップスクリプトの起動順を、
        起動時に動的に決定するというものです。</para>

      <para role="historic">&man.routed.8; がバージョン 2.22 に更新されました。
        &merged;</para>

      <para arch="i386,pc98"><application>smbfs</application> ユーザランド
	ユーティリティのバージョン 1.4.5 が統合されました。</para>

      <para><application>GNU sort</application> が
	<application>GNU textutils 2.0.21</application>
        に含まれるものに更新されました。</para>
 
      <para><application>NetBSD</application> 由来の (2002 年 6 月 5 日時点の)
	&man.stat.1 コマンドが導入されました。</para>
 
      <para><application>GNU tar</application> が
	バージョン 1.13.25 に更新されました。 &merged;</para>

      <para><application>tcpdump</application> がバージョン
        3.7.1 に更新されました。&merged;</para>

      <para>&man.csh.1; シェルが &man.tcsh.1; に置き換えられました。
        ただし <command>csh</command> というコマンド名はそのまま使用できます。
        <application>tcsh</application> はバージョン 6.12 に更新されました。
        &merged;</para>

      <para><application>tcp_wrappers</application> の寄贈版
	は &man.tcpd.8; ヘルパーデーモンを含むようになりました。
	標準的な &os; インストールでは (&man.inetd.8; がすでに
	この機能を統合しているため) これは必ずしも必要というわけでは
	ありませんが、<application>xinetd</application> のような
	&man.inetd.8; を置き換えるアプリケーションには有用です。&merged;</para>

      <para><application>texinfo</application> がバージョン
        4.2 に更新されました。
        &merged;</para>

      <para><application>top</application> がバージョン 3.5b12
	に更新されました。&merged;</para>

      <para><application>traceroute</application> が
        LBL (Lawrence Berkeley National Laboratory) の
        バージョン 1.4a12 に更新されました。</para>

      <para role="historic">&man.traceroute.8; は、
        デフォルトの最大 TTL 値を
        <varname>net.inet.ip.ttl</varname>
	sysctl 変数から得るようになりました。
        &merged;</para>

      <para>タイムゾーンデータベースが
	<filename>tzdata2002d</filename> リリースに更新されました。
      </para>

      <sect4>
        <title>CVS</title>

        <para><application>cvs</application>
	  が、バージョン 1.11.2.1 の
          2002 年 12 月 1 日時点のスナップショットに更新されました。&merged;</para>

        <para role="historic">&man.cvs.1; が利用する
	  <envar>CVS_RSH</envar> 環境変数の
          既定値が <literal>rsh</literal> ではなく
          <literal>ssh</literal> になりました。
          &merged;</para>

        <para role="historic">&man.cvs.1; に新しいオプション
	  <option>-T</option> が追加されました。
          これはリポジトリから砂場 (sandbox) にある
	  <filename>CVS/Template</filename>
          ファイルを更新するためのものです。
          &merged;</para>

	<para role="historic">&man.cvs.1; <literal>diff</literal>
	  に新しいオプション
          <option>-j</option> が追加されました。
          これはブランチタグのリビジョンとの比較を実現します。
          &merged;</para>
      </sect4>

      <sect4>
        <title>CVSup</title>

        <para role="historic"><application>CVSup</application> は
          &os; Ports Collection で良く使われるユーティリティの一つです。
          以前はこれをインストールする複数の port/package が存在しましたが、
          <filename role="package">net/cvsup-bin</filename> および
	  <filename role="package">net/cvsupd-bin</filename>
          は廃止され、<filename role="package">net/cvsup</filename>
	  になりました。&merged;</para>

        <para role="historic">&os; Ports Collection の
	  <filename role="package">net/cvsup</filename>
          からインストールできる
          <application>CVSup</application> は 16.1_3 に更新されています。
          この更新では 2001 年 9 月 9 日 01:46:40 UTC
          (UNIX epoch から 1,000,000,000 秒後)
          以降のすべてのファイルのタイムスタンプに影響する、
          長い間存在していた (ただし表面化しなかった)
          バグが修正されました。&merged;</para>
      </sect4>

      <sect4 id="kame-userland">
        <title>KAME</title>

        <para role="historic">IPv6 スタックが KAME プロジェクトの
          2001 年 5 月 28 日づけの
	  スナップショットをベースとしたものになりました。
          この節の項目のほとんどは、それが取り込まれたことによるものです。
          KAME IPv6 スタックに関するカーネルへの変更点は
          <xref linkend="kame-kernel"> にあります。
            &merged;</para>

	<para role="historic">&man.faithd.8;
	  がアクセス制御用の設定ファイルに対応しました。
          &merged;</para>

	<para role="historic">&man.ifconfig.8;
	  に gifconfig(8) の機能が統合されました。
          &merged;</para>

	<para role="historic">&man.ifconfig.8;
	  に prefix(8) の機能が統合されました。&merged;</para>

	<para role="historic">&man.ndp.8; に対して、RFC2461
          (Neighbor Discovery for IP Version 6 (IPv6))
          に書かれているような無効になった NDP
          エントリに対するガベージコレクションが実装されました。
          &merged;</para>

        <para role="historic">制限されたライセンス条件を持った
          pim6dd(8) および pim6sd(8) が削除されました。
          これらのプログラムは Ports Collection の一部として
          <filename role="package">net/pim6dd</filename>、
          <filename role="package">net/pim6dd</filename> から利用可能です。
          &merged;</para>

	<para role="historic">&man.route6d.8; に新しいオプション
          <option>-n</option> が追加されました。
          これはカーネルの転送テーブルの更新を抑制するためのものです。
          &merged;</para>

	<para role="historic">&man.rtadvd.8; に対する <option>-R</option>
	  (ルータ再ナンバリング)
          オプションは、現時点では無視されるようになっています。
          &merged;</para>
      </sect4>

      <sect4>
        <title>OpenSSH</title>

	<para role="historic"><application>OpenSSH</application> がバージョン
          2.9 に更新されました。
	  これは SSH2 プロトコル (デフォルト) と、DSA 暗号鍵に対応した
          ものです。
	  &man.ssh-add.1; と &man.ssh-agent.1; は DSA 暗号鍵
	  に対応しており、認証 forwarding を使うことができます。
          そのため合衆国在住の <application>OpenSSH</application>
          ユーザは、RSA 暗号鍵を扱うために必要な、制限されたライセンスを持つ
          RSAREF ツールキットに依存しなくても済むようになりました。
	  その他の新しい機能もいくつかあります:
	  &man.sftp.1; のクライアントとサーバが追加されました。
	  &man.scp.1; は 2GB 以上のファイルを扱えるようになりました。
	  &man.sshd.8; に対して新たに、
          未認証の ssh 接続数を制限する機能が追加されています。
	  Rijndael 暗号アルゴリズムに対応しました。
	  &man.ssh.1; が既存セションの rekeying に対応し、実験的な
	  <application>SOCKS4</application> プロキシも加えられました。
	  &merged;</para>

	<para><application>OpenSSH</application> が 3.4p1 に更新されました。
	  &merged; 主な変更点は以下のとおりです。
	  <itemizedlist>
	    <listitem>
	      <para><filename>*2</filename> は廃止されました
		(たとえば
		<filename>~/.ssh/known_hosts</filename> は
		<filename>~/.ssh/known_hosts2</filename> の中身を
		含めることができます)。</para>
	    </listitem>
	    <listitem>
	      <para>&man.ssh-keygen.1; はいくつかの商用 SSH 実装
		と鍵を交換するために、SECSH 公開鍵ファイルフォーマット
		を使って鍵を import/export することができるようになりました。
	      </para>
	    </listitem>
	    <listitem>
	      <para>&man.ssh-add.1; は三つのデフォルト鍵すべてを追加するように
		なりました。</para>
	    </listitem>
	    <listitem>
	      <para>&man.ssh-keygen.1; は特定の鍵形式をデフォルトとは
		しないようになりました。<option>-t</option> オプション
		で明示的に指定する必要があります。</para>
	    </listitem>
	    <listitem>
	      <para>プログラムのバグや将来的に発見される可能性のある
		セキュリティ上の弱点の影響を小さくするために、
		特権を持たないプロセスを使うという
		<quote>特権分離 (privilege separation)</quote>
		機能が追加されました。</para>
	    </listitem>
	    <listitem>
	      <para>整数変数のオーバフローによって権限の不正な獲得が
		可能になるというセキュリティホールなど、
		いくつかのバグが修正されました。</para>
	    </listitem>
	  </itemizedlist>
	</para>

	<para role="historic"><application>OpenSSH</application>
	  は <application>OPIE</application> パスワードで
	  認証できるようになりました。&merged;</para>

        <para role="historic"><application>OpenSSH</application> が
          <application>PAM</application> に対応しました。&merged;</para>

	<para role="historic">
	  <application>OpenSSH</application> にかなり前から存在した
          転送された X11
          クライアントが終了する時にセションが
	  切断されてしまうというバグが修正されました。&merged;</para>

	<para role="historic"><application>OpenSSH</application>
          に
          <application>Kerberos</application> 互換機能が
          追加されました。
          &merged;</para>

	<para role="historic"><application>OpenSSH</application> に対して、
          パスワード長を知るために <quote>echo されない</quote>
	  文字を空パケットで
          echo されるように指定したり、
          無意味なデータで水増ししたパスワードを送るといった
          トラフィック解析への耐性を高めるための変更が行なわれました。
          &merged;</para>

        <para role="historic">新規インストール時の標準設定で
          &man.sshd.8; が有効化されるようになりました。
          &merged;</para>

        <para role="historic">&man.sshd.8; サーバは標準設定で
          <literal>X11Forwarding</literal> が有効化されるようになりました
          (危険性はクライアント側にのみ存在し、
          クライアント側の標準設定は無効になっています)。
          &merged;</para>

	<para role="historic"><filename>/etc/ssh/sshd_config</filename>
          の
          <literal>ConnectionsPerPeriod</literal> パラメータが
          <literal>MaxStartups</literal> に置き換えられました。
          &merged;</para>

	<para role="historic"><application>OpenSSH</application> の
          &man.sshd.8; に新しい設定項目
          <literal>VersionAddendum</literal> が追加されました。
          これは <application>OpenSSH</application>
          のメインバージョン番号の後ろに続く文字列を変更するためのものです。
	  &merged;
	</para>
      </sect4>

      <sect4>
        <title>OpenSSL</title>

	<para><application>OpenSSL</application> がバージョン
          0.9.6g に更新されました。&merged;</para>

	<para role="historic"><application>OpenSSL</application>
          がマシン依存のアセンブラ最適化に対応しました。
          これは <filename>make.conf</filename> 変数
          <varname>MACHINE_CPU</varname> および <varname>CPUTYPE</varname>
          を指定することで有効化されます。
          &merged;</para>
      </sect4>

      <sect4>
	<title>sendmail</title>

	<para><application>sendmail</application> がバージョン
          8.9.3 からバージョン 8.12.6 に更新されました。
          これには重要な変更点として、
	  &man.sendmail.8;
	  は set-user-ID <username>root</username> バイナリとして
	  インストールされなくなったこと
	  (set-group-ID <groupname>smmsp</groupname> されます)、
          標準のファイル配置の変更
          (<filename>/usr/src/contrib/sendmail/cf/README</filename> 参照)、
          &man.newaliases.1; の実行が
          <username>root</username> および信頼できるユーザに制限されたこと、
          STARTTLS 暗号化に対応したこと、
          標準設定で MSA ポート (587) が有効化されたことが含まれています。
          詳細については
          <filename>/usr/src/contrib/sendmail/RELEASE_NOTES</filename>
          をご覧ください。
          &merged;</para>

	<para role="historic">&man.mail.local.8;
	  が set-user-ID バイナリとしてインストール
	  されなくなりました。
          &os; に標準で含まれる <filename>sendmail.cf</filename>
	  を使用している場合、
          それがバージョン 3.1.0 以降のものであれば問題ありません。
          もし独自に設定した
          <filename>sendmail.cf</filename>
          を使用し、メール配送に
          <command>mail.local</command> を使用している場合は、
          <literal>Mlocal</literal> の行に
          <literal>F=S</literal>
	  フラグがセットされていることを確認してください。
          このフラグをセットするには、
          対応する <filename>.mc</filename> ファイルに次の行を追加して
          <filename>sendmail.cf</filename> ファイルを再生成します。</para>

	<programlisting role="historic">
	  MODIFY_MAILER_FLAGS(`LOCAL',`+S')dnl</programlisting>

	<para role="historic"><literal>FEATURE(`local_lmtp')</literal>
          には、上記の機能が含まるようになっています。
          &merged;</para>

	<para role="historic">標準の
	  <filename>/etc/mail/sendmail.cf</filename> において、
          SMTP の <literal>EXPN</literal> および
          <literal>VRFY</literal> コマンドが無効化されました。
          &merged;</para>

	<para role="historic">&man.vacation.1; が更新され、
          <application>sendmail</application>
          に含まれるバージョンを使用するようになりました。
          &merged;</para>

	<para role="historic"><application>sendmail</application>
          設定ファイル構築ツールが
          <filename>/usr/share/sendmail/cf/</filename>
          にインストールされるようになりました。
          &merged;</para>

	<para role="historic">新しい <filename>make.conf</filename> 変数
          <varname>SENDMAIL_MC</varname> および
          <varname>SENDMAIL_ADDITIONAL_MC</varname> が追加されました。
          詳細については
          <filename>/usr/share/examples/etc/make.conf</filename>
          をご覧ください。
          &merged;</para>

	<para role="historic">
	  <filename>/etc/mail/Makefile</filename> に対して、
          新しい <filename>make.conf</filename> 変数
          <varname>SENDMAIL_MC</varname> への対応、
          <filename>.mc</filename> ファイルから
          <filename>.cf</filename> ファイルを構築する機能の追加、
          汎用のマップ再構築機能、
          aliases ファイルの再構築機能、
          <application>sendmail</application>
          を停止・起動・再起動する機能の追加が行なわれました。
          &merged;</para>

	<para role="historic"><filename>/etc/master.passwd</filename> に
	  <username>smmsp</username> ユーザと
	  <username>mailnull</username> ユーザが追加されました。
	  明示的に <literal>confDEF_USER_ID</literal> を設定していない
	  場合(デフォルト)、安全性のために
	  <username>mailnull</username> ユーザを使います。
	  これ以前は、<username>mailnull</username> ユーザは
	  存在せず、<username>daemon</username> ユーザが利用されて
	  いました。
	  この変更はファイルやプログラム
	  (<filename role="package">majordomo</filename> など)
	  にメールを渡す際にパーミッションの問題を引き起こす可能性が
	  あります。&merged;
	  以前の挙動に戻すには、システムの
	  <filename><replaceable>*</replaceable>.mc</filename> 設定
	  ファイルに以下の設定を加えます:
	  <programlisting>define(`confDEF_USER_ID', `daemon')</programlisting>
	</para>

	<para role="historic">この
	  <application>sendmail</application> 8.12.2 の更新にともない、
	  複数の <application>sendmail</application> デーモン
	  (外へ出ていくメールを扱うために必要なもの)
	  は <varname>sendmail_enable</varname> 変数が
	  <literal>NO</literal> に設定されている場合にも、
	  &man.rc.8; によって起動されるようになりました。
	  <application>sendmail</application> を完全に無効にするには、
	  <varname>sendmail_enable</varname> を
	  <varname>sendmail_enable</varname> に設定しなければなりません。
	  また、別の MTA を利用するシステムでは
	  <varname>mta_start_script</varname>
	  変数を用いて異なる起動スクリプトを指定することが可能です。
	  (詳細は &man.rc.sendmail.8; をご覧ください)。&merged;</para>

        <para>&man.rc.8; のデフォルトでは、外から来る SMTP
          接続を処理する
          <application>sendmail</application> を起動しなくなりました。
          ただし、バイナリインストールの場合は
          &man.sysinstall.8;
          で選択したセキュリティプロファイルに応じてデフォルトが異なります。
          この機能は、次の行を手動で <filename>/etc/rc.conf</filename> に
          追加することでも有効にできます。</para>

	<programlisting>sendmail_enable="YES"</programlisting>

        <para><filename>/etc/mail/Makefile</filename> から構築される
	  <application>sendmail</application> の alias ファイル、
	  map データベースの許可属性は、
	  ファイルロックに対するローカルからのサービス妨害攻撃を防ぐために
	  デフォルトが 0640 になりました。
	  これは <filename>make.conf</filename> の
	  <varname>SENDMAIL_MAP_PERMS</varname> という新しいオプションの設定で
	  変更することが可能です。&merged;</para>

	<para><application>sendmail</application> の統計ファイル
	  (<filename>/var/log/sendmail.st</filename>) の許可属性が
	  ファイルロックに対するローカルからのサービス妨害攻撃を防ぐために
	  0644 から 0640 へ変更されました。&merged;</para>

      </sect4>
    </sect3>

    <sect3>
      <title>Ports/Packages Collection インフラストラクチャ</title>

      <para><application>Perl</application> と
        &os; Ports Collection の統合を強化するために
        <application>BSDPAN</application>
        というモジュール集が追加されました。</para>

      <para role="historic">&man.pkg.create.1; および &man.pkg.add.1; が、
        &man.bzip2.1; を使って圧縮された package に対応しました。
        また、&man.pkg.add.1; が新しい package
        を取得するミラーサイトを PACKAGEROOT
        環境変数から得るようになっています。</para>

      <para role="historic">&man.pkg.create.1; における依存関係の記録が、
        コマンドラインの指定順ではなく依存関係の順番で
	行なわれるようになりました。
        これにより <command>pkg_add -r</command> の機能性が向上しています。
        &merged;</para>

      <para role="historic">&man.pkg.create.1; はローカルにインストールされた
	パッケージからパッケージを作成する <option>-b</option>
	に対応しました。&merged;</para>

      <para role="historic">&man.pkg.delete.1;
	に複数の package を削除するように指定した際に、
        コマンドラインの指定順ではなく依存関係順に
	削除が行なわれるようになりました。
        &merged;</para>

      <para role="historic">&man.pkg.delete.1; が package 名のグロブ指定・
	正規表現指定に対応しました。
        また、package すべてを削除する <option>-a</option> オプション、
        &man.rm.1; 風に対話型の確認を行なう <option>-i</option>
        オプションも追加されています。
        &merged;</para>

      <para role="historic">&man.pkg.delete.1; に、再帰的にパッケージを削除する
	<option>-r</option> オプションが追加されました。&merged;</para>

      <para role="historic">&man.pkg.info.1; が、
	インストール済み package のグロブ指定に対応しました。
        この機能は <option>-G</option> オプションで無効化できます。
        また、<option>-x</option>
        オプションでシェルグロブではなく正規表現を使うように制御可能です。
        &merged;</para>

      <para role="historic">&man.pkg.info.1; に新しいオプション
	<option>-g</option>
        が追加されました。
        これはインストール済みの package と記録されているチェックサム
        を (インストール後に変更されていないかどうか) 比較します。
        この機構を監査用途に使用する場合、そのセキュリティは当然
        <filename>/var/db/pkg</filename> の内容に依存します。
        &merged;</para>

      <para role="historic">新しく &man.pkg.sign.1; コマンド、
        &man.pkg.check.1; コマンドが追加されました。
        これらはバイナリ package の電子署名を行なったり、
        署名の検証を行なうためのものです。
        &merged;</para>

      <para>しばらくの間
        &os; 5.0-CURRENT (および 4.X リリースのいくつか) には
        インストール済み package と依存物を更新する
        pkg_update(1) ユーティリティが含まれていましたが、
        pkg_update(1) は削除されました。
        代わりに、この機能を含んだ高機能なツール
        <filename role="package">sysutils/portupgrade</filename>
        の port を使うことができます。</para>

      <para>ある期間、&os; 5.0-CURRENT (および、いくつかの 4.X-RELEASE) には
	インストール済みの package とその依存関係を更新する
	pkg_update(1) ユーティリティが含まれていましたが、
        このユーティリティは削除されました。
        代わりに、より高機能な
	<filename role="package">sysutils/portupgrade</filename>
	port が提供されています。</para>

      <para role="historic">&man.pkg.version.1;
	のバージョン番号比較ルーチンが、
        Porters Handbook (日本語訳:「port 作成者のためのハンドブック」)
        に書かれているとおりのものになりました。
        また、アドレス比較テストを行なうための新しいオプション
        <option>-t</option> も追加されています。
        &merged;</para>

      <para role="historic">&man.pkg.version.1; に新しいオプション
        <option>-s</option> が追加されました。
        これは、操作対象を指定された文字列とマッチする
        ports/packages に制限するためのものです。
        &merged;</para>

      <para>&man.pkg.version.1; が Perl スクリプトから
        C プログラムに変更されました。誤解の多い
        <option>-c</option> オプションは削除されています。
        <filename role="package">sysutils/portupgrade</filename>
        の port が、同様のより安全な機能を提供しています。</para>

      <para role="historic">インストール済み package のバージョン番号の文法が
        (後方互換性のある) 新しいものに変わりました。
        これは
        Ports Collection <filename>Makefile</filename> 群にある
        <varname>PORTREVISION</varname> 変数および
        <varname>PORTEPOCH</varname> 変数に対応します。
        これにより、Ports Collection の各 port
        に対するセキュリティパッチや &os;
        依存の更新といった、
        サードパーティ製ソフトウェアの配布物に付けられている
        オリジナルのバージョン番号に反映されない修正が追跡しやすくなります。
        &man.pkg.version.1; もまた、
        この新方式のバージョン番号の比較に対応しました。
        &merged;</para>

      <para role="historic">パフォーマンスおよびディスク使用効率向上のため、
        &os; Ports Collection にある
        <quote>ports スケルトン</quote> の再構成が行なわれました。
        インストール済みの ports や packages には影響ありません。
        &merged;</para>

      <para role="historic">すべての packages および ports に新しく
        <quote>origin</quote> 指示子が追加されました。
        これは package がどのディレクトリで構築されたかを
        &man.pkg.version.1; のようなプログラムから容易に
        調べられるようにするためのものです。
        &merged;</para>

       <para>Ports Collection において、(訳注: 各 port が) 依存する
	X Window System のデフォルトのバージョンが
	<application>XFree86</application> 4.2.1 に変更されました。
	<application>XFree86</application> 3.3.6 に戻すには、
	<filename>/etc/make.conf</filename> に次の行を加えてください。
	&merged;</para>

      <programlisting>XFREE86_VERSION=3</programlisting>

      <para><filename role="package">emulators/linux_base</filename>
	の port でインストールされるライブラリ
	(Linux エミュレーションに必要) が更新されました。
	現在は <application>Red Hat Linux</application> 7.1
	に含まれるものに対応しています。&merged;</para>

      <para>Ports Collection で生成される package (FTP
        サイトに置かれているものも同様) が、
        &man.gzip.1; ではなく &man.bzip2.1; で圧縮されるようになりました
        (そのため、拡張子は <filename>.tgz</filename> ではなく
        <filename>.tbz</filename> になっています)。
        package 関連ツールも、この新しい形式に対応するために更新されています。</para>

      <para>Ports Collection では、&os; &release.branch;
        用の新しいインデクスファイル
        (<filename>/usr/ports/INDEX-5</filename>)
        を使うようになりました。
        この新しいインデクスは、
        (<filename role="package">lang/perl5</filename> のように)
        &os; 4-STABLE には存在せず、&os; &release.branch;
        に存在する依存性を処理できるようにすることを目的としています。
        このファイルの導入後も、各 package 用のインデクスファイルは、
        <filename>INDEX</filename> と呼ばれています。
      </para>
    </sect3>
  </sect2>

  <sect2>
    <title>リリースエンジニアリングと統合</title>

    <para>インストール / リカバリ統合ディスクの作成を容易にするため、
      <filename>bin</filename> 配布物の名前が
      <filename>base</filename> に変更されました。</para>

    <para arch="i386">ISO イメージと CDROM は、デフォルトで
      <filename>cdboot</filename> ブートローダを使うようになりました。
      これにより bootable CDROM でフロッピディスクイメージの
      エミュレーションをする必要がなくなり、CDROM インストールに
      <filename>GENERIC</filename> カーネルを使えるようになりました
      (その代わり、古い BIOS との互換性は損なわれています)。</para>

    <para arch="i386,pc98,alpha" role="historic">
      <application>XFree86</application> 4.2.0 が
      &man.sysinstall.8; が対応する
      X Window System のデフォルトのバージョンになりました。
      &man.sysinstall.8; は <application>XFree86</application> を
      標準のバイナリパッケージセットとしてインストールするようになったため、
      &man.pkg.info.1; のような通常の package ユーティリティを使って
      それらのコンポーネントを調べたり操作することが可能になっています。
      &merged;</para>

    <para>&os; 5-CURRENT ホスト上での &os; 4-STABLE の make release、
      および &os; 4-STABLE ホスト上での &os; 5-CURRENT の make release
      ができるようになりました。
      クロスアーキテクチャのリリース構築
      (ホストと異なるアーキテクチャのリリースを構築すること)
      も可能になっています。
      詳しくは &man.release.7; をご覧ください。&merged;</para>

    <para>フロッピーリリースの三枚目に
      <filename>drivers.flp</filename> イメージが追加されました。
      このイメージには <filename>kern.flp</filename> の中にあるカーネルや
      <filename>mfsroot.flp</filename> イメージに入りきらない
      ドライバなどの動的ロード可能なモジュールが含まれています。</para>
  </sect2>

  <sect2>
    <title>ドキュメンテーション</title>

    <para>(ライセンス上の問題で以前までは含まれていなかった)
      多くの 4.4 BSD Programmer's Supplementary Documents が
      <filename>/usr/share/doc/psd</filename> に復帰しました。
      該当する文書は次のとおりです。</para>

    <itemizedlist>
      <listitem>
        <para><emphasis>The UNIX Time-Sharing System</emphasis>
	  (<filename>01.cacm</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>UNIX Implementation</emphasis>
	  (<filename>02.implement</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>The UNIX I/O System</emphasis>
	  (<filename>03.iosys</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>UNIX Programming &mdash; Second Edition</emphasis>
	  (<filename>04.uprog</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>The C Programming Language &mdash; Reference Manual
	  </emphasis>
	  (<filename>06.Clang</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>Yacc: Yet Another Compiler-Compiler</emphasis>
	  (<filename>15.yacc</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>Lex &mdash; A Lexical Analyzer Generator</emphasis>
	  (<filename>16.lex</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>The M4 Macro Processor</emphasis>
	  (<filename>17.m4</filename>)</para>
      </listitem>
    </itemizedlist>

    <para>同様に、4.4 BSD User's Supplementary Documents のいくつかが
      <filename>/usr/share/doc/usd</filename> に復帰しました。
      該当する文書は次のとおりです。</para>

    <itemizedlist>
      <listitem>
        <para><emphasis>NROFF/TROFF User's Manual</emphasis>
	  (<filename>21.troff</filename>)</para>
      </listitem>

      <listitem>
        <para><emphasis>A TROFF Tutorial</emphasis>
	  (<filename>22.trofftut</filename>)</para>
      </listitem>
    </itemizedlist>
  </sect2>

</sect1>

<sect1 id="upgrade">
  <title>前のリリースの &os; からのアップグレード</title>

  <para>現存する &os; システムからアップグレードするユーザは
    <quote>&os; 5.0-RELEASE 初期利用者のための手引き</quote>
    を読むことを <emphasis>強く</emphasis> 推奨します。
    この文書は、通常 <filename>EARLY.TXT</filename> という名前で
    配布物に収録されており、
    また、他のリリースノートが置かれているところにも一緒に置かれています。
    この手引にはアップグレード時に注意を払うべき点に加え、
    さらに重要な情報として、
    &os; 4.<replaceable>X</replaceable> システムを使い続ける場合と
    &os; 5.<replaceable>X</replaceable> へのアップグレードした場合の、
    それぞれの利点についてのまとめが書かれています。</para>

  <important>
    <para>&os; のアップグレードは、もちろん、
      <emphasis>すべての</emphasis> データと設定ファイルを
      バックアップしてからのみ行うべきです。</para>
  </important>
</sect1>

<!--
     Local Variables:
     mode: sgml
     sgml-parent-document: ("../i386/article.sgml" "article" "articleinfo")
     End:
-->
