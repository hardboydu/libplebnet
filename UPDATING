Updating Information for FreeBSD current users

This file is maintained by imp@village.org.  Please send new entries
directly to him.  See end of file for further details.  For commonly
done items, please see the end of the file.  Search for 'COMMON
ITEMS:'

20000620:
	Binutils 2.10 have hit the tree, or will shortly.  As soon
	as they do, the problem noted in 20000522 will be resolved and
	that workaround will no longer be required.

20000615:
	phk removed the compatibility creation of wd devices in the
	ad driver.  If you haven't done so already, you must update
	your fstab, etc to use the ad devices instead of the wd
	devices.

	In addition, you'll need to update your boot blocks to a
	more modern version, if you haven't already done so.  Modern
	here means 4.0 release or newer (although older releases
	may work).

20000612:
	Peter took an axe to config(8).  Besure that you read his mail
	on the topic before even thinking about updating.  You will
	need to create a /boot/devices.hints or add a hints directive
	to your config file to compile them in statically.  The format
	of the config file has changed as well.  Please see LINT,
	GENERIC or NEWCARD for examples of the new format.

	More details to follow.  A better howto would be warmly
	accepted by the author of UPDATING.

20000522:
	A new set of binutils went into the tree today.  Anybody
	building a kernel after this point is advised that they need
	to rebuild their binutils (or better yet do a
	buildworld/installworld) before building a new kernel.

	Due to bugs in binutils, using malloc options (eg /etc/malloc.conf
	or MALLOC_OPTIONS env var) J will cause ld to dump core.  It
	is recommended that you don't set this option until the problem
	is resolved.

20000513:
	The ethernet drivers were all updated to clean up the BPF handling.

20000510:
	The problems with boot blocks on the alphas have been corrected.
	This will require some care in updating alphas.  A new libstand
	is requires for the boot blocks to build properly.

20000503:
	Recompile all kld modules.  Proper version dependency info
	is now available.

20000502:
	Modules have been disconnected from the buildworld tree and 
	connected to the kernel building instead.

2000427:
	You may need to build gperf
		cd /usr/src/gnu/usr.bin/gperf && make depend all install
	when upgrading from 4.0 -> current.  The build system now uses
	an option only in -current.

20000417:
	The method that we brand ELF binaries has changed to be more
	acceptible to the binutils maintainers.  You will need to
	rebrand your ELF binaries that aren't native.  One problem
	binary is the Linux ldconfig.  After your make world, but
	before you reboot, you'll neeed to issue:
		brandelf -t Linux /compat/linux/sbin/ldconfig
	if you have Linux compatibility enabled on your machine.

20000320:
	If you have really bad/marginal IDE drives, you may find they
	don't work well.  Use pio mode instead.  The easiest way to
	cope if you have a problem combination is to add:
		/sbin/sysctl -w hw.atamodes=pio,pio,pio,pio
	to the start of /etc/rc.conf.

20000319:
	The ISA and PCI compatability shims have been connected to the
	options COMPAT_OLDISA and COMPAT_OLDPCI.  If you are using old
	style PCI or ISA drivers (i.e. tx, voxware, etc.) you must
	include the appropriate option in your kernel config.  Drivers
	using the shims should be updated or they won't ship with
	5.0-RELEASE, targeted for 2001.

20000318:
	We've entered the tradtional post release dumping party.
	Large kernel changes are being committed and are in the
	works.  It is important to keep the systems' klds and kernel
	in sync as kernel interfaces and structures are changing.
	Before reporting kernel panics, make sure that all modules
	that you are loading are up to date.

20000315:
	If you are upgrading from an older version of FreeBSD, you
	need to update your boot blocks as well.  'disklabel -B ad0'
	will do the trick.  This isn't critical until you remove your
	wd device entries in /dev, at which point your system will not
	boot.

20000315:
	4.0 RELEASE shipped.  Please see the 4.0 UPDATING file for how
	to upgrade to 4.0 from 3.x.

COMMON ITEMS:

	To build a kernel
	-----------------
	Update config, genassym and go:
		config YOUR_KERNEL_HERE			[1]
		cd ../../compile/YOUR_KERNEL_HERE
		make depend && make
		make install
	[1] If upgrading, add -r won't hurt and sometimes helps.

	To rebuild everything
	---------------------
	make world

	To upgrade from 4.0-stable to current
	-------------------------------------
	make buildworld
	make buildkernel KERNEL=YOUR_KERNEL_HERE
	make installkernel KERNEL=YOUR_KERNEL_HERE
	make installworld
	<reboot>

	Make sure that you've read the UPDATING file to understand
	the tweaks to various things you need.  At this point in the
	life cycloe of current, things change often and you are on
	your own to cope.

FORMAT:

This file contains a list, in reverse chronologocal order, of major
breakages in tracking -current.  Not all things will be listed here,
and it only starts on March 15, 2000.  Updating files can found in
previous releases if your system is older than this.

Please filter your entries through Warner Losh (imp@village.org) so
that the style, formatting, etc of this file can be maintained.

$FreeBSD$
